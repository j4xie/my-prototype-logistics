# 🔐 白垩纪食品溯源系统 - 最终权限说明

**更新时间**: 2025-10-06
**统一密码**: `123456`

---

## 📊 账号总览

| # | 账号 | 密码 | 角色 | 打卡签到 | 工作报告 | 生产管理 |
|---|------|------|------|---------|---------|---------|
| 1 | platform_admin | 123456 | 平台管理员 | ❌ 否 | ❌ 否 | 👁️ 只读 |
| 2 | super_admin | 123456 | 超级工厂管理员 | ✅ **需要** | ✅ **需要** | ✅ 完全权限 |
| 3 | dept_admin | 123456 | 加工部门管理员 | ✅ **需要** | ✅ **需要** | ✅ 完全权限 |
| 4 | operator1 | 123456 | 加工部员工 | ✅ **需要** | ✅ **需要** | ❌ 不访问 |

---

## 👤 详细功能说明

### 1️⃣ 平台管理员 (platform_admin) - 平台监控

**账号**: `platform_admin` / `123456`

**职责**: 平台运营、工厂审核、系统配置

**功能权限**:

| 功能模块 | 权限 | 说明 |
|---------|------|------|
| 平台管理 | ✅ 完全 | 管理所有工厂、审核申请 |
| 系统配置 | ✅ 完全 | 平台级设置 |
| 生产管理界面 | 👁️ **只读** | 可以查看,不能修改 |
| 打卡签到 | ❌ 否 | 平台级账号不需要打卡 |
| 工作报告 | ❌ 否 | 平台级账号不需要报告 |

**生产管理界面**:
- ✅ 可以访问
- ✅ 查看所有工厂的生产计划
- ❌ 所有操作按钮禁用
- 显示: "👁️ 只读模式"

---

### 2️⃣ 超级工厂管理员 (super_admin) - 工厂运营 ⭐

**账号**: `super_admin` / `123456`

**职责**: 工厂全局管理、生产计划制定、日常运营

**功能权限**:

| 功能模块 | 权限 | 说明 |
|---------|------|------|
| ⏰ **打卡签到** | ✅ **需要** | 管理员也要打卡上下班 |
| 📝 **工作报告** | ✅ **需要** | 汇报每日工作情况 |
| 🏭 生产管理 | ✅ 完全 | 创建/修改/删除生产计划 |
| 👥 用户管理 | ✅ 完全 | 管理所有用户 |
| 🐟 产品类型 | ✅ 完全 | 管理产品配置 |
| 🏪 商家管理 | ✅ 完全 | 管理商家信息 |
| ⚙️ 系统设置 | ✅ 完全 | 工厂配置 |

**每日工作流程**:
1. ⏰ 早上打卡签到
2. 🏭 制定/调整生产计划
3. 👥 管理工厂事务
4. 📝 晚上提交工作报告
5. ⏰ 下班打卡

**说明**: 即使是管理员,也需要打卡和报告工作!

---

### 3️⃣ 加工部门管理员 (dept_admin) - 部门管理 ⭐

**账号**: `dept_admin` / `123456`

**职责**: 加工部管理、生产计划执行、部门员工管理

**功能权限**:

| 功能模块 | 权限 | 说明 |
|---------|------|------|
| ⏰ **打卡签到** | ✅ **需要** | 部门管理员也要打卡 |
| 📝 **工作报告** | ✅ **需要** | 汇报部门工作情况 |
| 🏭 生产管理 | ✅ 完全 | 创建/修改加工部生产计划 |
| 👥 用户管理 | ⚠️ 部分 | 只能管理加工部员工 |
| 📊 数据查看 | ⚠️ 部分 | 只能查看加工部数据 |

**与超级管理员的区别**:
- **目前**: 暂无区别 (只实现了加工功能)
- **未来**: 只能访问加工部数据

**每日工作流程**:
1. ⏰ 早上打卡签到
2. 🏭 安排加工部生产任务
3. 👥 管理加工部员工
4. 📝 晚上提交工作报告 (部门总结)
5. ⏰ 下班打卡

---

### 4️⃣ 加工部员工 (operator1) - 执行操作

**账号**: `operator1` / `123456`

**职责**: 执行生产任务、打卡签到、报告工作

**功能权限**:

| 功能模块 | 权限 | 说明 |
|---------|------|------|
| ⏰ **打卡签到** | ✅ **需要** | 每日必打卡 |
| 📝 **工作报告** | ✅ **需要** | 报告每日工作 |
| 🏭 加工记录 | ✅ 执行 | 记录生产数据 |
| 📦 批次管理 | ✅ 执行 | 更新批次状态 |
| 🏭 生产管理界面 | ❌ **不访问** | 不制定计划,只执行任务 |
| 👥 用户管理 | ❌ 否 | 无权限 |

**每日工作流程**:
1. ⏰ 早上打卡签到
2. 🏭 查看分配的生产任务
3. 📊 记录加工数据
4. 📝 晚上提交工作报告 (完成的任务)
5. ⏰ 下班打卡

**不访问生产管理界面的原因**: 员工的职责是执行任务,不是制定计划

---

## 📱 功能模块分布

### 所有工厂账号都需要的基础功能:

#### ⏰ **打卡签到** (所有工厂账号必备)

**谁需要**:
- ✅ super_admin (超级管理员也要打卡!)
- ✅ dept_admin (部门管理员也要打卡!)
- ✅ operator1 (员工必须打卡)
- ❌ platform_admin (平台级账号不需要)

**功能**:
- 上班打卡
- 下班打卡
- 查看打卡记录
- 统计工作时长

**访问路径**: 首页 → 底部"打卡"Tab ⏰

---

#### 📝 **工作报告** (所有工厂账号必备)

**谁需要**:
- ✅ super_admin (汇报工厂整体工作)
- ✅ dept_admin (汇报部门工作情况)
- ✅ operator1 (汇报个人工作内容)
- ❌ platform_admin (平台级账号不需要)

**功能**:
- 填写工作内容
- 上传工作照片
- 记录完成任务
- 提交工作总结

**内容差异**:
- **super_admin**: 汇报工厂整体运营情况
- **dept_admin**: 汇报加工部工作总结
- **operator1**: 汇报个人完成的具体任务

**访问路径**: 首页 → 底部"工作"Tab 📝

---

### 管理功能 (管理员专用):

#### 🏭 **生产管理界面** (管理员功能)

**谁可以访问**:
- ✅ super_admin (完全权限)
- ✅ dept_admin (完全权限)
- 👁️ platform_admin (只读)
- ❌ operator1 (不访问)

**访问路径**: 首页 → 管理Tab → 生产计划管理

---

## 🔧 权限实现说明

### 前端权限控制逻辑:

```typescript
// 所有工厂账号
const isFactoryUser = user?.userType === 'factory';

// 打卡签到权限
const needsTimeClock = isFactoryUser; // super_admin, dept_admin, operator1

// 工作报告权限
const needsWorkReport = isFactoryUser; // super_admin, dept_admin, operator1

// 生产管理访问权限
const canAccessProduction = ['factory_super_admin', 'department_admin'].includes(roleCode);

// 生产管理只读
const isReadOnly = user?.userType === 'platform';

// 生产管理完全权限
const canModifyProduction = canAccessProduction && !isReadOnly;
```

---

## 📊 完整权限矩阵

| 功能 | platform_admin | super_admin | dept_admin | operator1 |
|-----|---------------|-------------|------------|-----------|
| **基础员工功能** | | | | |
| 打卡签到 | ❌ | ✅ **需要** | ✅ **需要** | ✅ **需要** |
| 工作报告 | ❌ | ✅ **需要** | ✅ **需要** | ✅ **需要** |
| **管理功能** | | | | |
| 生产计划管理 | 👁️ 只读 | ✅ 完全 | ✅ 完全 | ❌ 不访问 |
| 用户管理 | ✅ 全部 | ✅ 全部 | ⚠️ 本部门 | ❌ |
| 产品类型管理 | ❌ | ✅ | ✅ | ❌ |
| 商家管理 | ❌ | ✅ | ✅ | ❌ |
| **平台功能** | | | | |
| 工厂审核 | ✅ | ❌ | ❌ | ❌ |
| 平台配置 | ✅ | ❌ | ❌ | ❌ |

---

## 🎯 关键理解

### ✅ **重要**: 所有工厂员工(包括管理员)都需要:

1. **打卡签到** ⏰
   - super_admin 也要打卡
   - dept_admin 也要打卡
   - operator1 也要打卡
   - **原因**: 记录工作时间,统计考勤

2. **工作报告** 📝
   - super_admin 汇报工厂整体工作
   - dept_admin 汇报部门工作情况
   - operator1 汇报个人工作内容
   - **原因**: 工作记录,绩效考核

### ✅ **区别**: 只是职责和管理权限不同

- **super_admin**: 打卡 + 工作报告 + 管理工厂 + 制定计划
- **dept_admin**: 打卡 + 工作报告 + 管理部门 + 制定计划
- **operator1**: 打卡 + 工作报告 + 执行任务

---

## 📱 每日工作流程

### 超级工厂管理员 (super_admin)

```
08:00 - ⏰ 上班打卡
08:30 - 🏭 制定/调整生产计划
10:00 - 👥 处理工厂事务
15:00 - 📊 查看生产进度
17:30 - 📝 提交工作报告 (工厂整体情况)
18:00 - ⏰ 下班打卡
```

### 加工部门管理员 (dept_admin)

```
08:00 - ⏰ 上班打卡
08:30 - 🏭 安排加工部生产任务
10:00 - 👥 管理加工部员工
15:00 - 📦 检查原料库存
17:30 - 📝 提交工作报告 (部门工作总结)
18:00 - ⏰ 下班打卡
```

### 加工部员工 (operator1)

```
08:00 - ⏰ 上班打卡
08:30 - 🏭 查看今日任务
09:00 - 📊 执行加工任务,记录数据
12:00 - 午休
13:00 - 📊 继续加工任务
17:30 - 📝 提交工作报告 (完成的任务列表)
18:00 - ⏰ 下班打卡
```

### 平台管理员 (platform_admin)

```
全天 - 💻 平台管理工作
     - 👁️ 查看各工厂生产情况 (只读)
     - ✅ 审核工厂申请
     - ⚙️ 系统配置
     - (不需要打卡和工作报告)
```

---

## 🔑 生产管理界面权限细节

### ✅ 可以完全使用 (2个账号)

**super_admin + dept_admin**:
- ✅ 可以访问界面
- ✅ 显示 "➕ 创建生产计划" 按钮
- ✅ 显示所有操作按钮
- ✅ 可以创建计划
- ✅ 可以开始生产
- ✅ 可以记录消耗
- ✅ 可以完成生产
- ✅ 可以记录出货

**目前区别**: 无 (都是完全权限)

**未来区别**: dept_admin只能访问加工部数据

---

### 👁️ 只读访问 (1个账号)

**platform_admin**:
- ✅ 可以访问界面
- ✅ 可以查看所有数据
- ❌ "创建生产计划"按钮隐藏
- ❌ 所有操作按钮禁用
- ❌ 不能修改任何数据

**界面显示**:
- 右下角: "👁️ 只读模式" (橙色卡片)
- 计划卡片底部: "👁️ 平台管理员只读模式 - 无法修改数据"

---

### ❌ 不访问 (1个账号)

**operator1**:
- ❌ 不访问生产管理界面
- 原因: 员工职责是执行任务,不是制定计划
- 使用: 打卡签到 + 工作报告 + 加工记录界面

---

## 📱 界面访问路径

### 所有工厂账号的必备界面:

#### 1. 打卡签到界面
```
首页 → 底部"打卡"Tab ⏰
→ TimeClockScreen
```

**谁使用**:
- ✅ super_admin (管理员也要打卡)
- ✅ dept_admin (部门管理也要打卡)
- ✅ operator1 (员工必须打卡)

---

#### 2. 工作报告界面
```
首页 → 底部"工作"Tab 📝
→ WorkReportScreen
```

**谁使用**:
- ✅ super_admin (汇报工厂工作)
- ✅ dept_admin (汇报部门工作)
- ✅ operator1 (汇报个人工作)

---

### 管理员专用界面:

#### 3. 生产管理界面
```
首页 → 底部"管理"Tab 🏭
→ 管理中心
→ 生产计划管理
```

**谁使用**:
- ✅ super_admin (完全权限)
- ✅ dept_admin (完全权限)
- 👁️ platform_admin (只读)
- ❌ operator1 (不访问)

---

## 🎯 使用建议

### 日常推荐账号:

| 测试场景 | 推荐账号 | 密码 |
|---------|---------|------|
| 测试生产管理 | super_admin | 123456 |
| 测试部门管理 | dept_admin | 123456 |
| 测试只读权限 | platform_admin | 123456 |
| 测试员工功能 | operator1 | 123456 |

---

## ✅ 权限配置总结

### 基础员工功能 (所有工厂账号):
- ✅ super_admin: 需要打卡 + 工作报告
- ✅ dept_admin: 需要打卡 + 工作报告
- ✅ operator1: 需要打卡 + 工作报告
- ❌ platform_admin: 不需要 (平台级)

### 生产管理功能:
- ✅ super_admin: 完全权限
- ✅ dept_admin: 完全权限 (目前相同)
- 👁️ platform_admin: 只读
- ❌ operator1: 不访问

### 平台管理功能:
- ✅ platform_admin: 专属
- ❌ 其他账号: 无权限

---

**所有权限配置已明确!** ✅

**关键点**:
- ⭐ **所有工厂员工(包括管理员)都需要打卡和工作报告**
- ⭐ **生产管理界面只有管理员可以操作**
- ⭐ **平台管理员可以查看生产管理,但只读**

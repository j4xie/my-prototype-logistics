<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.joolun.mall.mapper.DecorationThemePresetMapper">
    <resultMap id="themeMap" type="com.joolun.mall.entity.DecorationThemePreset">
        <id property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="code" column="code"/>
        <result property="description" column="description"/>
        <result property="thumbnail" column="preview_image"/>
        <result property="colorConfig" column="color_config"/>
        <result property="styleTags" column="style_tags"/>
        <result property="industryTags" column="industry_tags"/>
        <result property="slogan" column="slogan"/>
        <result property="recommendedModules" column="recommended_modules"/>
        <result property="status" column="status"/>
        <result property="sortOrder" column="sort_order"/>
        <result property="useCount" column="use_count"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

    <sql id="themeSql">
        t.`id`, t.`name`, t.`code`, t.`description`, t.`preview_image`,
        t.`color_config`, t.`style_tags`, t.`industry_tags`, t.`slogan`, t.`recommended_modules`,
        t.`status`, t.`sort_order`, t.`use_count`, t.`create_time`
    </sql>

    <select id="selectActiveList" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`status` = 1
        ORDER BY t.`sort_order` ASC
    </select>

    <select id="selectByCode" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`code` = #{code}
    </select>

    <select id="selectByStyleType" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`status` = 1 AND t.`style_tags` LIKE CONCAT('%',#{styleType},'%')
        ORDER BY t.`sort_order` ASC
    </select>

    <select id="selectSystemPresets" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`status` = 1
        ORDER BY t.`sort_order` ASC
    </select>

    <select id="selectBatchIds" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`id` IN
        <foreach collection="list" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </select>

    <select id="selectByIndustryType" resultMap="themeMap">
        SELECT <include refid="themeSql"/>
        FROM decoration_theme_preset t
        WHERE t.`status` = 1 AND t.`industry_tags` LIKE CONCAT('%',#{industryType},'%')
        ORDER BY t.`sort_order` ASC
    </select>
</mapper>

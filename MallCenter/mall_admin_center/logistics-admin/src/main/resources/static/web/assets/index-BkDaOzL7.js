import{i as p}from"./index-C4wwgI1I.js";import{U as y,_ as w,B as A,d as b,C as S,ab as s,D as M,F as v,e as h,c as E,o as I,f as d,i as l,h as m,l as _,G as k,t as V,v as B}from"./index-DxyzpFVi.js";function O(r){return y({url:"/wxsummary/usersummary",method:"get",params:r})}function U(r){return y({url:"/wxsummary/usercumulate",method:"get",params:r})}function F(r){return y({url:"/wxsummary/interfacesummary",method:"get",params:r})}const c=r=>(V("data-v-8c54f5d2"),r=r(),B(),r),j={class:"clearfix"},G=c(()=>m("span",{class:"demonstration"},"时间范围",-1)),N=c(()=>m("div",{id:"userSummaryChart",style:{width:"80%",height:"378px"}},null,-1)),P=c(()=>m("div",{id:"userCumulateChart",style:{width:"80%",height:"378px"}},null,-1)),R=c(()=>m("div",{id:"interfaceSummaryChart",style:{width:"80%",height:"378px"}},null,-1)),T=c(()=>m("div",{id:"interfaceSummaryChart2",style:{width:"80%",height:"378px"}},null,-1)),W=A({name:"WxMpSummary"}),$=Object.assign(W,{setup(r){const{proxy:C}=b(),a=S({datePickerOptions:{disabledDate(i){return i>=new Date(new Date-3600*1e3*24)}},startDate:s().add(-7,"days").format("YYYY-MM-DD"),endDate:s().add(-1,"days").format("YYYY-MM-DD"),dateValues:[s().add(-7,"days").format("YYYY-MM-DD"),s().add(-1,"days").format("YYYY-MM-DD")],xAxisData:[],seriesData1:[],seriesData2:[],seriesData3:[],seriesData4:[],seriesData5:[],seriesData6:[],seriesData7:[]}),{datePickerOptions:Y,startDate:q,endDate:z,dateValues:f,xAxisData:H,seriesData1:J,seriesData2:K,seriesData3:L,seriesData4:Q,seriesData5:X,seriesData6:Z,seriesData7:aa}=M(a);v(()=>{x()});function g(){let i=new Date(a.dateValues[0]),e=new Date(a.dateValues[1]);if(s(e).diff(s(i),"day")>6)return C.$message.error("时间间隔7天以内，请重新选择"),!1;a.startDate=s(i).format("YYYY-MM-DD"),a.endDate=s(e).format("YYYY-MM-DD"),a.xAxisData=[],a.seriesData1=[],a.seriesData2=[],a.seriesData5=[],a.seriesData6=[],x()}function x(){let i=s(a.endDate).diff(s(a.startDate),"day");for(let e=0;e<=i;e++)a.xAxisData.push(s(a.startDate).add(e,"days").format("YYYY-MM-DD")),a.seriesData1.push(0),a.seriesData2.push(0),a.seriesData5.push(0),a.seriesData6.push(0);O({startDate:a.startDate,endDate:a.endDate}).then(e=>{a.xAxisData.forEach((o,t,n)=>{e.data.forEach((u,ea,ta)=>{u.refDate.indexOf(o)>=0&&(a.seriesData5[t]=a.seriesData5[t]+u.newUser,a.seriesData6[t]=a.seriesData6[t]+u.cancelUser)})}),p(document.getElementById("userSummaryChart")).setOption({title:{text:"用户增减数据"},color:["#67C23A","#F56C6C"],legend:{data:["新增用户","取消关注的用户"]},tooltip:{},xAxis:{data:a.xAxisData},yAxis:{},series:[{name:"新增用户",type:"bar",label:{normal:{show:!0}},barGap:0,data:a.seriesData5},{name:"取消关注的用户",type:"bar",label:{normal:{show:!0}},data:a.seriesData6}]})}).catch(()=>{}),U({startDate:a.startDate,endDate:a.endDate}).then(e=>{e.data.forEach((o,t,n)=>{a.seriesData7[t]=o.cumulateUser}),p(document.getElementById("userCumulateChart")).setOption({title:{text:"累计用户数据"},legend:{data:["累计用户量"]},xAxis:{type:"category",data:a.xAxisData},yAxis:{type:"value"},tooltip:{trigger:"axis"},series:[{name:"累计用户量",data:a.seriesData7,type:"line",smooth:!0}]})}).catch(()=>{}),F({startDate:a.startDate,endDate:a.endDate}).then(e=>{e.data.forEach((t,n,u)=>{a.seriesData1[n]=t.callbackCount,a.seriesData2[n]=t.maxTimeCost,a.seriesData3[n]=t.totalTimeCost,a.seriesData4[n]=t.failCount}),p(document.getElementById("interfaceSummaryChart")).setOption({title:{text:"接口分析数据"},color:["#67C23A","#F56C6C"],legend:{data:["被动回复用户消息的次数","失败次数"]},tooltip:{},xAxis:{data:a.xAxisData},yAxis:{},series:[{name:"被动回复用户消息的次数",type:"bar",label:{normal:{show:!0}},barGap:0,data:a.seriesData1},{name:"失败次数",type:"bar",label:{normal:{show:!0}},data:a.seriesData4}]}),p(document.getElementById("interfaceSummaryChart2")).setOption({title:{text:"接口分析数据"},color:["#E6A23C","#409EFF"],legend:{data:["最大耗时","总耗时"]},tooltip:{},xAxis:{data:a.xAxisData},yAxis:{},series:[{name:"最大耗时",type:"bar",label:{normal:{show:!0}},data:a.seriesData2},{name:"总耗时",type:"bar",label:{normal:{show:!0}},data:a.seriesData3}]})}).catch(()=>{})}return(i,e)=>{const D=h("el-date-picker"),o=h("el-col"),t=h("el-row"),n=h("el-card");return I(),E("div",null,[d(n,{class:"box-card"},{header:l(()=>[m("div",j,[G,d(D,{format:"YYYY-MM-DD",modelValue:_(f),"onUpdate:modelValue":e[0]||(e[0]=u=>k(f)?f.value=u:null),type:"daterange","picker-options":_(Y),onChange:g,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue","picker-options"])])]),default:l(()=>[d(t,{justify:"center"},{default:l(()=>[d(o,{span:12},{default:l(()=>[N]),_:1}),d(o,{span:12},{default:l(()=>[P]),_:1}),d(o,{span:12},{default:l(()=>[R]),_:1}),d(o,{span:12},{default:l(()=>[T]),_:1})]),_:1})]),_:1})])}}}),oa=w($,[["__scopeId","data-v-8c54f5d2"]]);export{oa as default};

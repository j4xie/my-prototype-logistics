import{c as x}from"./permission-CtopeLks.js";import{U as k,_ as ie,B as de,r as ce,d as ue,C as pe,D as ge,y as me,e as _,c as y,o as g,f as a,i as r,l as u,G as N,j as P,k as h,n as p,h as o,A as n,L as fe,M as _e,t as he,v as be}from"./index-DxyzpFVi.js";function ye(c){return k({url:"/orderinfo/page",method:"get",params:c})}function we(c){return k({url:"/orderinfo",method:"post",data:c})}function ve(c){return k({url:"/orderinfo/"+c,method:"get"})}function xe(c){return k({url:"/orderinfo/"+c,method:"delete"})}function $(c){return k({url:"/orderinfo",method:"put",data:c})}function ke(c){return k({url:"/orderinfo/cancel/"+c,method:"put"})}function D(c){return k({url:"/orderinfo/doOrderRefunds",method:"put",data:c})}const Ce={dialogType:"drawer",dialogWidth:"80%",border:!0,index:!1,indexLabel:"序号",stripe:!0,menuAlign:"center",align:"center",menuWidth:150,menuType:"text",searchShow:!1,excelBtn:!0,printBtn:!0,editBtn:!1,delBtn:!1,addBtn:!1,viewBtn:!1,defaultExpandAll:!0,searchMenuSpan:6,dateBtn:!0,column:[{label:"用户id",prop:"userId",sortable:!0,hide:!0,display:!1},{label:"是否支付",prop:"isPay",type:"radio",hide:!0,search:!0,display:!1,dicData:[{label:"是",value:"1"},{label:"否",value:"0"}]},{label:"订单编号",prop:"orderNo",search:!0,hide:!0,display:!1},{label:"商品信息",prop:"name",width:500,slot:!0,display:!1},{label:"时间/订单编号",prop:"createTime",sortable:!0,width:250,slot:!0,display:!1},{label:"状态",prop:"status",type:"radio",sortable:!0,slot:!0,width:170,display:!1},{label:"订单金额(￥)",prop:"salesPrice",sortable:!0,slot:!0,width:180,display:!1},{label:"付款时间",prop:"paymentTime",sortable:"custom",display:!1,width:130},{label:"发货时间",prop:"deliveryTime",sortable:!0,hide:!0,display:!1},{label:"收货时间",prop:"receiverTime",sortable:!0,hide:!0,display:!1},{label:"成交时间",prop:"closingTime",sortable:!0,hide:!0,display:!1},{label:"最后更新时间",prop:"updateTime",sortable:!0,hide:!0,display:!1},{label:"备注",prop:"remark",hide:!0,display:!1}],group:[{icon:"el-icon-s-order",label:"基本信息",prop:"group1",column:[{prop:"orderNo",formslot:!0,span:24}]},{icon:"el-icon-user",label:"用户详情",prop:"group2",column:[{prop:"userId",formslot:!0,span:24}]},{icon:"el-icon-goods",label:"商品信息",prop:"group3",column:[{prop:"listOrderItem",formslot:!0,span:24}]},{icon:"el-icon-location-outline",label:"收货信息",prop:"group4",column:[{prop:"orderLogistics",formslot:!0,span:24}]}]},C=c=>(he("data-v-1f86b4ec"),c=c(),be(),c),Pe={class:"app-container"},Te=C(()=>o("span",null,"全部订单",-1)),Le=C(()=>o("span",null,"待付款",-1)),Ne=C(()=>o("span",null,"待发货",-1)),Be=C(()=>o("span",null,"待收货",-1)),Ie=C(()=>o("span",null,"已完成",-1)),Se=C(()=>o("span",null,"已取消",-1)),Oe={style:{"text-align":"left"}},Ve={class:"grid-content"},$e={class:"grid-content"},De={style:{color:"red"}},Fe={style:{"text-align":"left"}},Ue={class:"grid-content"},Re={class:"grid-content"},ze={key:0},je={key:1},qe={key:2},Ae={key:3},Me=["src"],Ee={class:"spu-name"},Ge={key:0,class:"spec-info"},We={class:"grid-content",style:{color:"red"}},Ze={class:"grid-content"},He={key:0,class:"grid-content"},Je={key:1,class:"grid-content"},Ke={key:2,class:"grid-content"},Qe={class:"grid-content"},Xe={class:"grid-content"},Ye={style:{"text-align":"left"}},et={class:"grid-content"},tt={class:"grid-content"},at={class:"grid-content",style:{color:"red"}},lt=de({name:"OrderInfo"}),rt=Object.assign(lt,{setup(c){const V=ce(null),{proxy:b}=ue(),t=pe({form:{},date:[],status:"-1",tableData:[],page:{total:0,currentPage:1,pageSize:20,ascs:[],descs:"create_time"},paramsSearch:{},tableLoading:!1,dialogLogistics:!1,logisticsForm:{row:{},logistics:null,logisticsNo:null,address:null},logisticsOption:{emptyBtn:!1,card:!0,group:[{icon:"el-icon-user",label:"收货人信息",prop:"group1",column:[{label:"收货人名字",prop:"userName",span:24,readonly:!0},{label:"电话号码",prop:"telNum",span:24,readonly:!0},{label:"收货地址",prop:"address",type:"textarea",span:24,readonly:!0}]},{icon:"el-icon-truck",label:"快递信息",prop:"group2",column:[{label:"快递公司",prop:"logistics",dicUrl:"/orderlogistics/dict/LOGISTICS",span:24,type:"select",rules:[{required:!0,message:"请选择快递公司",trigger:"blur"}]},{label:"快递单号",prop:"logisticsNo",span:24,rules:[{required:!0,message:"请输入快递单号",trigger:"blur"}]}]}]},dialogRefunds:!1,orderItemObj:{}}),{form:w,page:F,tableData:U,tableLoading:R,status:B,dialogLogistics:I,logisticsForm:S,logisticsOption:z,paramsSearch:ot}=ge(t),j=me(()=>({addBtn:x(["mall:orderinfo:add"]),delBtn:x(["mall:orderinfo:del"]),editBtn:x(["mall:orderinfo:edit"]),viewBtn:x(["mall:orderinfo:get"])}));function q(l){b.$confirm("是否同意退款申请","提示",{distinguishCancelAndClose:!0,confirmButtonText:"同意",cancelButtonText:"拒绝",type:"warning"}).then(function(){return D({id:l.id,status:"3"}).then(()=>{b.$message({showClose:!0,message:"审核成功",type:"success"}),f(t.page)}).catch(function(s){})}).catch(s=>{if(s==="cancel")return D({id:l.id,status:"2"}).then(()=>{b.$message({showClose:!0,message:"审核成功",type:"success"}),f(t.page)}).catch(function(i){})})}function A(l){t.status=l.paneName,t.page.currentPage=1,f(t.page)}function M(l,s){t.tableLoading=!0,ve(l.id).then(i=>{l.userInfo=i.data.userInfo,l.orderLogistics=i.data.orderLogistics,V.value.rowView(l,s),t.tableLoading=!1})}function E(l,s){b.$confirm("是否确认取消此订单","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return ke(l.id).then(()=>{b.$message({showClose:!0,message:"取消成功",type:"success"}),f(t.page)}).catch(function(i){})})}function G(l,s,i){t.logisticsForm.row=l,t.logisticsForm.address=l.orderLogistics.address,t.logisticsForm.userName=l.orderLogistics.userName,t.logisticsForm.telNum=l.orderLogistics.telNum,t.dialogLogistics=!0}function W(l,s){let i=t.logisticsForm.row;i.status="2",i.logistics=l.logistics,i.logisticsNo=l.logisticsNo,$(i).then(()=>{b.$message({showClose:!0,message:"发货成功",type:"success"}),s(),f(t.page),t.dialogLogistics=!1}).catch(()=>{s()})}function Z(l){l.value?t.date=l.value:t.date=[],f(t.page)}function H(l,s){l=b.filterForm(l),t.paramsSearch=l,t.page.currentPage=1,f(t.page,l),s()}function J(l){let s=l.prop?l.prop.replace(/([A-Z])/g,"_$1").toLowerCase():"";l.order=="ascending"?(t.page.descs=[],t.page.ascs=s):l.order=="descending"?(t.page.ascs=[],t.page.descs=s):(t.page.ascs=[],t.page.descs=[]),f(t.page)}function f(l,s){t.tableLoading=!0,ye(Object.assign({current:l.currentPage,size:l.pageSize,descs:t.page.descs,ascs:t.page.ascs,status:t.status!="-1"?t.status:null,beginTime:t.date[0],endTime:t.date[1]},s,t.paramsSearch)).then(i=>{t.tableData=i.data.records,t.page.total=i.data.total,t.page.currentPage=l.currentPage,t.page.pageSize=l.pageSize,t.tableLoading=!1}).catch(()=>{t.tableLoading=!1})}function K(l,s){b.$confirm("是否确认删除此数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return xe(l.id)}).then(()=>{b.$message({showClose:!0,message:"删除成功",type:"success"}),f(t.page)}).catch(function(i){})}function Q(l,s,i,v){$(l).then(()=>{b.$message({showClose:!0,message:"修改成功",type:"success"}),i(),f(t.page)}).catch(()=>{v()})}function X(l,s,i){we(l).then(()=>{b.$message({showClose:!0,message:"添加成功",type:"success"}),s(),f(t.page)}).catch(()=>{i()})}function Y(l){f(t.page)}return(l,s)=>{const i=_("el-tab-pane"),v=_("el-tag"),d=_("el-table-column"),T=_("el-table"),ee=_("el-avatar"),te=_("el-image"),O=_("el-col"),L=_("el-button"),ae=_("el-row"),le=_("avue-crud"),re=_("el-tabs"),oe=_("avue-form"),se=_("el-dialog");return g(),y("div",Pe,[a(re,{modelValue:u(B),"onUpdate:modelValue":s[1]||(s[1]=e=>N(B)?B.value=e:null),type:"border-card",onTabClick:A},{default:r(()=>[a(i,{name:"-1"},{label:r(()=>[Te]),_:1}),a(i,{name:"0"},{label:r(()=>[Le]),_:1}),a(i,{name:"1"},{label:r(()=>[Ne]),_:1}),a(i,{name:"2"},{label:r(()=>[Be]),_:1}),a(i,{name:"3"},{label:r(()=>[Ie]),_:1}),a(i,{name:"5"},{label:r(()=>[Se]),_:1}),a(le,{ref_key:"crud",ref:V,modelValue:u(w),"onUpdate:modelValue":s[0]||(s[0]=e=>N(w)?w.value=e:null),page:u(F),data:u(U),permission:u(j),"table-loading":u(R),option:u(Ce),onOnLoad:f,onRefreshChange:Y,onRowUpdate:Q,onRowSave:X,onRowDel:K,onSortChange:J,onSearchChange:H,onDateChange:Z},{status:r(e=>[o("div",Oe,[o("div",Ve,[p(" 订单状态： "),a(v,{type:e.row.status=="2"||e.row.status=="3"||e.row.status=="4"?"success":"danger",effect:"dark",size:"small"},{default:r(()=>[p(n(e.row.statusDesc),1)]),_:2},1032,["type"])]),o("div",$e,[p(" 支付状态： "),a(v,{type:e.row.isPay=="1"?"success":"danger",effect:"dark",size:"small"},{default:r(()=>[p(n(e.row.isPay=="1"?"已支付":"未支付"),1)]),_:2},1032,["type"])])])]),"orderNo-form":r(()=>[a(T,{data:[u(w)],border:"",style:{width:"100%"}},{default:r(()=>[a(d,{align:"center",prop:"orderNo",label:"订单单号"}),a(d,{align:"left",prop:"salesPrice",label:"订单金额",width:"200"},{default:r(e=>[o("div",null,"订单金额：￥"+n(e.row.salesPrice),1),o("div",null,"运费金额：+ ￥"+n(e.row.freightPrice),1),o("div",De," 支付金额：￥"+n(e.row.paymentPrice),1)]),_:1}),a(d,{align:"center",prop:"paymentType",label:"订单状态"},{default:r(e=>[o("div",Fe,[o("div",Ue,[p(" 订单状态： "),a(v,{type:e.row.status=="2"||e.row.status=="3"||e.row.status=="4"?"success":"danger",effect:"dark",size:"small"},{default:r(()=>[p(n(e.row.statusDesc),1)]),_:2},1032,["type"])]),o("div",Re,[p(" 支付状态： "),a(v,{type:e.row.isPay=="1"?"success":"danger",effect:"dark",size:"small"},{default:r(()=>[p(n(e.row.isPay=="1"?"已支付":"未支付"),1)]),_:2},1032,["type"])])])]),_:1}),a(d,{align:"center",prop:"orderTime",label:"订单时间",width:"250"},{default:r(e=>[o("div",null,"创建时间："+n(e.row.createTime),1),e.row.paymentTime?(g(),y("div",ze," 付款时间："+n(e.row.paymentTime),1)):h("",!0),e.row.deliveryTime?(g(),y("div",je," 发货时间："+n(e.row.deliveryTime),1)):h("",!0),e.row.receiverTime?(g(),y("div",qe," 收货时间："+n(e.row.receiverTime),1)):h("",!0),e.row.closingTime?(g(),y("div",Ae," 成交时间："+n(e.row.closingTime),1)):h("",!0)]),_:1}),a(d,{align:"center",prop:"transactionId",label:"支付流水号"}),a(d,{align:"center",prop:"userMessage",label:"买家留言"})]),_:1},8,["data"])]),"listOrderItem-form":r(()=>[a(T,{data:u(w).listOrderItem,border:"",style:{width:"100%","margin-top":"-10px"}},{default:r(()=>[a(d,{align:"center",prop:"picUrl",label:"图片",width:"120"},{default:r(e=>[o("img",{src:e.row.picUrl,width:"100",height:"100"},null,8,Me)]),_:1}),a(d,{align:"center",prop:"spuName",label:"商品名"}),a(d,{align:"center",prop:"salesPrice",label:"商品单价",width:"100"},{default:r(e=>[p(" ￥"+n(e.row.salesPrice),1)]),_:1}),a(d,{align:"center",prop:"quantity",label:"数量",width:"50"}),a(d,{align:"center",prop:"salesPriceTotal",label:"商品总价",width:"100"},{default:r(e=>[p(" ￥"+n((e.row.salesPrice*e.row.quantity).toFixed(2)),1)]),_:1}),a(d,{align:"center",prop:"freightPrice",label:"运费金额",width:"100"},{default:r(e=>[p(" ￥"+n(e.row.freightPrice),1)]),_:1}),a(d,{align:"center",prop:"salesPriceTotal",label:"支付金额",width:"80"},{default:r(e=>[p(" ￥"+n(e.row.paymentPrice),1)]),_:1})]),_:1},8,["data"])]),"userId-form":r(()=>[a(T,{data:[u(w).userInfo],border:"",style:{width:"100%"}},{default:r(()=>[a(d,{align:"center",prop:"nickName",label:"用户名"},{default:r(e=>[a(ee,{icon:"el-icon-user-solid",src:e.row.headimgUrl},null,8,["src"]),o("div",null,n(e.row.nickName),1)]),_:1}),a(d,{align:"center",prop:"sex",label:"性别"},{default:r(e=>[o("div",null,n(e.row.sex=="1"?"男":e.row.sex=="2"?"女":"未知"),1)]),_:1}),a(d,{align:"center",prop:"id",label:"用户编号"})]),_:1},8,["data"])]),"orderLogistics-form":r(()=>[o("div",null,[a(T,{data:[u(w).orderLogistics],border:"",style:{width:"100%"}},{default:r(()=>[a(d,{align:"center",prop:"userName",label:"姓名"}),a(d,{align:"center",prop:"telNum",label:"电话"}),a(d,{align:"center",prop:"address",label:"地址"}),a(d,{align:"center",prop:"logisticsNo",label:"快递单号"}),a(d,{align:"center",prop:"logisticsDesc",label:"快递公司"}),a(d,{align:"center",prop:"statusDesc",label:"快递状态"})]),_:1},8,["data"])])]),name:r(e=>[(g(!0),y(fe,null,_e(e.row.listOrderItem,(m,ne)=>(g(),P(ae,{gutter:10,key:ne,style:{border:"1px solid #eaeaea",padding:"5px 0",display:"flex","align-items":"center"}},{default:r(()=>[a(O,{span:4,style:{display:"flex","align-items":"center"}},{default:r(()=>[a(te,{src:m.picUrl,style:{width:"60px",height:"60px"}},null,8,["src"])]),_:2},1024),a(O,{span:12,style:{"text-align":"left"}},{default:r(()=>[o("div",Ee,n(m.spuName),1),m.specInfo?(g(),y("div",Ge,n(m.specInfo),1)):h("",!0)]),_:2},1024),a(O,{span:8},{default:r(()=>[o("div",We," ￥"+n(m.paymentPrice),1),o("div",Ze,"×"+n(m.quantity)+"件",1),m.status=="2"?(g(),y("div",He,[a(v,{type:"danger"},{default:r(()=>[p("拒绝退款")]),_:1})])):h("",!0),m.status=="3"?(g(),y("div",Je,"同意退款")):h("",!0),m.isRefund=="1"?(g(),y("div",Ke,"已退款")):h("",!0),m.status=="1"&&e.row.isPay=="1"?(g(),P(L,{key:3,class:"grid-content",type:"danger",onClick:st=>q(m),plain:"",size:"small"},{default:r(()=>[p(" 申请退款 ")]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)]),_:2},1024))),128))]),createTime:r(e=>[o("div",null,[o("div",Qe,n(e.row.createTime),1),o("div",Xe,n(e.row.orderNo),1)])]),salesPrice:r(e=>[o("div",Ye,[o("div",et," 订单金额：￥"+n(e.row.salesPrice),1),o("div",tt," 运费金额：+ ￥"+n(e.row.freightPrice),1),o("div",at," 支付金额：￥"+n(e.row.paymentPrice),1)])]),menu:r(e=>[u(x)(["mall:orderinfo:get"])?(g(),P(L,{key:0,icon:"el-icon-edit",type:"primary",link:"",onClick:m=>M(e.row,e.index)},{default:r(()=>[p("订单详情 ")]),_:2},1032,["onClick"])):h("",!0),u(x)(["mall:orderinfo:edit"])&&e.row.status=="1"?(g(),P(L,{key:1,icon:"el-icon-position",type:"primary",link:"",onClick:m=>G(e.row,e.index)},{default:r(()=>[p("发货 ")]),_:2},1032,["onClick"])):h("",!0),u(x)(["mall:orderinfo:edit"])&&e.row.isPay=="0"&&!e.row.status?(g(),P(L,{key:2,icon:"el-icon-delete",type:"danger",link:"",onClick:m=>E(e.row,e.index)},{default:r(()=>[p("取消 ")]),_:2},1032,["onClick"])):h("",!0)]),_:1},8,["modelValue","page","data","permission","table-loading","option"])]),_:1},8,["modelValue"]),a(se,{title:"发货",modelValue:u(I),"onUpdate:modelValue":s[3]||(s[3]=e=>N(I)?I.value=e:null),width:"30%"},{default:r(()=>[a(oe,{option:u(z),modelValue:u(S),"onUpdate:modelValue":s[2]||(s[2]=e=>N(S)?S.value=e:null),onSubmit:W},null,8,["option","modelValue"])]),_:1},8,["modelValue"])])}}}),dt=ie(rt,[["__scopeId","data-v-1f86b4ec"]]);export{dt as default};

import{_ as v,W as M,d as P,a as $,p as E,g as F}from"./main-rttH6h2b.js";import{c as f}from"./permission-CtopeLks.js";import{a as O}from"./main-DtlCLU_N.js";import{_ as R,B as W,d as A,C as H,D as G,y as K,e as _,c as d,o as l,f as s,i as n,n as i,k as c,A as p,h,l as u,j as Z,G as q}from"./index-DxyzpFVi.js";import"./wxfreepublish-ncAXMMh-.js";/* empty css                                                             */import"./main.vue_vue_type_style_index_0_scoped_25ddb73a_lang-CRgDsjTq.js";import"./main-dgY30BGH.js";const J={dialogDrag:!0,border:!0,stripe:!0,menuAlign:"center",align:"center",menuType:"text",editBtn:!1,delBtn:!1,addBtn:!1,viewBtn:!1,searchBtn:!0,searchMenuSpan:6,defaultSort:{prop:"createTime",order:"descending"},column:[{label:"消息类型",prop:"repType",type:"select",dicData:[{value:"text",label:"文本"},{value:"image",label:"图片"},{value:"voice",label:"语音"},{value:"video",label:"视频"},{value:"shortvideo",label:"小视频"},{value:"location",label:"地理位置"},{value:"link",label:"链接消息"},{value:"event",label:"事件推送"}],search:!0,sortable:!0,width:120},{label:"用户",prop:"nickName",overHidden:!1,search:!0,slot:!0,width:100},{label:"内容",prop:"repContent",overHidden:!0,align:"left",slot:!0},{label:"时间",type:"date",prop:"createTime",sortable:!0,width:200},{label:"是否已读",prop:"readFlag",type:"select",dicData:[{value:"1",label:"是"},{value:"0",label:"否"}],search:!0,sortable:!0,slot:!0,width:150}]},Q=["src"],X={class:"nick-name"},Y={key:0},ee={key:1},te={key:2},ae={key:3},re={key:4},ne={key:5},se={key:6},oe=["href"],le=["src"],ie={key:7},de={key:8},ce={key:9},pe={key:10},ue=["href"],ge=W({name:"WxMpMsg"}),me=Object.assign(ge,{setup(_e){const{proxy:m}=A(),t=H({dialogMsgVisible:!1,tableData:[],page:{total:0,currentPage:1,pageSize:20,ascs:[],descs:"create_time"},paramsSearch:{},tableLoading:!1,wxUserId:""}),{tableData:y,tableLoading:x,page:k,dialogMsgVisible:w,wxUserId:C}=G(t),T=K(()=>({addBtn:f(["wxmp:wxmsg:add"]),delBtn:f(["wxmp:wxmsg:del"]),editBtn:f(["wxmp:wxmsg:edit"]),viewBtn:f(["wxmp:wxmsg:get"])}));function D(a){t.wxUserId=a.wxUserId,t.dialogMsgVisible=!0,a.readFlag="1"}function B(a,o){a=m.filterForm(a),t.paramsSearch=a,t.page.currentPage=1,g(t.page,a),o()}function S(a){let o=a.prop?a.prop.replace(/([A-Z])/g,"_$1").toLowerCase():"";a.order=="ascending"?(t.page.descs=[],t.page.ascs=o):a.order=="descending"?(t.page.ascs=[],t.page.descs=o):(t.page.ascs=[],t.page.descs=[]),g(t.page)}function g(a,o){t.tableLoading=!0,F(Object.assign({current:a.currentPage,size:a.pageSize,descs:t.page.descs,ascs:t.page.ascs,type:"1"},o,t.paramsSearch)).then(r=>{t.tableData=r.data.records,t.page.total=r.data.total,t.page.currentPage=a.currentPage,t.page.pageSize=a.pageSize,t.tableLoading=!1}).catch(()=>{t.tableLoading=!1})}function U(a,o){m.$confirm("是否确认删除此数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return P(a.id)}).then(()=>{m.$message({showClose:!0,message:"删除成功",type:"success"}),g(t.page)}).catch(function(r){})}function z(a,o,r,b){E(a).then(()=>{m.$message({showClose:!0,message:"修改成功",type:"success"}),r(),g(t.page)}).catch(()=>{b()})}function j(a,o,r){$(a).then(()=>{m.$message({showClose:!0,message:"添加成功",type:"success"}),o(),g(t.page)}).catch(()=>{r()})}function V(a){g(t.page)}return(a,o)=>{const r=_("el-tag"),b=_("el-badge"),N=_("el-button"),I=_("avue-crud"),L=_("el-dialog");return l(),d("div",null,[s(I,{ref:"crud",page:u(k),data:u(y),permission:u(T),"table-loading":u(x),option:u(J),onOnLoad:g,onRefreshChange:V,onRowUpdate:z,onRowSave:j,onRowDel:U,onSortChange:S,onSearchChange:B},{appName:n(e=>[s(r,{type:"success",size:"small"},{default:n(()=>[i(p(e.row.appName),1)]),_:2},1024)]),nickName:n(e=>[s(b,{value:e.row.countMsg,class:"count-msg"},{default:n(()=>[h("img",{class:"head-img",src:e.row.headimgUrl},null,8,Q),h("div",X,p(e.row.nickName),1)]),_:2},1032,["value"])]),readFlag:n(e=>[s(r,{type:e.row.readFlag=="1"?"success":"danger",size:"small"},{default:n(()=>[i(p(e.row.$readFlag),1)]),_:2},1032,["type"])]),repContent:n(e=>[e.row.repType=="event"&&e.row.repEvent=="subscribe"?(l(),d("div",Y,[s(r,{type:"success",size:"small"},{default:n(()=>[i("关注")]),_:1})])):c("",!0),e.row.repType=="event"&&e.row.repEvent=="unsubscribe"?(l(),d("div",ee,[s(r,{type:"danger",size:"small"},{default:n(()=>[i("取消关注")]),_:1})])):c("",!0),e.row.repType=="event"&&e.row.repEvent=="CLICK"?(l(),d("div",te,[s(r,{size:"small"},{default:n(()=>[i("点击菜单")]),_:1}),i("：【"+p(e.row.repName)+"】",1)])):c("",!0),e.row.repType=="event"&&e.row.repEvent=="VIEW"?(l(),d("div",ae,[s(r,{size:"small"},{default:n(()=>[i("点击菜单链接")]),_:1}),i("：【"+p(e.row.repUrl)+"】",1)])):c("",!0),e.row.repType=="event"&&e.row.repEvent=="scancode_waitmsg"?(l(),d("div",re,[s(r,{size:"small"},{default:n(()=>[i("扫码结果：")]),_:1}),i("：【"+p(e.row.repContent)+"】",1)])):c("",!0),e.row.repType=="text"?(l(),d("div",ne,p(e.row.repContent),1)):c("",!0),e.row.repType=="image"?(l(),d("div",se,[h("a",{target:"_blank",href:e.row.repUrl},[h("img",{src:e.row.repUrl,style:{width:"100px"}},null,8,le)],8,oe)])):c("",!0),e.row.repType=="voice"?(l(),d("div",ie,[s(O,{objData:e.row},null,8,["objData"])])):c("",!0),e.row.repType=="video"?(l(),d("div",de,[s(v,{objData:e.row,style:{"margin-top":"40px"}},null,8,["objData"])])):c("",!0),e.row.repType=="shortvideo"?(l(),d("div",ce,[s(v,{objData:e.row,style:{"margin-top":"40px"}},null,8,["objData"])])):c("",!0),e.row.repType=="link"?(l(),d("div",pe,[s(r,{size:"small"},{default:n(()=>[i("链接")]),_:1}),i("："),h("a",{href:e.row.repUrl,target:"_blank"},p(e.row.repName),9,ue)])):c("",!0)]),menu:n(e=>[s(N,{link:"",icon:"el-icon-chat-line-round",type:"primary",plain:"",onClick:he=>D(e.row,e.index)},{default:n(()=>[i("消息")]),_:2},1032,["onClick"])]),_:1},8,["page","data","permission","table-loading","option"]),s(L,{title:"用户消息",modelValue:u(w),"onUpdate:modelValue":o[0]||(o[0]=e=>q(w)?w.value=e:null),width:"700px"},{default:n(()=>[u(w)?(l(),Z(M,{key:0,wxUserId:u(C)},null,8,["wxUserId"])):c("",!0)]),_:1},8,["modelValue"])])}}}),Te=R(me,[["__scopeId","data-v-68a7c273"]]);export{Te as default};

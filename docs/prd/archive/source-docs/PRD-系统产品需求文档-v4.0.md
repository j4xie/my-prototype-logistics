# ç™½å©çºªé£Ÿå“æº¯æºç³»ç»Ÿ - äº§å“éœ€æ±‚æ–‡æ¡£ (PRD) v4.0

**æ–‡æ¡£ç‰ˆæœ¬**: v4.0 (åˆ†é˜¶æ®µç‰ˆæœ¬)
**åˆ›å»ºæ—¥æœŸ**: 2025-01-05
**æœ€åæ›´æ–°**: 2025-10-26
**é¡¹ç›®çŠ¶æ€**: Phase 1-2 å·²å®Œæˆ âœ… | Phase 3 å¼€å‘ä¸­ ğŸ”¨ | Phase 4-5 è®¡åˆ’ä¸­ ğŸ“…

---

## ğŸ“‹ ç›®å½•

1. [äº§å“æ¦‚è¿°](#äº§å“æ¦‚è¿°)
2. [ç”¨æˆ·è§’è‰²ä½“ç³»](#ç”¨æˆ·è§’è‰²ä½“ç³»)
3. [ç°æœ‰åŠŸèƒ½æ¨¡å—](#ç°æœ‰åŠŸèƒ½æ¨¡å—-phase-1-2-å·²å®Œæˆ)
4. [å¾…å®Œå–„åŠŸèƒ½æ¨¡å—](#å¾…å®Œå–„åŠŸèƒ½æ¨¡å—-phase-3-å¼€å‘ä¸­)
5. [æœªæ¥è§„åˆ’](#æœªæ¥è§„åˆ’-phase-4)
6. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
7. [APIè®¾è®¡](#apiè®¾è®¡)
8. [éåŠŸèƒ½éœ€æ±‚](#éåŠŸèƒ½éœ€æ±‚)

---

## äº§å“æ¦‚è¿°

### 1.1 äº§å“å®šä½

ç™½å©çºªé£Ÿå“æº¯æºç³»ç»Ÿæ˜¯ä¸€ä¸ªé¢å‘é£Ÿå“åŠ å·¥è¡Œä¸šçš„**å¤šç§Ÿæˆ·**ã€**ç§»åŠ¨ä¼˜å…ˆ**çš„å…¨æµç¨‹æº¯æºç®¡ç†å¹³å°ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š
- ğŸ“± **ç§»åŠ¨ä¼˜å…ˆ**: React Native è·¨å¹³å°ç§»åŠ¨åº”ç”¨
- ğŸ­ **å¤šç§Ÿæˆ·æ¶æ„**: æ”¯æŒå¤šå·¥å‚ç‹¬ç«‹è¿è¥
- ğŸ” **ç²¾ç»†æƒé™**: 7çº§è§’è‰²æƒé™ä½“ç³»
- ğŸ“Š **æ™ºèƒ½åˆ†æ**: DeepSeek LLM æˆæœ¬åˆ†æ
- ğŸ”„ **å…¨ç¨‹æº¯æº**: ä»åŸæ–™åˆ°æˆå“çš„å®Œæ•´è¿½è¸ª

### 1.2 ç›®æ ‡ç”¨æˆ·

| ç”¨æˆ·ç±»å‹ | äººæ•°å æ¯” | ä¸»è¦åœºæ™¯ |
|---------|---------|---------|
| **å¹³å°ç®¡ç†å‘˜** | 2-5äºº | ç®¡ç†æ‰€æœ‰å·¥å‚ã€å¹³å°é…ç½® |
| **å·¥å‚è¶…ç®¡** | æ¯å‚1-2äºº | å·¥å‚å…¨å±€ç®¡ç† |
| **éƒ¨é—¨ç®¡ç†å‘˜** | æ¯å‚3-5äºº | éƒ¨é—¨ä¸šåŠ¡ç®¡ç† |
| **æ“ä½œå‘˜** | æ¯å‚10-50äºº | æ—¥å¸¸æ•°æ®å½•å…¥ã€æ‰“å¡ |

### 1.3 äº§å“èŒƒå›´

**å½“å‰ç‰ˆæœ¬ (Phase 1-2 âœ…)**:
- âœ… å®Œæ•´çš„è®¤è¯æˆæƒç³»ç»Ÿ
- âœ… åŠ å·¥æ¨¡å— (æ‰¹æ¬¡ã€è´¨æ£€ã€æˆæœ¬æ ¸ç®—)
- âœ… å‘˜å·¥æ‰“å¡å’Œå·¥æ—¶ç»Ÿè®¡
- âœ… ç³»ç»Ÿé…ç½®å’Œç®¡ç†
- âœ… AIé…é¢ç®¡ç†

**å¾…å®Œå–„ (Phase 3 ğŸ”¨)**:
- ğŸ”¨ è®¾å¤‡ç›‘æ§å’Œå‘Šè­¦
- ğŸ”¨ ç”¨æˆ·æ³¨å†Œæµç¨‹
- ğŸ”¨ æ•°æ®æŠ¥è¡¨å¯¼å‡º
- ğŸ”¨ è´¨æ£€å®Œæ•´æµç¨‹

**æœªæ¥è§„åˆ’ (Phase 4+)**:
- ğŸš€ å…»æ®–æ¨¡å—
- ğŸš€ ç‰©æµæ¨¡å—
- ğŸš€ é”€å”®æ¨¡å—
- ğŸš€ Web ç®¡ç†åå°

---

## ç”¨æˆ·è§’è‰²ä½“ç³»

### 2.1 è§’è‰²å±‚çº§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å¹³å°å±‚ (Platform Layer)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     platform_admin (å¹³å°ç®¡ç†å‘˜)    â”‚    â”‚
â”‚  â”‚   - ç®¡ç†æ‰€æœ‰å·¥å‚                   â”‚    â”‚
â”‚  â”‚   - ç®¡ç†æ‰€æœ‰ç”¨æˆ·                   â”‚    â”‚
â”‚  â”‚   - å¹³å°çº§é…ç½®                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å·¥å‚å±‚ (Factory Layer)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  factory_super_admin (å·¥å‚è¶…ç®¡)   â”‚    â”‚
â”‚  â”‚   - å·¥å‚æ‰€æœ‰æƒé™                   â”‚    â”‚
â”‚  â”‚   - ç”¨æˆ·ç®¡ç†                      â”‚    â”‚
â”‚  â”‚   - æ‰€æœ‰éƒ¨é—¨æ•°æ®                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                    â”‚                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚         â†“          â†“          â†“          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚permissionâ”‚ â”‚departmentâ”‚ â”‚ operator â”‚ â”‚
â”‚  â”‚  _admin  â”‚ â”‚  _admin  â”‚ â”‚          â”‚ â”‚
â”‚  â”‚æƒé™ç®¡ç†å‘˜ â”‚ â”‚éƒ¨é—¨ç®¡ç†å‘˜ â”‚ â”‚  æ“ä½œå‘˜  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                â”‚
â”‚         â†“                                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚    â”‚viewerâ”‚                              â”‚
â”‚    â”‚æŸ¥çœ‹è€…â”‚                              â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æƒé™çŸ©é˜µ

| åŠŸèƒ½æ¨¡å— | platform_admin | factory_super_admin | permission_admin | department_admin | operator | viewer |
|---------|----------------|---------------------|------------------|------------------|----------|--------|
| **ç™»å½•è®¤è¯** | âœ… ä¸æ‰“å¡ | âœ… éœ€æ‰“å¡ | âœ… éœ€æ‰“å¡ | âœ… éœ€æ‰“å¡ | âœ… éœ€æ‰“å¡ | âŒ |
| **åŸææ–™å…¥åº“** | ğŸ‘ï¸ åªè¯» | âœ… å¢åˆ æ”¹æŸ¥ | âŒ | âŒ | âŒ | âŒ |
| **ç”Ÿäº§è®¡åˆ’** | ğŸ‘ï¸ åªè¯» | âœ… å…¨éƒ¨ | ğŸ‘ï¸ åªè¯» | âœ… æœ¬éƒ¨é—¨ | ğŸ‘ï¸ æŸ¥çœ‹ | âŒ |
| **æˆæœ¬åˆ†æ** | ğŸ‘ï¸ å…¨å·¥å‚ | âœ… æœ¬å·¥å‚ | ğŸ‘ï¸ æœ¬å·¥å‚ | âœ… æœ¬éƒ¨é—¨ | âŒ | âŒ |
| **å‘˜å·¥ç®¡ç†** | âœ… å…¨å¹³å° | âœ… æœ¬å·¥å‚ | âœ… æƒé™åˆ†é… | âœ… æœ¬éƒ¨é—¨ | âŒ | âŒ |
| **ç³»ç»Ÿé…ç½®** | âœ… å¹³å°çº§ | âœ… å·¥å‚çº§ | âŒ | âŒ | âŒ | âŒ |

---

## ç°æœ‰åŠŸèƒ½æ¨¡å— (Phase 1-2 å·²å®Œæˆ âœ…)

### 3.1 è®¤è¯æˆæƒæ¨¡å— âœ…

**åŠŸèƒ½**: ç»Ÿä¸€ç™»å½•ã€è®¾å¤‡ç»‘å®š

**APIç«¯ç‚¹**:
- `POST /api/mobile/auth/unified-login` - ç»Ÿä¸€ç™»å½•
- `POST /api/mobile/auth/refresh-token` - åˆ·æ–°Token
- `POST /api/mobile/auth/logout` - ç™»å‡º
- `POST /api/mobile/auth/bind-device` - ç»‘å®šè®¾å¤‡

**å·²å®ç°é¡µé¢**:
- âœ… EnhancedLoginScreen - ç”¨æˆ·å/å¯†ç ç™»å½•ã€ç”Ÿç‰©è¯†åˆ«

**å¾…å®ç°é¡µé¢** (Phase 3):
- âŒ RegisterPhaseOneScreen - æ‰‹æœºéªŒè¯
- âŒ RegisterPhaseTwoScreen - å®Œå–„ä¿¡æ¯
- âŒ ForgotPasswordScreen - å¿˜è®°å¯†ç 

---

### 3.2 åŠ å·¥æ¨¡å— âœ…

**å­æ¨¡å—**:

#### 3.2.1 ç”Ÿäº§æ‰¹æ¬¡ç®¡ç† âœ…
**åŠŸèƒ½**: åˆ›å»ºæ‰¹æ¬¡ã€çŠ¶æ€æµè½¬ã€æ¯æ—¥è®°å½•

**å·²å®ç°é¡µé¢**:
- âœ… ProcessingDashboard - ç”Ÿäº§ä»ªè¡¨æ¿
- âœ… BatchListScreen - æ‰¹æ¬¡åˆ—è¡¨
- âœ… BatchDetailScreen - æ‰¹æ¬¡è¯¦æƒ…
- âœ… CreateBatchScreen - åˆ›å»ºæ‰¹æ¬¡
- âœ… ProductionPlanManagementScreen - ç”Ÿäº§è®¡åˆ’ç®¡ç†

**APIç«¯ç‚¹**:
- `POST /api/mobile/processing/batches` - åˆ›å»ºæ‰¹æ¬¡
- `GET /api/mobile/processing/batches` - æŸ¥è¯¢æ‰¹æ¬¡åˆ—è¡¨
- `GET /api/mobile/processing/batches/:id` - æŸ¥è¯¢æ‰¹æ¬¡è¯¦æƒ…
- `PUT /api/mobile/processing/batches/:id` - æ›´æ–°æ‰¹æ¬¡

#### 3.2.2 è´¨é‡æ£€éªŒ (éƒ¨åˆ†å®ç°)
**åŠŸèƒ½**: åˆ›å»ºè´¨æ£€è®°å½•ã€ä¸Šä¼ ç…§ç‰‡ã€è®°å½•ä¸åˆæ ¼é¡¹

**å·²å®ç°é¡µé¢**:
- âœ… QualityInspectionListScreen - è´¨æ£€åˆ—è¡¨

**å¾…å®ç°é¡µé¢** (Phase 3 P1):
- âŒ CreateQualityRecordScreen - åˆ›å»ºè´¨æ£€
- âŒ QualityInspectionDetailScreen - è´¨æ£€è¯¦æƒ…

**APIç«¯ç‚¹**:
- `POST /api/mobile/processing/quality-inspections` - åˆ›å»ºè´¨æ£€
- `GET /api/mobile/processing/quality-inspections/:id` - è´¨æ£€è¯¦æƒ…

#### 3.2.3 åŸææ–™ç®¡ç† âœ…
**åŠŸèƒ½**: FIFOå…¥åº“ã€åº“å­˜æŸ¥è¯¢ã€åˆ°æœŸé¢„è­¦

**å·²å®ç°é¡µé¢**:
- âœ… MaterialReceiptScreen - åŸææ–™å…¥åº“
- âœ… MaterialBatchManagementScreen - åŸææ–™æ‰¹æ¬¡ç®¡ç†

**APIç«¯ç‚¹**:
- `POST /api/mobile/inventory/receipts` - åŸææ–™å…¥åº“
- `GET /api/mobile/inventory/stock` - æŸ¥è¯¢åº“å­˜
- `GET /api/mobile/inventory/batches/:id` - æ‰¹æ¬¡è¯¦æƒ…

#### 3.2.4 æˆæœ¬æ ¸ç®— âœ…
**åŠŸèƒ½**: 4ç»´æˆæœ¬åˆ†æã€æˆæœ¬è®¡ç®—

**å·²å®ç°é¡µé¢**:
- âœ… CostAnalysisDashboard - æˆæœ¬åˆ†æä»ªè¡¨æ¿

**å¾…å®ç°é¡µé¢** (Phase 3 P1):
- âŒ DeepSeekAnalysisScreen - AIæ™ºèƒ½åˆ†æè¯¦æƒ…
- âŒ CostComparisonScreen - æˆæœ¬å¯¹æ¯”åˆ†æ

**APIç«¯ç‚¹**:
- `GET /api/mobile/processing/cost/:batchId` - æˆæœ¬åˆ†æ
- `POST /api/mobile/analysis/deepseek` - AIåˆ†æ
- `GET /api/mobile/analysis/deepseek/:planId` - AIåˆ†æç»“æœ

#### 3.2.5 è®¾å¤‡ç›‘æ§ (æœªé›†æˆ âš ï¸)
**åŠŸèƒ½**: è®¾å¤‡å‚æ•°ç›‘æ§ã€å‘Šè­¦ç®¡ç†

**å·²æœ‰æ–‡ä»¶**:
- âš ï¸ EquipmentMonitoringScreen - æ–‡ä»¶å­˜åœ¨äº `src/screens/future/`

**å¾…å®ç°é¡µé¢** (Phase 3 P0):
- âš ï¸ é›†æˆEquipmentMonitoringScreenåˆ°å¯¼èˆª
- âŒ EquipmentDetailScreen - è®¾å¤‡è¯¦æƒ…
- âŒ EquipmentAlertsScreen - è®¾å¤‡å‘Šè­¦

**APIç«¯ç‚¹**:
- `GET /api/mobile/processing/equipment/monitoring` - è®¾å¤‡ç›‘æ§
- `GET /api/mobile/processing/equipment/:id` - è®¾å¤‡è¯¦æƒ…
- `GET /api/mobile/processing/equipment/alerts` - å‘Šè­¦åˆ—è¡¨

---

### 3.3 å‘˜å·¥ç®¡ç†æ¨¡å— âœ…

#### 3.3.1 å‘˜å·¥æ‰“å¡ âœ…
**åŠŸèƒ½**: ä¸Šç­/ä¸‹ç­æ‰“å¡ã€GPSéªŒè¯

**å·²å®ç°é¡µé¢**:
- âœ… TimeClockScreen - è€ƒå‹¤æ‰“å¡

**APIç«¯ç‚¹**:
- `POST /api/mobile/timeclock/clock-in` - ä¸Šç­æ‰“å¡
- `POST /api/mobile/timeclock/clock-out` - ä¸‹ç­æ‰“å¡

#### 3.3.2 å·¥æ—¶ç»Ÿè®¡ âœ…
**åŠŸèƒ½**: æ—¥/å‘¨/æœˆå·¥æ—¶ç»Ÿè®¡

**å·²å®ç°é¡µé¢**:
- âœ… AttendanceStatisticsScreen - å·¥æ—¶ç»Ÿè®¡

**å¾…å®ç°é¡µé¢** (Phase 3 P2):
- âŒ AttendanceHistoryScreen - æ‰“å¡å†å²

**APIç«¯ç‚¹**:
- `GET /api/mobile/time-stats/daily` - æ—¥ç»Ÿè®¡
- `GET /api/mobile/time-stats/weekly` - å‘¨ç»Ÿè®¡
- `GET /api/mobile/time-stats/monthly` - æœˆç»Ÿè®¡

---

### 3.4 ç³»ç»Ÿç®¡ç†æ¨¡å— âœ…

#### 3.4.1 é…ç½®ç®¡ç† âœ…
**å·²å®ç°é¡µé¢**:
- âœ… ManagementScreen - ç®¡ç†é¦–é¡µ
- âœ… ProductTypeManagementScreen - äº§å“ç±»å‹
- âœ… MaterialTypeManagementScreen - åŸææ–™ç±»å‹
- âœ… ConversionRateScreen - è½¬æ¢ç‡é…ç½®
- âœ… WorkTypeManagementScreen - å·¥ä½œç±»å‹
- âœ… AISettingsScreen - AIåˆ†æè®¾ç½®

#### 3.4.2 ç”¨æˆ·ç®¡ç† âœ…
**å·²å®ç°é¡µé¢**:
- âœ… UserManagementScreen - ç”¨æˆ·ç®¡ç†
- âœ… WhitelistManagementScreen - ç™½åå•ç®¡ç†

#### 3.4.3 ä¾›åº”å•†ä¸å•†å®¶ç®¡ç† âœ…
**å·²å®ç°é¡µé¢**:
- âœ… SupplierManagementScreen - ä¾›åº”å•†ç®¡ç†
- âœ… CustomerManagementScreen - å•†å®¶å®¢æˆ·ç®¡ç†

#### 3.4.4 å·¥å‚è®¾ç½® (æœªå®ç° âŒ)
**å¾…å®ç°é¡µé¢** (Phase 3 P2):
- âŒ FactorySettingsScreen - å·¥å‚è®¾ç½®

---

### 3.5 å¹³å°ç®¡ç†æ¨¡å— âœ…

**å·²å®ç°é¡µé¢**:
- âœ… AIQuotaManagementScreen - AIé…é¢ç®¡ç†

**å¾…å®ç°é¡µé¢** (Phase 4):
- âŒ PlatformDashboardScreen - å¹³å°ä»ªè¡¨æ¿
- âŒ FactoryListScreen - å·¥å‚åˆ—è¡¨
- âŒ SystemMonitoringScreen - ç³»ç»Ÿç›‘æ§

---

### 3.6 ä¸»å¯¼èˆªä¸ä¸ªäººä¸­å¿ƒ âœ…

**å·²å®ç°é¡µé¢**:
- âœ… HomeScreen - é¦–é¡µ
- âœ… ProfileScreen - ä¸ªäººä¸­å¿ƒ

---

## å¾…å®Œå–„åŠŸèƒ½æ¨¡å— (Phase 3 å¼€å‘ä¸­ ğŸ”¨)

### 4.1 P0çº§ä»»åŠ¡ (ç´§æ€¥ä¿®å¤)

#### è®¾å¤‡ç›‘æ§é›†æˆ âš ï¸
**çŠ¶æ€**: æ–‡ä»¶å­˜åœ¨ï¼Œéœ€è¦é›†æˆ

**ä»»åŠ¡åˆ—è¡¨**:
- [ ] å°† EquipmentMonitoringScreen ä» `src/screens/future/` ç§»åˆ° `src/screens/processing/`
- [ ] æ·»åŠ åˆ° ProcessingStackNavigator
- [ ] åœ¨ ProcessingDashboard æ·»åŠ å¯¼èˆªæŒ‰é’®
- [ ] è¿æ¥è®¾å¤‡ç›‘æ§API

**é¢„è®¡å·¥ä½œé‡**: 2å°æ—¶

---

### 4.2 P1çº§ä»»åŠ¡ (æ ¸å¿ƒåŠŸèƒ½å®Œå–„)

#### AIæ™ºèƒ½åˆ†æè¯¦æƒ…é¡µ ğŸ”¨
**éœ€æ±‚**: å±•ç¤ºDeepSeekåˆ†æçš„5ç»´æ·±åº¦åˆ†æã€ä¼˜åŒ–å»ºè®®

**ä»»åŠ¡**:
- [ ] åˆ›å»º DeepSeekAnalysisScreen
- [ ] ä» CostAnalysisDashboard æ·»åŠ è·³è½¬æŒ‰é’®
- [ ] å±•ç¤ºåˆ†æç»´åº¦ï¼šè½¬æ¢ç‡ã€äººå·¥æˆæœ¬ã€è®¾å¤‡æˆæœ¬ã€åŸæ–™æˆæœ¬ã€ä¸ªäººæ•ˆç‡
- [ ] å±•ç¤º3-5æ¡ä¼˜åŒ–å»ºè®®
- [ ] æ”¯æŒæŠ¥å‘Šå¯¼å‡º

**åç«¯APIéœ€æ±‚**:
```
GET /api/mobile/analysis/deepseek/:planId
è¿”å›: {
  analysisType, model, analysisText,
  recommendations: [{priority, title, description, estimatedSavings}],
  confidence, timestamp
}
```

**é¢„è®¡å·¥ä½œé‡**: 1å¤©

---

#### è´¨æ£€å®Œæ•´æµç¨‹ ğŸ”¨
**éœ€æ±‚**: å®Œæ•´çš„è´¨æ£€è®°å½•åˆ›å»ºä¸æŸ¥çœ‹

**ä»»åŠ¡**:
- [ ] åˆ›å»º CreateQualityRecordScreen
  - è´¨æ£€ç±»å‹é€‰æ‹©ï¼ˆåŸæ–™/è¿‡ç¨‹/æˆå“ï¼‰
  - è¯„åˆ†ç³»ç»Ÿ
  - ç…§ç‰‡ä¸Šä¼ 
  - ä¸åˆæ ¼é¡¹è®°å½•
  - æµè½¬çŠ¶æ€

- [ ] åˆ›å»º QualityInspectionDetailScreen
  - è´¨æ£€è¯¦æƒ…å±•ç¤º
  - å†å²è®°å½•
  - ç…§ç‰‡æŸ¥çœ‹

**åç«¯APIéœ€æ±‚**:
```
POST /api/mobile/processing/quality-inspections
è¯·æ±‚: {
  batchId, inspectionType, score, photos, defectItems, notes
}
è¿”å›: { id, status, timestamp }

GET /api/mobile/processing/quality-inspections/:id
è¿”å›: å®Œæ•´è´¨æ£€è®°å½•
```

**é¢„è®¡å·¥ä½œé‡**: 2å¤©

---

#### æˆæœ¬å¯¹æ¯”åˆ†æ ğŸ”¨
**éœ€æ±‚**: å†å²æ‰¹æ¬¡æˆæœ¬å¯¹æ¯”ã€æˆæœ¬è¶‹åŠ¿

**ä»»åŠ¡**:
- [ ] åˆ›å»º CostComparisonScreen
- [ ] å±•ç¤ºå†å²æ‰¹æ¬¡å¯¹æ¯”è¡¨
- [ ] æˆæœ¬è¶‹åŠ¿å›¾è¡¨
- [ ] æˆæœ¬é¢„æµ‹

**åç«¯APIéœ€æ±‚**:
```
GET /api/mobile/processing/cost/comparison?startDate=&endDate=
è¿”å›: [{ batchId, batchNumber, cost, costPerKg, deviation, date }]
```

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

#### è®¾å¤‡å‘Šè­¦ç³»ç»Ÿ ğŸ”¨
**éœ€æ±‚**: è®¾å¤‡å‘Šè­¦åˆ—è¡¨ã€å¤„ç†æµç¨‹

**ä»»åŠ¡**:
- [ ] åˆ›å»º EquipmentAlertsScreen
- [ ] å‘Šè­¦åˆ†çº§å±•ç¤ºï¼ˆcritical/warning/infoï¼‰
- [ ] å‘Šè­¦å¤„ç†æµç¨‹

**åç«¯APIéœ€æ±‚**:
```
GET /api/mobile/processing/equipment/alerts?status=
è¿”å›: { id, equipmentId, alertLevel, type, message, timestamp, status }
```

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

#### è®¾å¤‡è¯¦æƒ…é¡µ ğŸ”¨
**éœ€æ±‚**: è®¾å¤‡å‚æ•°ã€è¿è¡ŒçŠ¶æ€ã€ç»´æŠ¤è®°å½•

**ä»»åŠ¡**:
- [ ] åˆ›å»º EquipmentDetailScreen
- [ ] æ˜¾ç¤ºè®¾å¤‡åŸºæœ¬ä¿¡æ¯
- [ ] å®æ—¶å‚æ•°ç›‘æ§
- [ ] ç»´æŠ¤è®°å½•å†å²

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

### 4.3 P2çº§ä»»åŠ¡ (é‡è¦è¾…åŠ©åŠŸèƒ½)

#### ç”¨æˆ·æ³¨å†Œæµç¨‹ ğŸ”¨
**éœ€æ±‚**: ä¸¤é˜¶æ®µæ³¨å†Œï¼Œç™½åå•æ£€æŸ¥ï¼ŒéªŒè¯ç 

**ä»»åŠ¡**:
- [ ] åˆ›å»º RegisterPhaseOneScreen
  - æ‰‹æœºå·è¾“å…¥
  - éªŒè¯ç å‘é€
  - ç™½åå•æ£€æŸ¥
  - tempTokenè·å–

- [ ] åˆ›å»º RegisterPhaseTwoScreen
  - ç”¨æˆ·ä¿¡æ¯è¡¥å…¨
  - å¯†ç è®¾ç½®
  - éƒ¨é—¨é€‰æ‹©
  - æœ€ç»ˆæ³¨å†Œ

**åç«¯APIéœ€æ±‚**:
```
POST /api/mobile/auth/register-phase-one
POST /api/mobile/auth/register-phase-two
```

**é¢„è®¡å·¥ä½œé‡**: 2å¤©

---

#### æ•°æ®æŠ¥è¡¨å¯¼å‡º ğŸ”¨
**éœ€æ±‚**: æ”¯æŒExcel/PDF/CSVå¯¼å‡º

**ä»»åŠ¡**:
- [ ] åˆ›å»º DataExportScreen
- [ ] é€‰æ‹©æŠ¥è¡¨ç±»å‹ï¼ˆç”Ÿäº§/æˆæœ¬/å·¥æ—¶ï¼‰
- [ ] é€‰æ‹©æ—¥æœŸèŒƒå›´
- [ ] å¯¼å‡ºæ ¼å¼é€‰æ‹©
- [ ] åå°ç”Ÿæˆå¹¶ä¸‹è½½

**åç«¯APIéœ€æ±‚**:
```
POST /api/mobile/reports/export
è¯·æ±‚: { reportType, startDate, endDate, format }
è¿”å›: { downloadUrl, expiresAt }
```

**é¢„è®¡å·¥ä½œé‡**: 1.5å¤©

---

#### æ‰“å¡å†å²æŸ¥è¯¢ ğŸ”¨
**éœ€æ±‚**: æŒ‰æ—¥æœŸç­›é€‰æ‰“å¡è®°å½•

**ä»»åŠ¡**:
- [ ] åˆ›å»º AttendanceHistoryScreen
- [ ] æ—¥æœŸèŒƒå›´ç­›é€‰
- [ ] æ‰“å¡è®°å½•åˆ—è¡¨
- [ ] å¯¼å‡ºåŠŸèƒ½

**åç«¯APIéœ€æ±‚**:
```
GET /api/mobile/timeclock/history?startDate=&endDate=
```

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

#### å·¥å‚è®¾ç½® ğŸ”¨
**éœ€æ±‚**: å·¥å‚é…ç½®ç®¡ç†

**ä»»åŠ¡**:
- [ ] åˆ›å»º FactorySettingsScreen
- [ ] å·¥å‚åŸºæœ¬ä¿¡æ¯
- [ ] å·¥ä½œæ—¶é—´è®¾ç½®
- [ ] å‡æœŸé…ç½®
- [ ] éƒ¨é—¨ç®¡ç†

**é¢„è®¡å·¥ä½œé‡**: 1å¤©

---

#### ç”Ÿäº§æ•°æ®åˆ†æä¸å¯è§†åŒ– ğŸ”¨
**éœ€æ±‚**: å¢å¼ºProcessingDashboardçš„æ•°æ®å±•ç¤º

**ä»»åŠ¡**:
- [ ] æ·»åŠ å‘¨/æœˆè¶‹åŠ¿åˆ†æå›¾è¡¨
- [ ] å‘˜å·¥æ•ˆç‡æ’å
- [ ] æ‰¹æ¬¡å®Œæˆç‡ç»Ÿè®¡
- [ ] è®¾å¤‡è¿è¡Œç‡ç»Ÿè®¡

**é¢„è®¡å·¥ä½œé‡**: 1.5å¤©

---

#### è´¨æ£€ç»Ÿè®¡åˆ†æ ğŸ”¨
**ä»»åŠ¡**:
- [ ] åˆ›å»º QualityAnalyticsScreen
- [ ] åˆæ ¼ç‡è¶‹åŠ¿
- [ ] ä¸åˆæ ¼åŸå› åˆ†æ
- [ ] éƒ¨é—¨è´¨é‡æ’å

**é¢„è®¡å·¥ä½œé‡**: 1å¤©

---

#### å‘˜å·¥æ•ˆç‡MLé¢„æµ‹ ğŸ”¨
**ä»»åŠ¡**:
- [ ] åœ¨ç®¡ç†æ¨¡å—æ·»åŠ å‘˜å·¥æ•ˆç‡è¯„åˆ†
- [ ] MLæ¨¡å‹é¢„æµ‹
- [ ] ä¸ªäººè¯„åˆ†å±•ç¤º
- [ ] å¯¹æ ‡åˆ†æ

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

#### åº“å­˜ç›˜ç‚¹åŠŸèƒ½ ğŸ”¨
**ä»»åŠ¡**:
- [ ] åœ¨åº“å­˜æ¨¡å—æ·»åŠ ç›˜ç‚¹åŠŸèƒ½
- [ ] å®ç‰©æ•°é‡ä¸ç³»ç»Ÿå¯¹è´¦
- [ ] å·®å¼‚å¤„ç†æµç¨‹

**é¢„è®¡å·¥ä½œé‡**: 0.5å¤©

---

#### å¼‚å¸¸é¢„è­¦ç³»ç»Ÿ ğŸ”¨
**ä»»åŠ¡**:
- [ ] åˆ°æœŸé¢„è­¦
- [ ] æˆæœ¬è¶…æ”¯é¢„è­¦
- [ ] è½¬æ¢ç‡å¼‚å¸¸é¢„è­¦
- [ ] è‡ªåŠ¨æé†’é€šçŸ¥

**é¢„è®¡å·¥ä½œé‡**: 1å¤©

---

## æœªæ¥è§„åˆ’ (Phase 4+ ğŸ“…)

### 5.1 å…»æ®–æ¨¡å— (Farming)
**åŠŸèƒ½**: å…»æ®–è®¡åˆ’ã€é¥²æ–™ç®¡ç†ã€ç–¾ç—…ç›‘æ§ã€å‡ºæ ç®¡ç†
**å·¥ä½œé‡**: 3-4å‘¨
**ä¼˜å…ˆçº§**: Phase 4 (2025å¹´Q2)

### 5.2 ç‰©æµæ¨¡å— (Logistics)
**åŠŸèƒ½**: è®¢å•ç®¡ç†ã€é…é€è·Ÿè¸ªã€è¿è´¹ç»Ÿè®¡
**å·¥ä½œé‡**: 2-3å‘¨
**ä¼˜å…ˆçº§**: Phase 4 (2025å¹´Q3)

### 5.3 æº¯æºæ¨¡å— (Trace)
**åŠŸèƒ½**: äºŒç»´ç æ‰«æã€äº§å“è¿½æº¯ã€æºå¤´è¿½æº¯
**å·¥ä½œé‡**: 2å‘¨
**ä¼˜å…ˆçº§**: Phase 4 (2025å¹´Q2)

### 5.4 é”€å”®æ¨¡å— (Sales)
**åŠŸèƒ½**: é”€å”®è®¢å•ã€ä»·æ ¼ç®¡ç†ã€æ”¶ç›Šåˆ†æ
**å·¥ä½œé‡**: 2-3å‘¨
**ä¼˜å…ˆçº§**: Phase 4 (2025å¹´Q3)

### 5.5 Webç®¡ç†åå°
**åŠŸèƒ½**: å¹³å°çº§æ•°æ®ç®¡ç†ã€æŠ¥è¡¨ã€ç³»ç»Ÿé…ç½®
**å·¥ä½œé‡**: 4-6å‘¨
**ä¼˜å…ˆçº§**: Phase 5 (2025å¹´ä¸‹åŠå¹´)

---

## æ•°æ®æ¨¡å‹

### 6.1 æ ¸å¿ƒæ•°æ®è¡¨

**ProcessingBatch** (ç”Ÿäº§æ‰¹æ¬¡)
```
id, batchNumber, factoryId, productType, fishType
rawQuantity, targetQuantity, actualQuantity
status (planning/in_progress/quality_check/completed/failed)
startDate, endDate, totalCost, costPerKg
```

**RawMaterialReceipt** (åŸææ–™å…¥åº“)
```
id, batchNumber, factoryId, supplierId, materialTypeId
quantity, unitPrice, totalAmount
storageType (fresh/frozen), storageLocation
shelfLife, expiryDate
qualityStatus, qualityScore, qualityPhotos
```

**EmployeeClockRecord** (æ‰“å¡è®°å½•)
```
id, employeeId, factoryId
clockType (clock_in/clock_out)
clockTime, gpsLocation, distance
workType, productionLine
```

**CostAnalysis** (æˆæœ¬åˆ†æ)
```
id, batchId
rawMaterialCost, laborCost, equipmentCost
otherCost, totalCost, costPerKg
estimatedCost, deviation, deviationPercent
```

**AIAnalysisResult** (AIåˆ†æç»“æœ)
```
id, batchId, analysisType
model, analysisText
recommendations (JSON Array)
confidence, apiCost, tokens, fromCache
```

è¯¦è§ [å®Œæ•´ä¸šåŠ¡æµç¨‹ä¸ç•Œé¢è®¾è®¡](./PRD-å®Œæ•´ä¸šåŠ¡æµç¨‹ä¸ç•Œé¢è®¾è®¡.md)

---

## APIè®¾è®¡

### 7.1 APIè§„èŒƒ

**Base URL**:
- å¼€å‘: `http://localhost:3001/api`
- ç”Ÿäº§: `https://api.cretas.com/api`

**æ ‡å‡†å“åº”ç»“æ„**:
```json
{
  "success": true,
  "data": {...},
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2025-01-05T10:00:00Z"
}
```

### 7.2 æ ¸å¿ƒAPIæ¸…å•

è¯¦è§ [åç«¯éœ€æ±‚æ¸…å•](../../backend/rn-update-tableandlogic.md)

---

## éåŠŸèƒ½éœ€æ±‚

### 8.1 æ€§èƒ½è¦æ±‚

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|-----|-------|
| Appå¯åŠ¨æ—¶é—´ | <3ç§’ |
| APIå“åº”æ—¶é—´ | <500ms (P95) |
| é¡µé¢åˆ‡æ¢ | <300ms |
| å¹¶å‘ç”¨æˆ· | 100+ |
| å†…å­˜å ç”¨ | <200MB |

### 8.2 å®‰å…¨è¦æ±‚

- å¯†ç åŠ å¯†: bcrypt 12è½®
- Tokenè¿‡æœŸ: 24å°æ—¶
- ç”Ÿç‰©è¯†åˆ«æ”¯æŒ
- GPSä½ç½®éªŒè¯
- HTTPSå¼ºåˆ¶

### 8.3 å…¼å®¹æ€§è¦æ±‚

| å¹³å° | ç‰ˆæœ¬ |
|-----|------|
| iOS | 13.0+ |
| Android | 8.0+ |
| Node.js | 18.0+ |
| MySQL | 8.0+ |

---

## ç›¸å…³æ–‡æ¡£

- ğŸ“‹ [å®ç°çŠ¶æ€æ€»è§ˆ](./PRD-å®ç°çŠ¶æ€æ€»è§ˆ.md) - é¡µé¢å®ç°æƒ…å†µ
- ğŸ› ï¸ [Phase 3 å®Œå–„è®¡åˆ’](./PRD-Phase3-å®Œå–„è®¡åˆ’.md) - è¯¦ç»†å¼€å‘ä»»åŠ¡
- ğŸ“š [å®Œæ•´ä¸šåŠ¡æµç¨‹è®¾è®¡](./PRD-å®Œæ•´ä¸šåŠ¡æµç¨‹ä¸ç•Œé¢è®¾è®¡.md) - äº¤äº’è®¾è®¡
- ğŸ”§ [åç«¯éœ€æ±‚æ¸…å•](../../backend/rn-update-tableandlogic.md) - APIä¸æ•°æ®åº“

---

**æ–‡æ¡£ç»“æŸ**

*ç™½å©çºªé£Ÿå“æº¯æºç³»ç»ŸPRD v4.0é‡‡ç”¨åˆ†é˜¶æ®µç‰ˆæœ¬ç®¡ç†ï¼Œæ¸…æ™°æ ‡æ³¨æ¯ä¸ªåŠŸèƒ½çš„å®ç°çŠ¶æ€ã€‚æ‰€æœ‰å†…å®¹ä¼˜å…ˆçº§æ˜ç¡®ï¼Œä¾¿äºå›¢é˜Ÿæœ‰åºæ¨è¿›å¼€å‘ã€‚*

*æœ€åæ›´æ–°: 2025-10-26*

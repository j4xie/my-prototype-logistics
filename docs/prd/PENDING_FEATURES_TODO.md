# 白垩纪食品溯源系统 - 待实现功能清单

> **版本**: v1.0
> **生成日期**: 2025-11-21
> **范围**: Phase 3-5 规划功能
> **总体进度**: 82-85% 完成

---

## 📋 目录

1. [Phase 3 待完成（2-3周）](#phase-3-待完成2-3周)
2. [Phase 4 规划功能（2025 Q2-Q3）](#phase-4-规划功能2025-q2-q3)
3. [Phase 5 高级功能（2025下半年）](#phase-5-高级功能2025下半年)
4. [优先级说明](#优先级说明)

---

## Phase 3 待完成（2-3周）

### 🔴 P0级 - 紧急（2小时）

#### 1. 设备监控集成到导航
- **状态**: 🔨 文件已存在，需集成
- **文件**: `EquipmentMonitoringScreen.tsx`
- **工作量**: 2小时
- **优先级**: P0
- **任务描述**:
  - 将EquipmentMonitoringScreen从 `src/screens/future/` 移至 `src/screens/processing/`
  - 更新导航栈，添加到ProcessingNavigator
  - 集成到EquipmentManagementScreen的快捷入口

---

### 🟠 P1级 - 核心功能（3-4天）

#### 1. AI智能分析详情页完善
- **状态**: 🔨 页面存在，功能不完整
- **文件**: `DeepSeekAnalysisScreen.tsx`
- **工作量**: 1.5天
- **优先级**: P1
- **后端依赖**: ✅ 已完成
- **任务描述**:
  - [ ] 完善AI分析结果展示
    - [ ] 5维深度分析的具体内容展示
    - [ ] 优化建议列表（3-5条，按优先级排序）
    - [ ] 成本节省估算（金额 + 百分比）
  - [ ] 添加交互功能
    - [ ] 采纳建议按钮
    - [ ] 导出报告功能
    - [ ] 分享报告功能
  - [ ] 优化UI/UX
    - [ ] 增强视觉层次
    - [ ] 添加加载动画
    - [ ] 错误提示完善
- **验收标准**:
  - [ ] 能展示完整的AI分析结果
  - [ ] 用户可以点击导出报告
  - [ ] 支持分享报告链接

#### 2. 质检完整流程
- **状态**: 🔨 列表页完成，创建/详情页待完成
- **文件**:
  - `CreateQualityRecordScreen.tsx` (待完成)
  - `QualityInspectionDetailScreen.tsx` (待创建)
- **工作量**: 1.5天
- **优先级**: P1
- **后端API**:
  - ✅ GET /api/mobile/{factoryId}/quality-inspections (已实现)
  - 🔨 POST /api/mobile/{factoryId}/quality-inspections (待完成)
  - 🔨 GET /api/mobile/{factoryId}/quality-inspections/{id} (待完成)
- **任务描述**:
  - **CreateQualityRecordScreen**:
    - [ ] 表单设计（15字段）
      - [ ] 批次号（只读，自动填充）
      - [ ] 质检员选择
      - [ ] 质检日期/时间（自动填充当前）
      - [ ] 新鲜度评分 (1-5星)
      - [ ] 外观评分 (1-5星)
      - [ ] 气味评分 (1-5星)
      - [ ] 其他评分 (自定义)
      - [ ] 综合评分 (自动计算平均值)
      - [ ] 质检结论 (合格/条件合格/不合格)
      - [ ] 不合格原因 (条件显示)
      - [ ] 是否返工？(条件显示)
      - [ ] 处理方式 (全额报废/部分使用/降级使用)
      - [ ] 备注文本框
      - [ ] 质检照片上传 (多张)
    - [ ] 表单验证逻辑
    - [ ] 提交API集成
    - [ ] 错误处理
  - **QualityInspectionDetailScreen**:
    - [ ] 只读展示质检记录
    - [ ] 显示所有照片
    - [ ] 支持修改（仅draft状态）
    - [ ] 支持删除（仅draft状态）
    - [ ] 显示历史版本
- **验收标准**:
  - [ ] 能创建完整质检记录
  - [ ] 字段验证正确
  - [ ] 能查看质检详情
  - [ ] 草稿可编辑，已提交不可编辑

#### 3. 成本对比分析页面
- **状态**: 🔨 文件存在，功能待完善
- **文件**: `CostComparisonScreen.tsx`
- **工作量**: 1天
- **优先级**: P1
- **后端API**: 📅 待实现
- **任务描述**:
  - [ ] 日期范围筛选
  - [ ] 批次选择（多选）
  - [ ] 对比表格
    - [ ] 批次号
    - [ ] 生产日期
    - [ ] 总成本
    - [ ] 单位成本
    - [ ] 目标成本
    - [ ] 偏差 %
  - [ ] 趋势图表
    - [ ] 成本折线图（时间序列）
    - [ ] 偏差柱状图
  - [ ] 统计数据
    - [ ] 平均成本
    - [ ] 最高/最低成本
    - [ ] 趋势分析
- **验收标准**:
  - [ ] 能对比2个以上批次
  - [ ] 显示趋势图表
  - [ ] 支持时间范围筛选

#### 4. 设备告警系统
- **状态**: 🔨 EquipmentAlertsScreen存在，逻辑待完成
- **文件**: `EquipmentAlertsScreen.tsx`
- **工作量**: 1.5天
- **优先级**: P1
- **后端API**:
  - ✅ GET /api/mobile/{factoryId}/equipment-alerts (已实现)
  - 🔨 POST /api/mobile/{factoryId}/equipment/alerts/{alertId}/acknowledge (待完成)
  - 🔨 POST /api/mobile/{factoryId}/equipment/alerts/{alertId}/resolve (待完成)
  - 📅 POST /api/mobile/{factoryId}/equipment/alerts/{alertId}/ignore (规划中)
- **任务描述**:
  - [ ] 告警列表展示
    - [ ] 按级别筛选（Critical/High/Medium/Low）
    - [ ] 按状态筛选（Active/Acknowledged/Resolved）
    - [ ] 按设备筛选
  - [ ] 告警操作
    - [ ] 确认告警（ACTIVE → ACKNOWLEDGED）
    - [ ] 开始处理（ACKNOWLEDGED → IN_PROGRESS）
    - [ ] 解决告警（IN_PROGRESS → RESOLVED）
    - [ ] 添加处理备注和解决方案
  - [ ] 告警统计
    - [ ] 按级别统计数量
    - [ ] 按设备统计
    - [ ] 时间段筛选（今日/本周/本月）
  - [ ] 告警详情
    - [ ] 显示完整告警信息
    - [ ] 显示处理历史
- **验收标准**:
  - [ ] 能确认和解决告警
  - [ ] 告警生命周期正确流转
  - [ ] 支持多维度统计

#### 5. 库存FIFO推荐API实现
- **状态**: 📅 规划中（后端）
- **优先级**: P1
- **工作量**: 1天（后端）
- **API端点**:
  ```
  GET /api/mobile/{factoryId}/material-batches/fifo-recommendation
  参数：
    - materialTypeId: 材料类型ID
    - quantity: 需要的数量

  响应：
  {
    "recommended": [
      {
        "batchId": "BATCH_001",
        "batchNumber": "RAW_20251101_001",
        "quantity": 2000,
        "expiryDate": "2025-10-08",
        "priority": 1,
        "reason": "最早到期，FIFO优先级最高"
      }
    ],
    "totalRecommended": 2000,
    "remaining": 0
  }
  ```
- **任务描述**:
  - [ ] 实现FIFO算法
    - [ ] 按入库时间排序
    - [ ] 检查到期日期
    - [ ] 推荐最优组合
  - [ ] 库存预警集成
    - [ ] 标记临期批次
    - [ ] 提示低库存

---

### 🟡 P2级 - 辅助功能（5-7天）

#### 1. 两阶段用户注册
- **状态**: 🔨 部分完成
- **文件**: `RegisterScreen.tsx`
- **工作量**: 1.5天
- **优先级**: P2
- **后端API**: 🔨 待完成
- **任务描述**:
  - **阶段1 - 手机验证**:
    - [ ] 输入手机号
    - [ ] 发送验证码（6位）
    - [ ] 倒计时显示（60秒）
    - [ ] 验证码输入框
    - [ ] 验证通过后获得TempToken
  - **阶段2 - 完善信息**:
    - [ ] 姓名输入
    - [ ] 密码设置（至少8位，包含大小写和数字）
    - [ ] 密码确认
    - [ ] 工号输入（可选）
    - [ ] 部门选择
    - [ ] 同意条款勾选
    - [ ] 注册完成

#### 2. 数据报表导出
- **状态**: 🔨 准备实现
- **工作量**: 2天
- **优先级**: P2
- **支持格式**: Excel, CSV, PDF
- **任务描述**:
  - **导出功能**:
    - [ ] 用户列表导出
    - [ ] 工时统计导出
    - [ ] 成本报表导出
    - [ ] 生产报表导出
  - **导出流程**:
    - [ ] 点击导出按钮
    - [ ] 选择格式 (Excel/CSV/PDF)
    - [ ] 后台生成文件
    - [ ] 下载或分享链接

#### 3. 打卡历史查询
- **状态**: 📅 规划中
- **文件**: `AttendanceHistoryScreen.tsx`
- **工作量**: 1天
- **优先级**: P2
- **任务描述**:
  - [ ] 日期范围筛选
  - [ ] 打卡记录列表
    - [ ] 显示上班/下班时间
    - [ ] 显示GPS位置
    - [ ] 显示打卡照片
    - [ ] 显示工作时长
  - [ ] 异常标记
    - [ ] 迟到/早退
    - [ ] GPS超出范围
    - [ ] 缺勤
  - [ ] 导出功能

#### 4. 工厂设置页面
- **状态**: 🔨 文件存在，功能不完整
- **文件**: `FactorySettingsScreen.tsx`
- **工作量**: 1.5天
- **优先级**: P2
- **任务描述**:
  - [ ] 基本信息
    - [ ] 工厂名称
    - [ ] 工厂地址
    - [ ] GPS坐标
    - [ ] 打卡范围（米）
    - [ ] 联系电话
  - [ ] 工作时间配置
    - [ ] 上班时间（默认08:00）
    - [ ] 下班时间（默认17:30）
    - [ ] 午休时间（默认1小时）
    - [ ] 加班规则
  - [ ] 打卡设置
    - [ ] 是否要求拍照
    - [ ] 是否启用生物识别
    - [ ] GPS误差容忍度
  - [ ] 保存和验证

---

## Phase 4 规划功能（2025 Q2-Q3）

### 养殖模块（Farming）
- [ ] 养殖计划管理
- [ ] 饲料管理和库存
- [ ] 疾病监控和预警
- [ ] 出栏管理
- [ ] 养殖成本核算
- [ ] 养殖数据分析

### 物流模块（Logistics）
- [ ] 订单管理
- [ ] 配送跟踪（GPS实时）
- [ ] 司机管理
- [ ] 运费统计
- [ ] 配送路线优化
- [ ] 配送数据分析

### 溯源模块（Trace）
- [ ] 二维码生成
- [ ] 二维码扫描
- [ ] 产品追溯（养殖→加工→物流→销售）
- [ ] 源头追溯（产品反查原料）
- [ ] 溯源链可视化展示
- [ ] 区块链集成（可选）

### 销售模块（Sales）
- [ ] 销售订单管理
- [ ] 价格管理（动态定价）
- [ ] 客户订单查询
- [ ] 收益分析
- [ ] 销售报表

---

## Phase 5 高级功能（2025下半年）

### Web管理后台
- [ ] 大屏数据可视化仪表盘
- [ ] 复杂报表生成系统
- [ ] 平台级配置管理
- [ ] 系统日志和审计
- [ ] 用户权限细粒度控制
- [ ] 平台运营数据分析

### 高级AI功能
- [ ] 需求预测（ML预测未来订单量）
- [ ] 库存优化（智能补货建议）
- [ ] 价格优化（动态定价建议）
- [ ] 异常检测（成本、质量异常预警）
- [ ] 效率优化（工艺参数优化）
- [ ] 供应链优化（供应商选择建议）

### 产业互联网平台
- [ ] 跨企业数据打通
- [ ] 设备对标库（真实故障率/效率数据）
- [ ] 供应商评估库
- [ ] 行业基准库
- [ ] 知识库和最佳实践
- [ ] 社区和协作平台

---

## 优先级说明

### P0 - 紧急（2小时-1天）
- **特点**: 功能已完成，仅需集成或小改进
- **实施**: 立即处理，不影响整体进度
- **示例**: 设备监控集成、导航调整

### P1 - 核心功能（3-4天）
- **特点**: 影响核心用户体验，UI已基本完成
- **实施**: 本周内完成，优先级高
- **示例**: AI分析完善、质检流程、告警系统

### P2 - 辅助功能（5-7天）
- **特点**: 增强体验但不影响核心功能
- **实施**: 本月内完成，可并行处理
- **示例**: 数据导出、注册完善、历史查询

### 📅 规划中
- **特点**: Phase 4-5的功能，需要新设计和架构
- **实施**: 后续阶段处理
- **预计**: 2025 Q2-下半年

---

## 依赖关系

```
Phase 3 完成
  ├─ AI分析详情 ✓
  ├─ 质检流程 ✓
  ├─ 设备告警 ✓
  └─ 库存FIFO → Phase 4物流模块依赖

Phase 4 开始
  ├─ 养殖模块
  ├─ 物流模块 ← 库存FIFO
  ├─ 溯源模块
  └─ 销售模块

Phase 5 开始
  ├─ Web后台 ← 所有数据就绪
  ├─ AI高级功能 ← 数据积累
  └─ 产业互联网 ← 生态完善
```

---

## 进度跟踪

### 完成度统计

| 阶段 | 任务数 | 完成 | 进行中 | 待做 | 完成度 |
|------|--------|------|--------|------|--------|
| Phase 3 P0 | 1 | 0 | 0 | 1 | 0% |
| Phase 3 P1 | 5 | 0 | 0 | 5 | 0% |
| Phase 3 P2 | 4 | 0 | 0 | 4 | 0% |
| **Phase 3总计** | **10** | **0** | **0** | **10** | **0%** |
| Phase 4 | - | - | - | - | 规划中 |
| Phase 5 | - | - | - | - | 规划中 |

### 预计完成时间

- **Phase 3**: 2-3周（从2025-11-21开始）
- **Phase 4**: 2025 Q2-Q3（2个月）
- **Phase 5**: 2025下半年（3个月）
- **总计**: 2025年年底前完成

---

**文档维护**:
- **版本**: v1.0
- **最后更新**: 2025-11-21
- **更新频率**: 周度更新
- **所有者**: 产品 + 技术

**相关文档**:
- [功能与文件映射-v3.0](./PRD-功能与文件映射-v3.0.md)
- [完整业务流程-v5.0](./PRD-完整业务流程与界面设计-v5.0.md)

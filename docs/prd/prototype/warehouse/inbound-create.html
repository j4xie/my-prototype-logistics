<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å…¥åº“ç¡®è®¤ - ç™½å©çºªé£Ÿå“æº¯æºç³»ç»Ÿ</title>
  <link rel="stylesheet" href="warehouse.css">
  <link rel="stylesheet" href="../components.css">
</head>
<body>
  <a href="inbound.html" class="back-to-index">< è¿”å›å…¥åº“åˆ—è¡¨</a>

  <div class="mobile-container">
    <header class="header">
      <h1>å…¥åº“ç¡®è®¤</h1>
      <p>æ‹ç…§ä¸Šä¼  Â· AIè¯†åˆ« Â· ç¡®è®¤å…¥åº“</p>
    </header>

    <div class="page-content">
      <!-- è°ƒåº¦è®¡åˆ’ä¿¡æ¯ -->
      <div class="dispatch-plan-info">
        <div class="dispatch-plan-header">
          <span class="dispatch-plan-icon">ğŸ“‹</span>
          <span class="dispatch-plan-title">è°ƒåº¦è®¡åˆ’ #RK-20251227-001</span>
        </div>
        <div class="dispatch-plan-content">
          <div class="dispatch-plan-row">
            <span class="dispatch-plan-label">ä¾›åº”å•†</span>
            <span class="dispatch-plan-value">èˆŸå±±æ¸”ä¸šåˆä½œç¤¾</span>
          </div>
          <div class="dispatch-plan-row">
            <span class="dispatch-plan-label">é¢„è®¡å“ç±»</span>
            <span class="dispatch-plan-value">å¸¦é±¼</span>
          </div>
          <div class="dispatch-plan-row">
            <span class="dispatch-plan-label">é¢„è®¡æ•°é‡</span>
            <span class="dispatch-plan-value">305 kg</span>
          </div>
          <div class="dispatch-plan-row">
            <span class="dispatch-plan-label">é¢„è®¡åˆ°è´§</span>
            <span class="dispatch-plan-value highlight">ä»Šæ—¥ 10:30</span>
          </div>
        </div>
      </div>

      <!-- Step 1: æ‹æ‘„é€è´§å•æ® -->
      <div class="form-section">
        <div class="form-section-title">
          <span class="step-number">1</span>
          æ‹æ‘„é€è´§å•æ®
        </div>

        <div class="photo-upload-section">
          <div class="photo-capture-area" id="delivery-note-capture" onclick="capturePhoto('delivery-note')">
            <div class="photo-placeholder" id="delivery-note-placeholder">
              <span class="camera-icon">ğŸ“·</span>
              <span class="capture-text">ç‚¹å‡»æ‹æ‘„é€è´§å•</span>
              <span class="capture-hint">è¯·æ‹æ‘„æ¸…æ™°çš„é€è´§å•æ®</span>
            </div>
            <div class="photo-preview hidden" id="delivery-note-preview">
              <div class="preview-image-container">
                <img src="" alt="é€è´§å•é¢„è§ˆ" id="delivery-note-img">
              </div>
              <button class="retake-btn" onclick="retakePhoto('delivery-note', event)">é‡æ‹</button>
            </div>
          </div>

          <!-- AI è¯†åˆ«çŠ¶æ€ -->
          <div class="ai-processing hidden" id="delivery-note-processing">
            <span class="ai-spinner"></span>
            <span>ğŸ¤– AI æ­£åœ¨è¯†åˆ«é€è´§å•...</span>
          </div>

          <!-- é€è´§å•è¯†åˆ«ç»“æœ -->
          <div class="ai-recognition-result hidden" id="delivery-note-result">
            <div class="recognition-header">
              <span class="recognition-icon">ğŸ“„</span>
              <span class="recognition-title">é€è´§å•è¯†åˆ«ç»“æœ</span>
              <span class="recognition-status success">è¯†åˆ«æˆåŠŸ</span>
            </div>
            <div class="recognition-content">
              <div class="recognition-item">
                <span class="recognition-label">ä¾›åº”å•†</span>
                <span class="recognition-value">èˆŸå±±æ¸”ä¸šåˆä½œç¤¾</span>
                <span class="match-status success">âœ“ åŒ¹é…</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">è´§å“åç§°</span>
                <span class="recognition-value">å¸¦é±¼</span>
                <span class="match-status success">âœ“ åŒ¹é…</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">æ•°é‡</span>
                <span class="recognition-value">300 kg</span>
                <span class="match-status warning">âš  å·®å¼‚ -5kg</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">é€è´§å•å·</span>
                <span class="recognition-value">SD-20251227-001</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2: æ‹æ‘„è´§å“æ ‡ç­¾ -->
      <div class="form-section">
        <div class="form-section-title">
          <span class="step-number">2</span>
          æ‹æ‘„è´§å“æ ‡ç­¾
        </div>

        <div class="photo-upload-section">
          <div class="photo-capture-area" id="product-label-capture" onclick="capturePhoto('product-label')">
            <div class="photo-placeholder" id="product-label-placeholder">
              <span class="camera-icon">ğŸ“·</span>
              <span class="capture-text">ç‚¹å‡»æ‹æ‘„è´§å“æ ‡ç­¾</span>
              <span class="capture-hint">è¯·æ‹æ‘„åŒ…è£…ä¸Šçš„äº§å“æ ‡ç­¾</span>
            </div>
            <div class="photo-preview hidden" id="product-label-preview">
              <div class="preview-image-container">
                <img src="" alt="è´§å“æ ‡ç­¾é¢„è§ˆ" id="product-label-img">
              </div>
              <button class="retake-btn" onclick="retakePhoto('product-label', event)">é‡æ‹</button>
            </div>
          </div>

          <!-- AI è¯†åˆ«çŠ¶æ€ -->
          <div class="ai-processing hidden" id="product-label-processing">
            <span class="ai-spinner"></span>
            <span>ğŸ¤– AI æ­£åœ¨è¯†åˆ«è´§å“æ ‡ç­¾...</span>
          </div>

          <!-- è´§å“æ ‡ç­¾è¯†åˆ«ç»“æœ -->
          <div class="ai-recognition-result hidden" id="product-label-result">
            <div class="recognition-header">
              <span class="recognition-icon">ğŸ·ï¸</span>
              <span class="recognition-title">è´§å“æ ‡ç­¾è¯†åˆ«ç»“æœ</span>
              <span class="recognition-status success">è¯†åˆ«æˆåŠŸ</span>
            </div>
            <div class="recognition-content">
              <div class="recognition-item">
                <span class="recognition-label">å“å</span>
                <span class="recognition-value">ä¸œæµ·å¸¦é±¼</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">äº§åœ°</span>
                <span class="recognition-value">æµ™æ±ŸèˆŸå±±</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">ç”Ÿäº§æ—¥æœŸ</span>
                <span class="recognition-value">2025-12-27</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">ä¿è´¨æœŸ</span>
                <span class="recognition-value">7å¤©</span>
              </div>
              <div class="recognition-item">
                <span class="recognition-label">å‚¨å­˜æ¡ä»¶</span>
                <span class="recognition-value">0-4Â°C å†·è—</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: AI ç»¼åˆåˆ†æ -->
      <div class="form-section hidden" id="ai-analysis-section">
        <div class="form-section-title">
          <span class="step-number">3</span>
          AI ç»¼åˆåˆ†æ
        </div>

        <div class="ai-recognition-card">
          <div class="ai-card-header">
            <span class="ai-card-icon">ğŸ¤–</span>
            <span class="ai-card-title">ä¸è°ƒåº¦è®¡åˆ’å¯¹æ¯”</span>
          </div>
          <div class="ai-card-content">
            <div class="comparison-item success">
              <span class="comparison-icon">âœ“</span>
              <span class="comparison-text">ä¾›åº”å•†åŒ¹é…ï¼šèˆŸå±±æ¸”ä¸šåˆä½œç¤¾</span>
            </div>
            <div class="comparison-item success">
              <span class="comparison-icon">âœ“</span>
              <span class="comparison-text">è´§å“åŒ¹é…ï¼šå¸¦é±¼</span>
            </div>
            <div class="comparison-item warning">
              <span class="comparison-icon">âš </span>
              <span class="comparison-text">æ•°é‡å·®å¼‚ï¼šå®æ”¶ 300kgï¼Œè®¡åˆ’ 305kgï¼ˆå·® -5kgï¼‰</span>
            </div>
            <div class="comparison-item success">
              <span class="comparison-icon">âœ“</span>
              <span class="comparison-text">äº§å“æ–°é²œï¼šç”Ÿäº§æ—¥æœŸä¸ºä»Šæ—¥</span>
            </div>
          </div>
          <div class="ai-card-suggestion">
            <div class="suggestion-label">ğŸ¤– AI å»ºè®®</div>
            <div class="suggestion-text">
              æ•°é‡å·®å¼‚åœ¨å¯æ¥å—èŒƒå›´å†…ï¼ˆ-1.6%ï¼‰ï¼Œå»ºè®®æ­£å¸¸å…¥åº“ã€‚å·®å¼‚å·²è®°å½•ï¼Œå¯è”ç³»ä¾›åº”å•†æ ¸å®ã€‚
            </div>
          </div>
        </div>
      </div>

      <!-- å…¥åº“ç¡®è®¤ä¿¡æ¯ -->
      <div class="form-section hidden" id="confirm-section">
        <div class="form-section-title">ç¡®è®¤å…¥åº“ä¿¡æ¯</div>

        <div class="confirm-summary">
          <div class="confirm-row">
            <span class="confirm-label">å…¥åº“æ—¶é—´</span>
            <span class="confirm-value">2025-12-27 10:35</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">å…¥åº“è´Ÿè´£äºº</span>
            <span class="confirm-value">å¼ ä»“ç®¡</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">ä¾›åº”å•†</span>
            <span class="confirm-value">èˆŸå±±æ¸”ä¸šåˆä½œç¤¾</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">è´§å“</span>
            <span class="confirm-value">å¸¦é±¼ (é²œå“)</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">å®æ”¶æ•°é‡</span>
            <span class="confirm-value highlight">300 kg</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">ç”Ÿäº§æ—¥æœŸ</span>
            <span class="confirm-value">2025-12-27</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">ä¿è´¨æœŸè‡³</span>
            <span class="confirm-value">2026-01-03</span>
          </div>
          <div class="confirm-row">
            <span class="confirm-label">å»ºè®®åº“ä½</span>
            <span class="confirm-value">AåŒº-å†·è—åº“-01</span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰</label>
          <textarea class="form-textarea" rows="2" placeholder="å¦‚æœ‰ç‰¹æ®Šæƒ…å†µè¯·å¤‡æ³¨"></textarea>
        </div>
      </div>

      <!-- æ“ä½œæŒ‰é’® -->
      <div class="form-actions">
        <a href="inbound.html" class="action-btn secondary">å–æ¶ˆ</a>
        <button type="button" class="action-btn primary" id="confirm-btn" disabled onclick="confirmInbound()">
          ç¡®è®¤å…¥åº“
        </button>
      </div>
    </div>
  </div>

  <script>
    // æ¨¡æ‹Ÿæ‹ç…§æµç¨‹
    function capturePhoto(type) {
      const placeholder = document.getElementById(`${type}-placeholder`);
      const preview = document.getElementById(`${type}-preview`);
      const processing = document.getElementById(`${type}-processing`);
      const result = document.getElementById(`${type}-result`);

      // éšè—å ä½ç¬¦ï¼Œæ˜¾ç¤ºå¤„ç†ä¸­
      placeholder.classList.add('hidden');
      processing.classList.remove('hidden');

      // æ¨¡æ‹ŸAIè¯†åˆ«å»¶è¿Ÿ
      setTimeout(() => {
        processing.classList.add('hidden');
        preview.classList.remove('hidden');

        // æ˜¾ç¤ºè¯†åˆ«ç»“æœ
        setTimeout(() => {
          result.classList.remove('hidden');
          checkAllPhotos();
        }, 500);
      }, 1500);
    }

    function retakePhoto(type, event) {
      event.stopPropagation();
      const placeholder = document.getElementById(`${type}-placeholder`);
      const preview = document.getElementById(`${type}-preview`);
      const result = document.getElementById(`${type}-result`);

      preview.classList.add('hidden');
      result.classList.add('hidden');
      placeholder.classList.remove('hidden');
      checkAllPhotos();
    }

    function checkAllPhotos() {
      const deliveryResult = document.getElementById('delivery-note-result');
      const productResult = document.getElementById('product-label-result');
      const analysisSection = document.getElementById('ai-analysis-section');
      const confirmSection = document.getElementById('confirm-section');
      const confirmBtn = document.getElementById('confirm-btn');

      // ä¸¤å¼ ç…§ç‰‡éƒ½è¯†åˆ«å®Œæˆåï¼Œæ˜¾ç¤ºç»¼åˆåˆ†æå’Œç¡®è®¤åŒºåŸŸ
      if (!deliveryResult.classList.contains('hidden') && !productResult.classList.contains('hidden')) {
        analysisSection.classList.remove('hidden');
        confirmSection.classList.remove('hidden');
        confirmBtn.disabled = false;
      } else {
        analysisSection.classList.add('hidden');
        confirmSection.classList.add('hidden');
        confirmBtn.disabled = true;
      }
    }

    function confirmInbound() {
      if (confirm('ç¡®è®¤å…¥åº“ï¼Ÿ\n\nè´§å“ï¼šå¸¦é±¼ 300kg\nä¾›åº”å•†ï¼šèˆŸå±±æ¸”ä¸šåˆä½œç¤¾')) {
        alert('âœ… å…¥åº“æˆåŠŸï¼\n\næ‰¹æ¬¡å·ï¼šMB-20251227-001\nå·²è‡ªåŠ¨è®°å½•å…¥åº“æ—¶é—´å’Œè´Ÿè´£äºº');
        location.href = 'inbound.html';
      }
    }
  </script>
</body>
</html>

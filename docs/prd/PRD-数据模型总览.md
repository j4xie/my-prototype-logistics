# PRD-æ•°æ®æ¨¡å‹æ€»è§ˆ

## æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| æ–‡æ¡£æ ‡é¢˜ | ç™½å©çºªé£Ÿå“æº¯æºç³»ç»Ÿ - æ•°æ®æ¨¡å‹æ€»è§ˆ |
| æ–‡æ¡£ç±»å‹ | æ•°æ®æ¶æ„è®¾è®¡æ–‡æ¡£ |
| æ–‡æ¡£ç‰ˆæœ¬ | v1.0.0 |
| åˆ›å»ºæ—¥æœŸ | 2025-11-20 |
| æœ€åæ›´æ–° | 2025-11-20 |
| ä½œè€… | Cretas Team |

---

## ç›®å½•

- [1. æ¦‚è¿°](#1-æ¦‚è¿°)
- [2. æ•°æ®æ¨¡å‹åˆ†ç±»](#2-æ•°æ®æ¨¡å‹åˆ†ç±»)
- [3. æ ¸å¿ƒå®ä½“æ€»è§ˆ](#3-æ ¸å¿ƒå®ä½“æ€»è§ˆ)
- [4. å®ä½“å…³ç³»å›¾ï¼ˆERå›¾ï¼‰](#4-å®ä½“å…³ç³»å›¾erå›¾)
- [5. æ•°æ®æ¨¡å‹ç»Ÿè®¡](#5-æ•°æ®æ¨¡å‹ç»Ÿè®¡)
- [6. æ–‡æ¡£å¯¼èˆª](#6-æ–‡æ¡£å¯¼èˆª)

---

## 1. æ¦‚è¿°

### 1.1 ç³»ç»Ÿæ•°æ®æ¶æ„

ç™½å©çºªé£Ÿå“æº¯æºç³»ç»Ÿé‡‡ç”¨**å…³ç³»å‹æ•°æ®åº“ï¼ˆMySQLï¼‰+ JPA/Hibernate ORM**æ¶æ„ï¼ŒåŒ…å«ï¼š

- **43ä¸ªå®ä½“ç±»ï¼ˆEntityï¼‰**ï¼šæ˜ å°„åˆ°æ•°æ®åº“è¡¨
- **60+ DTOç±»ï¼ˆData Transfer Objectï¼‰**ï¼šç”¨äºAPIæ•°æ®ä¼ è¾“
- **10+ä¸ªæ ¸å¿ƒä¸šåŠ¡åŸŸ**ï¼šå·¥å‚ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€ç”Ÿäº§åŠ å·¥ã€è´¨é‡ç®¡ç†ã€è®¾å¤‡ç®¡ç†ç­‰

### 1.2 æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**ï¼šMySQL 8.0+
- **ORMæ¡†æ¶**ï¼šSpring Data JPA + Hibernate
- **åŸºç¡€å®ä½“**ï¼šBaseEntityï¼ˆæä¾›é€šç”¨å­—æ®µï¼šid, createdAt, updatedAtï¼‰
- **å…³è”å…³ç³»**ï¼š@OneToMany, @ManyToOne, @ManyToMany
- **ç´¢å¼•ç­–ç•¥**ï¼šä¸»é”®ç´¢å¼•ã€å¤–é”®ç´¢å¼•ã€å¤åˆç´¢å¼•ã€å”¯ä¸€ç´¢å¼•

### 1.3 è®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå®ä½“ä¸“æ³¨ä¸€ä¸ªä¸šåŠ¡æ¦‚å¿µ
2. **è§„èŒƒåŒ–è®¾è®¡**ï¼šå‡å°‘æ•°æ®å†—ä½™ï¼Œé€šè¿‡å…³è”è¡¨ç»´æŠ¤å…³ç³»
3. **è½¯åˆ é™¤**ï¼šå…³é”®å®ä½“ä½¿ç”¨`isActive`å­—æ®µè€Œéç‰©ç†åˆ é™¤
4. **å®¡è®¡è¿½è¸ª**ï¼šæ‰€æœ‰å®ä½“ç»§æ‰¿BaseEntityï¼Œè®°å½•åˆ›å»ºå’Œæ›´æ–°æ—¶é—´
5. **å·¥å‚éš”ç¦»**ï¼šå¤§éƒ¨åˆ†å®ä½“åŒ…å«`factoryId`å­—æ®µï¼Œå®ç°å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»

---

## 2. æ•°æ®æ¨¡å‹åˆ†ç±»

### 2.1 æ ¸å¿ƒä¸šåŠ¡å®ä½“ï¼ˆ43ä¸ªEntityï¼‰

æŒ‰ä¸šåŠ¡åŸŸåˆ†ç±»ï¼š

#### A. å¹³å°ä¸å·¥å‚ç®¡ç†ï¼ˆ5ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 1 | **Factory** | `factories` | å·¥å‚ï¼ˆç§Ÿæˆ·ï¼‰ | â­â­â­â­â­ |
| 2 | **FactorySettings** | `factory_settings` | å·¥å‚é…ç½® | â­â­â­â­ |
| 3 | **PlatformAdmin** | `platform_admins` | å¹³å°ç®¡ç†å‘˜ | â­â­â­ |
| 4 | **DeviceActivation** | `device_activations` | è®¾å¤‡æ¿€æ´» | â­â­â­ |
| 5 | **Session** | `sessions` | ç”¨æˆ·ä¼šè¯ | â­â­â­ |

#### B. ç”¨æˆ·ä¸æƒé™ï¼ˆ4ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 6 | **User** | `users` | ç”¨æˆ·ï¼ˆ8è§’è‰²ç³»ç»Ÿï¼‰ | â­â­â­â­â­ |
| 7 | **Department** | `departments` | éƒ¨é—¨ | â­â­â­â­ |
| 8 | **WorkType** | `work_types` | å·¥ä½œç±»å‹ï¼ˆè®¡è´¹ï¼‰ | â­â­â­ |
| 9 | **Whitelist** | `whitelists` | ç™½åå•ï¼ˆæ‰‹æœºå·ï¼‰ | â­â­â­ |

#### C. äº§å“ä¸åŸæ–™ç±»å‹ï¼ˆ4ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 10 | **ProductType** | `product_types` | äº§å“ç±»å‹ | â­â­â­â­â­ |
| 11 | **RawMaterialType** | `raw_material_types` | åŸæ–™ç±»å‹ | â­â­â­â­â­ |
| 12 | **MaterialType** | `material_types` | ç‰©æ–™ç±»å‹ï¼ˆæ—§ï¼‰ | â­â­â­ |
| 13 | **MaterialProductConversion** | `material_product_conversions` | åŸæ–™äº§å“è½¬æ¢ç‡ | â­â­â­â­ |

#### D. ç”Ÿäº§æ‰¹æ¬¡ç®¡ç†ï¼ˆ6ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 14 | **ProcessingBatch** | `processing_batches` | åŠ å·¥æ‰¹æ¬¡ï¼ˆä¸»æµç¨‹ï¼‰ | â­â­â­â­â­ |
| 15 | **ProductionBatch** | `production_batches` | ç”Ÿäº§æ‰¹æ¬¡ï¼ˆæ—§ï¼‰ | â­â­â­ |
| 16 | **MaterialBatch** | `material_batches` | åŸæ–™æ‰¹æ¬¡ | â­â­â­â­â­ |
| 17 | **ProductionPlan** | `production_plans` | ç”Ÿäº§è®¡åˆ’ | â­â­â­â­ |
| 18 | **MaterialConsumption** | `material_consumptions` | ç‰©æ–™æ¶ˆè€—è®°å½• | â­â­â­â­ |
| 19 | **ProductionPlanBatchUsage** | `production_plan_batch_usages` | è®¡åˆ’æ‰¹æ¬¡ä½¿ç”¨ | â­â­â­ |

#### E. è´¨é‡ç®¡ç†ï¼ˆ4ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 20 | **QualityInspection** | `quality_inspections` | è´¨æ£€è®°å½• | â­â­â­â­â­ |
| 21 | **DisposalRecord** | `disposal_records` | åºŸå¼ƒå¤„ç†è®°å½• | â­â­â­ |
| 22 | **ReworkRecord** | `rework_records` | è¿”å·¥è®°å½• | â­â­â­ |
| 23 | **MaterialSpecConfig** | `material_spec_configs` | ç‰©æ–™è§„æ ¼é…ç½® | â­â­â­ |

#### F. è®¾å¤‡ç®¡ç†ï¼ˆ6ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 24 | **Equipment** | `equipment` | è®¾å¤‡åŸºæœ¬ä¿¡æ¯ | â­â­â­â­â­ |
| 25 | **FactoryEquipment** | `factory_equipment` | å·¥å‚è®¾å¤‡ï¼ˆæ—§ï¼‰ | â­â­ |
| 26 | **EquipmentMaintenance** | `equipment_maintenances` | è®¾å¤‡ç»´æŠ¤è®°å½• | â­â­â­ |
| 27 | **EquipmentUsage** | `equipment_usages` | è®¾å¤‡ä½¿ç”¨è®°å½• | â­â­â­ |
| 28 | **BatchEquipmentUsage** | `batch_equipment_usages` | æ‰¹æ¬¡è®¾å¤‡ä½¿ç”¨ | â­â­â­â­ |
| 29 | **EquipmentAlert** | `equipment_alerts` | è®¾å¤‡å‘Šè­¦ | â­â­â­â­ |

#### G. è€ƒå‹¤ä¸å·¥æ—¶ï¼ˆ3ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 30 | **TimeClockRecord** | `time_clock_records` | æ‰“å¡è®°å½• | â­â­â­â­ |
| 31 | **EmployeeWorkSession** | `employee_work_sessions` | å‘˜å·¥å·¥æ—¶ | â­â­â­ |
| 32 | **BatchWorkSession** | `batch_work_sessions` | æ‰¹æ¬¡å·¥æ—¶ | â­â­â­ |

#### H. ä¾›åº”é“¾ç®¡ç†ï¼ˆ4ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 33 | **Supplier** | `suppliers` | ä¾›åº”å•† | â­â­â­â­ |
| 34 | **Customer** | `customers` | å®¢æˆ· | â­â­â­â­ |
| 35 | **ShipmentRecord** | `shipment_records` | å‡ºè´§è®°å½• | â­â­â­ |
| 36 | **MaterialBatchAdjustment** | `material_batch_adjustments` | æ‰¹æ¬¡è°ƒæ•´è®°å½• | â­â­â­ |

#### I. AIä¸åˆ†æï¼ˆ5ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 37 | **AIUsageLog** | `ai_usage_logs` | AIè°ƒç”¨æ—¥å¿— | â­â­â­â­ |
| 38 | **AIQuotaUsage** | `ai_quota_usages` | AIé…é¢ä½¿ç”¨ | â­â­â­ |
| 39 | **AIAnalysisResult** | `ai_analysis_results` | AIåˆ†æç»“æœ | â­â­â­â­ |
| 40 | **AIAuditLog** | `ai_audit_logs` | AIå®¡è®¡æ—¥å¿— | â­â­â­ |
| 41 | **SystemLog** | `system_logs` | ç³»ç»Ÿæ—¥å¿— | â­â­â­ |

#### J. åé¦ˆä¸å…¶ä»–ï¼ˆ2ä¸ªï¼‰

| # | å®ä½“ç±» | è¡¨å | ä¸šåŠ¡å«ä¹‰ | æ ¸å¿ƒç¨‹åº¦ |
|---|--------|------|---------|---------|
| 42 | **UserFeedback** | `user_feedbacks` | ç”¨æˆ·åé¦ˆ | â­â­â­ |
| 43 | **BaseEntity** | - | åŸºç¡€å®ä½“ï¼ˆæŠ½è±¡ç±»ï¼‰ | â­â­â­â­â­ |

---

### 2.2 DTOç±»åˆ†ç±»ï¼ˆ60+ä¸ªï¼‰

#### A. è®¤è¯ç›¸å…³DTOï¼ˆ7ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 1 | LoginRequest | ç™»å½•è¯·æ±‚ |
| 2 | LoginResponse | ç™»å½•å“åº” |
| 3 | RegisterRequest | æ³¨å†Œè¯·æ±‚ |
| 4 | RegisterResponse | æ³¨å†Œå“åº” |
| 5 | PlatformLoginRequest | å¹³å°ç™»å½•è¯·æ±‚ |
| 6 | PlatformLoginResponse | å¹³å°ç™»å½•å“åº” |
| 7 | RefreshTokenRequest | åˆ·æ–°Tokenè¯·æ±‚ |

#### B. å¹³å°ç®¡ç†DTOï¼ˆ7ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 8 | FactoryDTO | å·¥å‚ä¿¡æ¯ |
| 9 | CreateFactoryRequest | åˆ›å»ºå·¥å‚ |
| 10 | UpdateFactoryRequest | æ›´æ–°å·¥å‚ |
| 11 | FactoryAIQuotaDTO | å·¥å‚AIé…é¢ |
| 12 | UpdateAIQuotaRequest | æ›´æ–°AIé…é¢ |
| 13 | PlatformAIUsageStatsDTO | å¹³å°AIç»Ÿè®¡ |
| 14 | PlatformStatisticsDTO | å¹³å°ç»Ÿè®¡ |

#### C. ç”¨æˆ·ç®¡ç†DTOï¼ˆ4ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 15 | UserDTO | ç”¨æˆ·ä¿¡æ¯ |
| 16 | CreateUserRequest | åˆ›å»ºç”¨æˆ· |
| 17 | UserExportDTO | ç”¨æˆ·å¯¼å‡º |
| 18 | DepartmentDTO | éƒ¨é—¨ä¿¡æ¯ |

#### D. åŸæ–™ä¸äº§å“DTOï¼ˆ10ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 19 | MaterialBatchDTO | åŸæ–™æ‰¹æ¬¡ |
| 20 | CreateMaterialBatchRequest | åˆ›å»ºåŸæ–™æ‰¹æ¬¡ |
| 21 | UseMaterialBatchRequest | ä½¿ç”¨åŸæ–™æ‰¹æ¬¡ |
| 22 | AdjustMaterialBatchRequest | è°ƒæ•´åŸæ–™æ‰¹æ¬¡ |
| 23 | UpdateBatchStatusRequest | æ›´æ–°æ‰¹æ¬¡çŠ¶æ€ |
| 24 | ConvertToFrozenRequest | è½¬ä¸ºå†·å†» |
| 25 | UndoFrozenRequest | è§£å†» |
| 26 | ReserveMaterialBatchRequest | é¢„ç•™æ‰¹æ¬¡ |
| 27 | ReleaseMaterialBatchRequest | é‡Šæ”¾æ‰¹æ¬¡ |
| 28 | ConsumeMaterialBatchRequest | æ¶ˆè€—æ‰¹æ¬¡ |

#### E. ç”Ÿäº§ç®¡ç†DTOï¼ˆ3ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 29 | ProductionPlanDTO | ç”Ÿäº§è®¡åˆ’ |
| 30 | CreateProductionPlanRequest | åˆ›å»ºç”Ÿäº§è®¡åˆ’ |
| 31 | ConversionDTO | è½¬æ¢ç‡ |

#### F. è®¾å¤‡ç®¡ç†DTOï¼ˆ4ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 32 | EquipmentDTO | è®¾å¤‡ä¿¡æ¯ |
| 33 | CreateEquipmentRequest | åˆ›å»ºè®¾å¤‡ |
| 34 | EquipmentExportDTO | è®¾å¤‡å¯¼å‡º |
| 35 | EquipmentUsage | è®¾å¤‡ä½¿ç”¨ |

#### G. ä¾›åº”é“¾DTOï¼ˆ7ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 36 | SupplierDTO | ä¾›åº”å•†ä¿¡æ¯ |
| 37 | CreateSupplierRequest | åˆ›å»ºä¾›åº”å•† |
| 38 | SupplierExportDTO | ä¾›åº”å•†å¯¼å‡º |
| 39 | CustomerDTO | å®¢æˆ·ä¿¡æ¯ |
| 40 | CreateCustomerRequest | åˆ›å»ºå®¢æˆ· |
| 41 | CustomerExportDTO | å®¢æˆ·å¯¼å‡º |
| 42 | ProductTypeDTO | äº§å“ç±»å‹ |

#### H. AIä¸åˆ†æDTOï¼ˆ5ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 43 | AIRequestDTO | AIè¯·æ±‚ |
| 44 | AIResponseDTO | AIå“åº” |
| 45 | FactoryAIUsageDTO | å·¥å‚AIä½¿ç”¨ |
| 46 | DashboardStatisticsDTO | Dashboardç»Ÿè®¡ |
| 47 | TimeStatsDTO | æ—¶é—´ç»Ÿè®¡ |

#### I. é€šç”¨DTOï¼ˆ8ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 48 | ApiResponse | é€šç”¨å“åº”å°è£… |
| 49 | PageRequest | åˆ†é¡µè¯·æ±‚ |
| 50 | PageResponse | åˆ†é¡µå“åº” |
| 51 | ImportResult | å¯¼å…¥ç»“æœ |
| 52 | WhitelistDTO | ç™½åå• |
| 53 | WorkTypeDTO | å·¥ä½œç±»å‹ |
| 54 | FactorySettingsDTO | å·¥å‚é…ç½® |
| 55 | DeviceActivationDTO | è®¾å¤‡æ¿€æ´» |

#### J. å…¶ä»–DTOï¼ˆ5ä¸ªï¼‰

| # | DTOç±» | ç”¨é€” |
|---|-------|------|
| 56 | RawMaterialTypeDTO | åŸæ–™ç±»å‹ |
| 57 | MaterialTypeExportDTO | ç‰©æ–™ç±»å‹å¯¼å‡º |
| 58 | MobileDTO | ç§»åŠ¨ç«¯ä¸“ç”¨ |
| 59 | PlatformDTO | å¹³å°æ•°æ® |
| 60+ | ... | ï¼ˆæ›´å¤šDTOï¼‰ |

---

## 3. æ ¸å¿ƒå®ä½“æ€»è§ˆ

### 3.1 æœ€æ ¸å¿ƒçš„15ä¸ªå®ä½“ï¼ˆâ­â­â­â­â­ï¼‰

è¿™15ä¸ªå®ä½“æ„æˆäº†ç³»ç»Ÿçš„æ ¸å¿ƒæ•°æ®æ¶æ„ï¼š

| å®ä½“ | è¡¨å | æ ¸å¿ƒå…³ç³» | ä¸šåŠ¡ä»·å€¼ |
|------|------|---------|---------|
| **Factory** | `factories` | 1:N User, ProcessingBatch, Equipment | å¤šç§Ÿæˆ·éš”ç¦» |
| **User** | `users` | N:1 Factory, N:1 Department | ç”¨æˆ·ä¸æƒé™ |
| **ProcessingBatch** | `processing_batches` | N:1 Factory, N:1 ProductType, 1:N QualityInspection | æ ¸å¿ƒç”Ÿäº§æµç¨‹ |
| **MaterialBatch** | `material_batches` | N:1 Factory, N:1 RawMaterialType, N:1 Supplier | åŸæ–™æº¯æº |
| **ProductType** | `product_types` | N:1 Factory, 1:N ProcessingBatch | äº§å“å®šä¹‰ |
| **RawMaterialType** | `raw_material_types` | N:1 Factory, 1:N MaterialBatch | åŸæ–™å®šä¹‰ |
| **QualityInspection** | `quality_inspections` | N:1 Factory, N:1 ProcessingBatch | è´¨é‡ä¿éšœ |
| **Equipment** | `equipment` | N:1 Factory, 1:N EquipmentAlert | è®¾å¤‡èµ„äº§ |
| **ProductionPlan** | `production_plans` | N:1 Factory, N:1 ProductType | ç”Ÿäº§è®¡åˆ’ |
| **Department** | `departments` | N:1 Factory, 1:N User | ç»„ç»‡æ¶æ„ |
| **Supplier** | `suppliers` | N:1 Factory, 1:N MaterialBatch | ä¾›åº”é“¾ç®¡ç† |
| **Customer** | `customers` | N:1 Factory, 1:N ShipmentRecord | é”€å”®ç®¡ç† |
| **TimeClockRecord** | `time_clock_records` | N:1 Factory, N:1 User | è€ƒå‹¤ç®¡ç† |
| **EquipmentAlert** | `equipment_alerts` | N:1 Factory, N:1 Equipment | å‘Šè­¦ç›‘æ§ |
| **BaseEntity** | - | è¢«æ‰€æœ‰å®ä½“ç»§æ‰¿ | å®¡è®¡è¿½è¸ª |

### 3.2 å®ä½“ç»§æ‰¿å…³ç³»

```
BaseEntity (æŠ½è±¡åŸºç±»)
â”œâ”€â”€ id: Long (ä¸»é”®)
â”œâ”€â”€ createdAt: LocalDateTime (åˆ›å»ºæ—¶é—´)
â””â”€â”€ updatedAt: LocalDateTime (æ›´æ–°æ—¶é—´)

æ‰€æœ‰ä¸šåŠ¡å®ä½“ç»§æ‰¿BaseEntityï¼š
â”œâ”€â”€ Factory
â”œâ”€â”€ User
â”œâ”€â”€ ProcessingBatch
â”œâ”€â”€ MaterialBatch
â”œâ”€â”€ Equipment
â”œâ”€â”€ QualityInspection
â””â”€â”€ ... (å…¶ä»–æ‰€æœ‰å®ä½“)
```

---

## 4. å®ä½“å…³ç³»å›¾ï¼ˆERå›¾ï¼‰

### 4.1 æ ¸å¿ƒä¸šåŠ¡æµç¨‹ERå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Factory   â”‚ (å·¥å‚ - å¤šç§Ÿæˆ·æ ¹èŠ‚ç‚¹)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1:N
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                â”‚                â”‚                â”‚                â”‚
       â–¼                â–¼                â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User    â”‚  â”‚ProcessingBatchâ”‚ â”‚MaterialBatch â”‚ â”‚  Equipment   â”‚ â”‚ ProductType  â”‚
â”‚  (ç”¨æˆ·)    â”‚  â”‚  (åŠ å·¥æ‰¹æ¬¡)   â”‚ â”‚  (åŸæ–™æ‰¹æ¬¡)  â”‚ â”‚   (è®¾å¤‡)     â”‚ â”‚ (äº§å“ç±»å‹)   â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚ N:1            â”‚ 1:N            â”‚ N:1            â”‚ 1:N            â”‚ 1:N
      â–¼                â–¼                â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Department â”‚  â”‚QualityInspectâ”‚ â”‚RawMaterialTypeâ”‚ â”‚EquipmentAlertâ”‚ â”‚ProductionPlanâ”‚
â”‚  (éƒ¨é—¨)    â”‚  â”‚   (è´¨æ£€)     â”‚ â”‚  (åŸæ–™ç±»å‹)  â”‚ â”‚  (è®¾å¤‡å‘Šè­¦)  â”‚ â”‚ (ç”Ÿäº§è®¡åˆ’)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚ 1:N
                                         â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚   Supplier   â”‚
                                  â”‚  (ä¾›åº”å•†)    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 åŠ å·¥æ‰¹æ¬¡æµç¨‹ERå›¾

```
ProcessingBatch (åŠ å·¥æ‰¹æ¬¡)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ N:1 ProductType (äº§å“ç±»å‹)
â”œâ”€â”€ N:1 ProductionPlan (ç”Ÿäº§è®¡åˆ’)
â”œâ”€â”€ N:1 User (supervisorId - ç›‘ç®¡å‘˜)
â”œâ”€â”€ 1:N QualityInspection (è´¨æ£€è®°å½•)
â”œâ”€â”€ 1:N MaterialConsumption (ç‰©æ–™æ¶ˆè€—)
â”œâ”€â”€ 1:N BatchEquipmentUsage (è®¾å¤‡ä½¿ç”¨)
â””â”€â”€ 1:N BatchWorkSession (å·¥æ—¶è®°å½•)

MaterialBatch (åŸæ–™æ‰¹æ¬¡)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ N:1 RawMaterialType (åŸæ–™ç±»å‹)
â”œâ”€â”€ N:1 Supplier (ä¾›åº”å•†)
â””â”€â”€ 1:N MaterialConsumption (è¢«æ¶ˆè€—è®°å½•)

QualityInspection (è´¨æ£€)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ N:1 ProcessingBatch (æ‰€å±æ‰¹æ¬¡)
â”œâ”€â”€ N:1 User (inspectorId - è´¨æ£€å‘˜)
â””â”€â”€ 1:1 AIAnalysisResult (AIåˆ†æç»“æœ)
```

### 4.3 ç”¨æˆ·ä¸æƒé™ERå›¾

```
Factory (å·¥å‚)
â””â”€â”€ 1:N User (ç”¨æˆ·)
     â”œâ”€â”€ N:1 Department (éƒ¨é—¨)
     â”œâ”€â”€ N:1 WorkType (å·¥ä½œç±»å‹)
     â”œâ”€â”€ 1:N TimeClockRecord (æ‰“å¡è®°å½•)
     â””â”€â”€ 1:N EmployeeWorkSession (å·¥æ—¶è®°å½•)

Department (éƒ¨é—¨)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ 1:N User (éƒ¨é—¨å‘˜å·¥)
â””â”€â”€ N:1 User (managerId - éƒ¨é—¨ç»ç†)

WorkType (å·¥ä½œç±»å‹)
â”œâ”€â”€ N:1 Factory
â””â”€â”€ 1:N User (å‘˜å·¥å·¥ä½œç±»å‹)
```

### 4.4 è®¾å¤‡ç®¡ç†ERå›¾

```
Equipment (è®¾å¤‡)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ 1:N EquipmentMaintenance (ç»´æŠ¤è®°å½•)
â”œâ”€â”€ 1:N EquipmentUsage (ä½¿ç”¨è®°å½•)
â”œâ”€â”€ 1:N BatchEquipmentUsage (æ‰¹æ¬¡ä½¿ç”¨)
â””â”€â”€ 1:N EquipmentAlert (å‘Šè­¦è®°å½•)

EquipmentAlert (è®¾å¤‡å‘Šè­¦)
â”œâ”€â”€ N:1 Factory
â”œâ”€â”€ N:1 Equipment
â””â”€â”€ N:1 User (resolvedBy - å¤„ç†äºº)
```

---

## 5. æ•°æ®æ¨¡å‹ç»Ÿè®¡

### 5.1 å®ä½“ç±»ç»Ÿè®¡

| åˆ†ç±» | å®ä½“æ•°é‡ | å æ¯” |
|------|---------|------|
| å¹³å°ä¸å·¥å‚ç®¡ç† | 5 | 11.6% |
| ç”¨æˆ·ä¸æƒé™ | 4 | 9.3% |
| äº§å“ä¸åŸæ–™ç±»å‹ | 4 | 9.3% |
| ç”Ÿäº§æ‰¹æ¬¡ç®¡ç† | 6 | 14.0% |
| è´¨é‡ç®¡ç† | 4 | 9.3% |
| è®¾å¤‡ç®¡ç† | 6 | 14.0% |
| è€ƒå‹¤ä¸å·¥æ—¶ | 3 | 7.0% |
| ä¾›åº”é“¾ç®¡ç† | 4 | 9.3% |
| AIä¸åˆ†æ | 5 | 11.6% |
| åé¦ˆä¸å…¶ä»– | 2 | 4.7% |
| **æ€»è®¡** | **43** | **100%** |

### 5.2 æ ¸å¿ƒç¨‹åº¦åˆ†å¸ƒ

| æ ¸å¿ƒç¨‹åº¦ | å®ä½“æ•°é‡ | ç™¾åˆ†æ¯” | ä»£è¡¨å®ä½“ |
|---------|---------|--------|---------|
| â­â­â­â­â­ (æœ€æ ¸å¿ƒ) | 15 | 34.9% | Factory, User, ProcessingBatch, MaterialBatch |
| â­â­â­â­ (é‡è¦) | 12 | 27.9% | Department, ProductionPlan, EquipmentAlert |
| â­â­â­ (å¸¸ç”¨) | 14 | 32.6% | WorkType, DisposalRecord, AIQuotaUsage |
| â­â­ (è¾…åŠ©) | 2 | 4.7% | FactoryEquipment |

### 5.3 å­—æ®µå¤æ‚åº¦ç»Ÿè®¡

| å®ä½“ | å­—æ®µæ•°é‡ | å…³è”å…³ç³»æ•° | ç´¢å¼•æ•° | å¤æ‚åº¦ |
|------|---------|-----------|--------|--------|
| ProcessingBatch | ~30 | 8 | 6 | ğŸ”´ é«˜ |
| MaterialBatch | ~25 | 5 | 5 | ğŸ”´ é«˜ |
| User | ~20 | 4 | 4 | ğŸŸ¡ ä¸­ |
| Equipment | ~18 | 5 | 4 | ğŸŸ¡ ä¸­ |
| Factory | ~15 | 10+ | 3 | ğŸŸ¡ ä¸­ |
| QualityInspection | ~20 | 6 | 4 | ğŸŸ¡ ä¸­ |

---

## 6. æ–‡æ¡£å¯¼èˆª

### 6.1 æ ¸å¿ƒå®ä½“è¯¦ç»†æ–‡æ¡£ï¼ˆä¼˜å…ˆçº§ï¼‰

**Phase 3.1 - æœ€æ ¸å¿ƒçš„15ä¸ªå®ä½“**ï¼ˆâ­â­â­â­â­ï¼‰ï¼š

1. [PRD-Entity-Factory](./PRD-Entity-Factory.md) - å·¥å‚ï¼ˆå¤šç§Ÿæˆ·æ ¹èŠ‚ç‚¹ï¼‰
2. [PRD-Entity-User](./PRD-Entity-User.md) - ç”¨æˆ·ï¼ˆ8è§’è‰²ç³»ç»Ÿï¼‰
3. [PRD-Entity-ProcessingBatch](./PRD-Entity-ProcessingBatch.md) - åŠ å·¥æ‰¹æ¬¡ï¼ˆæ ¸å¿ƒæµç¨‹ï¼‰
4. [PRD-Entity-MaterialBatch](./PRD-Entity-MaterialBatch.md) - åŸæ–™æ‰¹æ¬¡ï¼ˆæº¯æºæ ¸å¿ƒï¼‰
5. [PRD-Entity-ProductType](./PRD-Entity-ProductType.md) - äº§å“ç±»å‹
6. [PRD-Entity-RawMaterialType](./PRD-Entity-RawMaterialType.md) - åŸæ–™ç±»å‹
7. [PRD-Entity-QualityInspection](./PRD-Entity-QualityInspection.md) - è´¨æ£€è®°å½•
8. [PRD-Entity-Equipment](./PRD-Entity-Equipment.md) - è®¾å¤‡
9. [PRD-Entity-ProductionPlan](./PRD-Entity-ProductionPlan.md) - ç”Ÿäº§è®¡åˆ’
10. [PRD-Entity-Department](./PRD-Entity-Department.md) - éƒ¨é—¨
11. [PRD-Entity-Supplier](./PRD-Entity-Supplier.md) - ä¾›åº”å•†
12. [PRD-Entity-Customer](./PRD-Entity-Customer.md) - å®¢æˆ·
13. [PRD-Entity-TimeClockRecord](./PRD-Entity-TimeClockRecord.md) - æ‰“å¡è®°å½•
14. [PRD-Entity-EquipmentAlert](./PRD-Entity-EquipmentAlert.md) - è®¾å¤‡å‘Šè­¦
15. [PRD-Entity-BaseEntity](./PRD-Entity-BaseEntity.md) - åŸºç¡€å®ä½“

**Phase 3.2 - é‡è¦çš„12ä¸ªå®ä½“**ï¼ˆâ­â­â­â­ï¼‰ï¼š

16-27. ï¼ˆå¾…åˆ›å»ºï¼‰

**Phase 3.3 - å¸¸ç”¨çš„14ä¸ªå®ä½“**ï¼ˆâ­â­â­ï¼‰ï¼š

28-41. ï¼ˆå¾…åˆ›å»ºï¼‰

**Phase 3.4 - è¾…åŠ©çš„2ä¸ªå®ä½“**ï¼ˆâ­â­ï¼‰ï¼š

42-43. ï¼ˆå¾…åˆ›å»ºï¼‰

### 6.2 ä¸“é¢˜æ–‡æ¡£

- [PRD-æ•°æ®å­—å…¸](./PRD-æ•°æ®å­—å…¸.md) - æ‰€æœ‰è¡¨å­—æ®µå¿«é€ŸæŸ¥è¯¢
- [PRD-ERå›¾å®Œæ•´ç‰ˆ](./PRD-ERå›¾å®Œæ•´ç‰ˆ.md) - é«˜æ¸…å®ä½“å…³ç³»å›¾
- [PRD-æ•°æ®åº“ç´¢å¼•ç­–ç•¥](./PRD-æ•°æ®åº“ç´¢å¼•ç­–ç•¥.md) - ç´¢å¼•è®¾è®¡ä¸ä¼˜åŒ–
- [PRD-æ•°æ®è¿ç§»æ–¹æ¡ˆ](./PRD-æ•°æ®è¿ç§»æ–¹æ¡ˆ.md) - æ•°æ®åº“å‡çº§ä¸è¿ç§»

### 6.3 ç›¸å…³æ–‡æ¡£

- [PRD-API-ç´¢å¼•æ–‡æ¡£](./PRD-API-ç´¢å¼•æ–‡æ¡£.md) - æ‰€æœ‰APIç«¯ç‚¹
- [PRD-ç³»ç»Ÿäº§å“éœ€æ±‚æ–‡æ¡£-v4.0](./PRD-ç³»ç»Ÿäº§å“éœ€æ±‚æ–‡æ¡£-v4.0.md) - å®Œæ•´PRD
- [PRD-æŠ€æœ¯æ¶æ„æ–‡æ¡£](./PRD-æŠ€æœ¯æ¶æ„æ–‡æ¡£.md) - ç³»ç»Ÿæ¶æ„è®¾è®¡

---

## 7. ä¸‹ä¸€æ­¥è®¡åˆ’

### 7.1 Phase 3æ‰§è¡Œè®¡åˆ’

**é˜¶æ®µ1**ï¼ˆå½“å‰ï¼‰ï¼šæ ¸å¿ƒå®ä½“æ·±åº¦åˆ†æï¼ˆ15ä¸ªï¼‰
- âœ… åˆ›å»ºæ€»è§ˆæ–‡æ¡£ï¼ˆæœ¬æ–‡æ¡£ï¼‰
- ğŸ”¨ é€ä¸ªåˆ†æâ­â­â­â­â­å®ä½“ï¼ˆ6ç»´åº¦åˆ†æï¼‰
- ğŸ”¨ ç»˜åˆ¶è¯¦ç»†ERå›¾
- ğŸ”¨ å»ºç«‹æ•°æ®å­—å…¸

**é˜¶æ®µ2**ï¼šé‡è¦å®ä½“åˆ†æï¼ˆ12ä¸ªï¼‰
- åˆ†æâ­â­â­â­å®ä½“
- è¡¥å……ERå›¾

**é˜¶æ®µ3**ï¼šå¸¸ç”¨å®ä½“åˆ†æï¼ˆ14ä¸ªï¼‰
- åˆ†æâ­â­â­å®ä½“
- å®Œå–„æ•°æ®å­—å…¸

**é˜¶æ®µ4**ï¼šè¾…åŠ©å®ä½“åˆ†æï¼ˆ2ä¸ªï¼‰
- åˆ†æå‰©ä½™å®ä½“
- å®Œæˆæ‰€æœ‰æ–‡æ¡£

### 7.2 é¢„æœŸäº§å‡º

- **43ä¸ªå®ä½“è¯¦ç»†æ–‡æ¡£**ï¼ˆæ¯ä¸ªçº¦5-8KBï¼‰
- **å®Œæ•´ERå›¾**ï¼ˆMermaidæ ¼å¼ï¼‰
- **æ•°æ®å­—å…¸**ï¼ˆæ‰€æœ‰è¡¨å­—æ®µï¼‰
- **ç´¢å¼•ç­–ç•¥æ–‡æ¡£**
- **æ•°æ®åº“è®¾è®¡é—®é¢˜æŠ¥å‘Š**

---

**æ–‡æ¡£ç»“æŸ**

ä¸‹ä¸€æ­¥ï¼šå¼€å§‹åˆ†æç¬¬1ä¸ªæ ¸å¿ƒå®ä½“ - [Factoryï¼ˆå·¥å‚ï¼‰](./PRD-Entity-Factory.md)

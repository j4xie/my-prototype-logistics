Python æ•°æ®åˆ†æå¾®æœåŠ¡è¿ç§»æ–¹æ¡ˆ
æ–‡æ¡£ä½ç½®: è®¡åˆ’æ‰¹å‡†åå°†å¤åˆ¶åˆ° c:\Users\Steve\my-prototype-logistics\PYTHON-MIGRATION-PLAN.md

ä¸€ã€é¡¹ç›®èƒŒæ™¯
å½“å‰é—®é¢˜
Excel å¤šå±‚è¡¨å¤´è§£æå¤±è´¥ - Java 500+ è¡Œä»£ç ä»æ— æ³•æ­£ç¡®è§£æï¼Œå¯¼è‡´æ•°å€¼å…¨ä¸º 0
å¤æ‚ç®—æ³•å®ç°å›°éš¾ - LinUCBã€æ—¶é—´åºåˆ—é¢„æµ‹ã€ç‰¹å¾å·¥ç¨‹ç­‰åœ¨ Java ä¸­ä»£ç å†—é•¿
æ‰©å±•æ€§å·® - æ·»åŠ æ–°ç®—æ³•éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç 
å¼€å‘æ•ˆç‡ä½ - Python ç”Ÿæ€æ›´æˆç†Ÿï¼ˆPandasã€Scikit-learnã€Statsmodelsï¼‰
è¿ç§»åŸåˆ™
åªè¿ç§» Python æ“…é•¿çš„éƒ¨åˆ† - æ•°æ®å¤„ç†ã€ç»Ÿè®¡åˆ†æã€ML ç®—æ³•
ä¿ç•™ Java æ“…é•¿çš„éƒ¨åˆ† - API è·¯ç”±ã€æ•°æ®åº“è®¿é—®ã€äº‹åŠ¡ç®¡ç†ã€æƒé™æ§åˆ¶
æœ€å°åŒ–æ”¹åŠ¨ - é€šè¿‡ HTTP è°ƒç”¨é›†æˆï¼Œä¸æ”¹å˜å‰ç«¯æ¥å£
äºŒã€åç«¯ç°çŠ¶åˆ†æ
æ¶‰åŠæ•°æ®åˆ†æçš„æœåŠ¡ç»Ÿè®¡
ç±»åˆ«	æœåŠ¡æ•°é‡	é€‚åˆ Python	ä¼˜å…ˆçº§
SmartBI åˆ†æ	13 ä¸ª	10 ä¸ª	P0
AI/ML ç®—æ³•	10 ä¸ª	10 ä¸ª	P0
æ•°æ®å¤„ç†	5 ä¸ª	5 ä¸ª	P0
æ„å›¾è¯†åˆ«/NLP	8 ä¸ª	6 ä¸ª	P1
æŠ¥è¡¨ç»Ÿè®¡	6 ä¸ª	4 ä¸ª	P1
è°ƒåº¦ä¼˜åŒ–	12 ä¸ª	6 ä¸ª	P2
å…¶ä»–	è‹¥å¹²	-	P3
æ€»è®¡: 120+ ä¸ªæœåŠ¡ï¼Œ60% é€‚åˆ Python å¤„ç†

ä¸‰ã€6 å¤§æ ¸å¿ƒç³»ç»Ÿ Java/Python é€‚åˆåº¦åˆ†æ
3.0 æ€»è§ˆ
ç³»ç»Ÿ	Java é€‚åˆåº¦	Python é€‚åˆåº¦	æ¨èæ–¹æ¡ˆ	è¿ç§»ä¼˜å…ˆçº§
æ„å›¾è¯†åˆ«	â­â­â­â­ (4/5)	â­â­ (2/5)	âœ… ä¿æŒ Java	æ— éœ€è¿ç§»
çº é”™æœºåˆ¶	â­â­â­ (3/5)	â­â­â­â­ (4/5)	ğŸ”„ è¿ç§» Python	P1
Agent/Skill è°ƒç”¨	â­â­â­â­â­ (5/5)	â­â­ (2/5)	âœ… ä¿æŒ Java	æ— éœ€è¿ç§»
SmartBI åˆ†æ	â­â­ (2/5)	â­â­â­â­â­ (5/5)	ğŸ”„ è¿ç§» Python	P0
æ¨èç®—æ³• (LinUCB)	â­â­ (2/5)	â­â­â­â­ (4/5)	ğŸ”„ è¿ç§» Python	P1
è°ƒåº¦ç³»ç»Ÿ	â­â­â­â­ (4/5)	â­â­â­ (3/5)	âœ… ä¿æŒ Java	æ— éœ€è¿ç§»
3.1 æ„å›¾è¯†åˆ«ç³»ç»Ÿ - âœ… ä¿æŒ Java
ä»£ç è§„æ¨¡: 63,000+ è¡Œï¼Œ15+ ä¸ª Handlerï¼Œ2 é˜¶æ®µåˆ†ç±»

æ ¸å¿ƒåŠŸèƒ½:

å…³é”®è¯/å‘é‡åŒ¹é…æ„å›¾è¯†åˆ«
Embedding å‘é‡åŒ–ä¸ç¼“å­˜
LLM Fallback åŠ¨æ€æ¨ç†
å¤šç§Ÿæˆ·éš”ç¦»ã€ä¼šè¯ä¸Šä¸‹æ–‡
ä¸ºä»€ä¹ˆä¿æŒ Java:

âœ… éœ€è¦æ•°æ®åº“äº‹åŠ¡ - é¢‘ç¹è¯»å†™æ„å›¾é…ç½®
âœ… éœ€è¦å®æ—¶å“åº” - ç”¨æˆ·è¾“å…¥ç§’çº§å“åº”
âœ… å¤æ‚ä¸šåŠ¡é€»è¾‘ - æƒé™æ ¡éªŒã€é…é¢ç®¡ç†
âœ… ä¸åç«¯ç³»ç»Ÿé›†æˆç´§å¯†
âŒ å‘é‡åŒ¹é…æ€§èƒ½ä¸å¦‚ Pythonï¼Œä½†å½±å“ä¸å¤§
3.2 çº é”™æœºåˆ¶ - ğŸ”„ è¿ç§» Python
ä»£ç è§„æ¨¡: 200+ è¡Œï¼Œå®šæ—¶ä»»åŠ¡

æ ¸å¿ƒåŠŸèƒ½:

æ—¥æ±‡æ€»ç»Ÿè®¡ (from intent_match_records)
6 å¤§é”™è¯¯å½’å› åˆ†ç±»
é«˜é¢‘å¤±è´¥æ¨¡å¼è¯†åˆ«
ä¼˜åŒ–å»ºè®®ç”Ÿæˆ
ä¸ºä»€ä¹ˆè¿ç§» Python:

âœ… å¤æ‚æ•°æ®èšåˆ - pandas ä¸“é•¿
âœ… æ— å®æ—¶æ€§è¦æ±‚ - å®šæ—¶ä»»åŠ¡ (æ—¥ 0 ç‚¹)
âœ… ç»Ÿè®¡è®¡ç®— - Java 200 è¡Œ â†’ Python 50 è¡Œ
âœ… æ¨¡å¼è¯†åˆ« - sklearn æ˜“å®ç°

# Python ç‰ˆæœ¬ç¤ºä¾‹
df = pd.read_sql("SELECT * FROM intent_match_records", conn)
stats = df.groupby('matched_intent_code').agg({
    'execution_status': lambda x: (x == 'EXECUTED').sum()
})
3.3 Agent/Skill è°ƒç”¨ç³»ç»Ÿ - âœ… ä¿æŒ Java
ä»£ç è§„æ¨¡: 300+ è¡Œï¼Œ20+ ä¸ª Tool å®ç°

æ ¸å¿ƒåŠŸèƒ½:

Skill/Tool åŠ¨æ€è·¯ç”±ä¸æ‰§è¡Œ
å‚æ•°æå–ä¸ç±»å‹æ˜ å°„
æ‰§è¡Œé¡ºåºæ§åˆ¶ã€è¶…æ—¶ç®¡ç†
ä¸ºä»€ä¹ˆä¿æŒ Java:

âœ… Spring ä¾èµ–æ³¨å…¥ç®¡ç† Tool å®ä¾‹
âœ… åå°„æœºåˆ¶å®ç°åŠ¨æ€è·¯ç”±
âœ… å¼ºç±»å‹ç³»ç»Ÿé˜²æ­¢å‚æ•°é”™è¯¯
âœ… å¼‚å¸¸å¤„ç†ã€è¶…æ—¶æ§åˆ¶å®Œå–„
âœ… ä¸ç°æœ‰ Spring Boot æ— ç¼é›†æˆ
3.4 SmartBI åˆ†æç³»ç»Ÿ - ğŸ”„ è¿ç§» Python (æœ€é«˜ä¼˜å…ˆçº§)

**ä»£ç è§„æ¨¡**: 25 ä¸ªæœåŠ¡æ–‡ä»¶ï¼Œ8000+ è¡Œä»£ç 

### 3.4.1 SmartBI å®Œæ•´åŠŸèƒ½æ¨¡å—æ¸…å•

| åŠŸèƒ½æ¨¡å— | Java æœåŠ¡ | ä»£ç è¡Œæ•° | Java é€‚åˆåº¦ | Python é€‚åˆåº¦ | è¿ç§»å†³ç­– |
|---------|----------|---------|------------|--------------|---------|
| **Excel å¤šå±‚è¡¨å¤´è§£æ** | ExcelDynamicParserServiceImpl | 2127 è¡Œ | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **æ•°æ®æ–¹å‘æ£€æµ‹/è½¬ç½®** | (åŒä¸Š) | - | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **å­—æ®µç±»å‹æ£€æµ‹** | (åŒä¸Š) | - | â­â­â­ (3/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **LLM å­—æ®µæ˜ å°„** | LLMFieldMappingServiceImpl | 1001 è¡Œ | â­â­â­ (3/5) | â­â­â­â­ (4/5) | ğŸ”„ éƒ¨åˆ†è¿ç§» |
| **æŒ‡æ ‡è®¡ç®— (30+)** | MetricCalculatorServiceImpl | 833 è¡Œ | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **æ—¶é—´åºåˆ—é¢„æµ‹** | ForecastServiceImpl | 565 è¡Œ | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **é”€å”®åˆ†æ** | SalesAnalysisServiceImpl | 400+ è¡Œ | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **è´¢åŠ¡åˆ†æ** | FinanceAnalysisServiceImpl | 350+ è¡Œ | â­â­ (2/5) | â­â­â­â­â­ (5/5) | ğŸ”„ è¿ç§» |
| **å›¾è¡¨é…ç½®ç”Ÿæˆ** | DynamicChartConfigBuilder | 300+ è¡Œ | â­â­â­ (3/5) | â­â­â­â­ (4/5) | ğŸ”„ è¿ç§» |
| **æ•°æ®æŒä¹…åŒ–** | ExcelDataPersistenceService | 400+ è¡Œ | â­â­â­â­ (4/5) | â­â­â­ (3/5) | âœ… ä¿ç•™ Java |
| **æµç¨‹ç¼–æ’** | SmartBIUploadFlowService | 500+ è¡Œ | â­â­â­â­â­ (5/5) | â­â­ (2/5) | âœ… ä¿ç•™ Java |
| **é…ç½®ç®¡ç†** | SmartBIConfigService | 300+ è¡Œ | â­â­â­â­â­ (5/5) | â­â­ (2/5) | âœ… ä¿ç•™ Java |
| **ç¼“å­˜/é…é¢** | SmartBIServiceImpl | 1000+ è¡Œ | â­â­â­â­â­ (5/5) | â­â­ (2/5) | âœ… ä¿ç•™ Java |

### 3.4.2 å„åŠŸèƒ½æ¨¡å—è¯¦ç»†åˆ†æ

#### A. Excel è§£ææ¨¡å— (ExcelDynamicParserServiceImpl) - ğŸ”„ è¿ç§»

**Java å®ç°é—®é¢˜ (2127 è¡Œ)**:
- å¤šå±‚è¡¨å¤´æ£€æµ‹: æ‰‹å†™åˆå¹¶å•å…ƒæ ¼å¤„ç† (~300 è¡Œ)
- æ•°æ®æ–¹å‘æ£€æµ‹: å¤æ‚çš„å¯å‘å¼è§„åˆ™ (~200 è¡Œ)
- æ•°æ®è½¬ç½®: æ‰‹åŠ¨è¡Œåˆ—è½¬æ¢ (~150 è¡Œ)
- å­—æ®µç±»å‹æ£€æµ‹: å¤§é‡æ­£åˆ™å’Œé˜ˆå€¼åˆ¤æ–­ (~400 è¡Œ)

**Python ä¼˜åŠ¿**:
```python
# å¤šå±‚è¡¨å¤´ (Java 300è¡Œ â†’ Python 1è¡Œ)
df = pd.read_excel(file, header=[0, 1, 2])

# æ•°æ®è½¬ç½® (Java 150è¡Œ â†’ Python 1è¡Œ)
df_long = df.melt(id_vars=['é¡¹ç›®'], var_name='period', value_name='value')

# å­—æ®µç±»å‹æ£€æµ‹ (Java 400è¡Œ â†’ Python 10è¡Œ)
for col in df.columns:
    if pd.api.types.is_datetime64_any_dtype(df[col]):
        type = 'DATE'
    elif pd.api.types.is_numeric_dtype(df[col]):
        type = 'NUMERIC'
```

**ä»£ç ç®€åŒ–**: Java 2127 è¡Œ â†’ Python ~300 è¡Œ (å‡å°‘ 86%)

#### B. LLM å­—æ®µæ˜ å°„æ¨¡å— (LLMFieldMappingServiceImpl) - ğŸ”„ éƒ¨åˆ†è¿ç§»

**Java å®ç° (1001 è¡Œ)**:
- LLM API è°ƒç”¨å°è£…
- å“åº”è§£æä¸é”™è¯¯å¤„ç†
- å­—å…¸ç¼“å­˜æŸ¥è¯¢
- å›¾è¡¨è§’è‰²æ¨æ–­

**è¿ç§»ç­–ç•¥**:
- **è¿ç§»**: LLM è°ƒç”¨ã€å“åº”è§£æã€è§’è‰²æ¨æ–­
- **ä¿ç•™ Java**: å­—å…¸ç¼“å­˜æŸ¥è¯¢ (éœ€è¦æ•°æ®åº“äº‹åŠ¡)

**Python ä¼˜åŠ¿**:
```python
# LLM è°ƒç”¨æ›´ç®€æ´
from dashscope import Generation

response = Generation.call(
    model='qwen-turbo',
    messages=[{'role': 'user', 'content': prompt}]
)
result = json.loads(response.output.text)
```

#### C. æŒ‡æ ‡è®¡ç®—æ¨¡å— (MetricCalculatorServiceImpl) - ğŸ”„ è¿ç§»

**Java å®ç° (833 è¡Œ)**:
- 30+ ä¸šåŠ¡æŒ‡æ ‡å®šä¹‰
- åˆ†ç»„èšåˆè®¡ç®—
- è¶‹åŠ¿è®¡ç®—
- é¢„è­¦åˆ¤æ–­

**Python ä¼˜åŠ¿**:
```python
# é”€å”®æŒ‡æ ‡ (Java 50è¡Œ â†’ Python 5è¡Œ)
metrics = df.groupby('salesperson').agg({
    'amount': ['sum', 'count', 'mean'],
    'order_id': 'nunique',
    'customer': 'nunique'
})

# ç›®æ ‡å®Œæˆç‡
metrics['completion_rate'] = metrics['amount_sum'] / targets * 100

# ç¯æ¯”å¢é•¿
metrics['mom_growth'] = metrics['amount_sum'].pct_change() * 100
```

**ä»£ç ç®€åŒ–**: Java 833 è¡Œ â†’ Python ~150 è¡Œ (å‡å°‘ 82%)

#### D. é¢„æµ‹æ¨¡å— (ForecastServiceImpl) - ğŸ”„ è¿ç§»

**Java å®ç° (565 è¡Œ)**:
- ç§»åŠ¨å¹³å‡: æ‰‹åŠ¨å®ç°
- çº¿æ€§è¶‹åŠ¿: æ‰‹å†™æœ€å°äºŒä¹˜æ³•
- æŒ‡æ•°å¹³æ»‘: æ‰‹åŠ¨å®ç°
- ç½®ä¿¡åŒºé—´: æ‰‹åŠ¨è®¡ç®—æ ‡å‡†å·®

**Python ä¼˜åŠ¿**:
```python
# ç§»åŠ¨å¹³å‡ (Java 30è¡Œ â†’ Python 1è¡Œ)
df['ma7'] = df['value'].rolling(7).mean()

# æŒ‡æ•°å¹³æ»‘ (Java 50è¡Œ â†’ Python 3è¡Œ)
from statsmodels.tsa.holtwinters import ExponentialSmoothing
model = ExponentialSmoothing(data, trend='add')
forecast = model.fit().forecast(30)

# Prophet é«˜çº§é¢„æµ‹ (Java æ— æ³•å®ç°)
from prophet import Prophet
model = Prophet()
model.fit(df)
future = model.predict(model.make_future_dataframe(periods=30))
```

**ä»£ç ç®€åŒ–**: Java 565 è¡Œ â†’ Python ~80 è¡Œ (å‡å°‘ 86%)

#### E. å›¾è¡¨é…ç½®ç”Ÿæˆ (DynamicChartConfigBuilder) - ğŸ”„ è¿ç§»

**Java å®ç° (300+ è¡Œ)**:
- æ•°æ®ç‰¹å¾åˆ†æ
- å›¾è¡¨ç±»å‹æ¨è
- ECharts é…ç½®ç”Ÿæˆ

**Python ä¼˜åŠ¿**:
```python
# æ•°æ®ç‰¹å¾åˆ†æ
features = {
    'has_time': df.select_dtypes('datetime').shape[1] > 0,
    'numeric_cols': df.select_dtypes('number').columns.tolist(),
    'categorical_cols': df.select_dtypes('object').columns.tolist(),
    'unique_counts': {col: df[col].nunique() for col in df.columns}
}

# å›¾è¡¨æ¨èè§„åˆ™
if features['has_time'] and len(features['numeric_cols']) >= 1:
    chart_type = 'line'
elif len(features['categorical_cols']) >= 1:
    chart_type = 'bar'
```

### 3.4.3 ä¿ç•™åœ¨ Java çš„æ¨¡å—

| æ¨¡å— | åŸå›  |
|------|------|
| SmartBIUploadFlowService | æµç¨‹ç¼–æ’ã€äº‹åŠ¡ç®¡ç†ã€å¤šæ­¥éª¤åŸå­æ€§ |
| SmartBIServiceImpl | ç¼“å­˜ç®¡ç†ã€é…é¢æ§åˆ¶ã€ä½¿ç”¨è®°å½• |
| SmartBIConfigService | é…ç½® CRUDã€æƒé™æ ¡éªŒ |
| ExcelDataPersistenceService | æ•°æ®åº“å†™å…¥ã€äº‹åŠ¡ |
| SmartBIIntentService | ä¸æ„å›¾ç³»ç»Ÿé›†æˆ |

### 3.4.4 ä»£ç ç®€åŒ–æ•ˆæœæ±‡æ€»

| æ¨¡å— | Java è¡Œæ•° | Python è¡Œæ•° | ç®€åŒ–æ¯”ä¾‹ |
|------|----------|------------|---------|
| Excel è§£æ | 2127 | ~300 | 86% |
| æŒ‡æ ‡è®¡ç®— | 833 | ~150 | 82% |
| é¢„æµ‹æœåŠ¡ | 565 | ~80 | 86% |
| LLM æ˜ å°„ | 1001 | ~200 | 80% |
| å›¾è¡¨é…ç½® | 300 | ~100 | 67% |
| **åˆè®¡** | **4826** | **~830** | **83%**
3.5 æ¨èç®—æ³• (LinUCB) - ğŸ”„ è¿ç§» Python
ä»£ç è§„æ¨¡: 840 è¡Œï¼Œæ ¸å¿ƒçŸ©é˜µè¿ç®—

æ ¸å¿ƒåŠŸèƒ½:

UCB è®¡ç®—: UCB(a) = Î¸^T * x + Î± * sqrt(x^T * A^(-1) * x)
æ¨¡å‹æ›´æ–°: Sherman-Morrison çŸ©é˜µæ›´æ–°
å·¥äººæ¨èã€å¤šæ ·æ€§è°ƒæ•´
ä¸ºä»€ä¹ˆè¿ç§» Python:

âœ… numpy çŸ©é˜µè¿ç®—: Java 60 è¡Œ â†’ Python 1 è¡Œ
âœ… æ€§èƒ½: Python numpy æ¯” Java å¿« 10-20x
âœ… scipy.linalg.inv() æ•°å€¼ç¨³å®šæ€§æ›´å¥½

# Python ç‰ˆæœ¬
A_inv = np.linalg.inv(A)           # çŸ©é˜µæ±‚é€†
theta = A_inv @ b                   # å‚æ•°å‘é‡
ucb = context @ theta + alpha * np.sqrt(context @ A_inv @ context)
æ€§èƒ½å¯¹æ¯”:

Java çŸ©é˜µæ±‚é€† (16x16): ~5-10ms
Python numpy (16x16): ~0.2-0.5ms âœ… å¿« 10-20 å€
3.6 è°ƒåº¦ç³»ç»Ÿ - âœ… ä¿æŒ Java
ä»£ç è§„æ¨¡: 500+ è¡Œï¼Œå¤æ‚ä¸šåŠ¡é€»è¾‘

æ ¸å¿ƒåŠŸèƒ½:

è®¡åˆ’ç”Ÿæˆã€å·¥äººä¼˜åŒ–
çº¦æŸç®¡ç† (Drools è§„åˆ™)
åŠ¨æ€é‡æ’ã€å‘Šè­¦ç›‘æ§
ä¸ºä»€ä¹ˆä¿æŒ Java:

âœ… æå¤æ‚ä¸šåŠ¡é€»è¾‘ - çº¦æŸæ±‚è§£ã€è§„åˆ™å¼•æ“
âœ… é‡äº‹åŠ¡ - æ‰¹é‡åˆ›å»ºéœ€åŸå­æ€§
âœ… Drools è§„åˆ™å¼•æ“æˆç†Ÿ
âœ… å¼‚æ­¥ä»»åŠ¡ - Spring @Async å®Œå–„
ä¼˜åŒ–æ–¹æ¡ˆ: è°ƒåº¦ä¸»ä½“ä¿ç•™ Javaï¼Œä½† LinUCB è°ƒç”¨æ”¹ä¸º Python æœåŠ¡


SchedulingService (Java) â”€â”€HTTPâ”€â”€â–º LinUCB-Service (Python)
å››ã€è¿ç§»æœåŠ¡è¯¦ç»†æ¸…å•

4.1 ğŸ”„ è¿ç§»åˆ° Python çš„æœåŠ¡

### P0 - SmartBI æ ¸å¿ƒåŠŸèƒ½ (ç«‹å³è¿ç§»)

#### P0.1 æ•°æ®è§£æå±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| ExcelDynamicParserServiceImpl | å¤šå±‚è¡¨å¤´æ£€æµ‹ | 300+ | `pd.read_excel(header=[0,1,2])` | 10 |
| (åŒä¸Š) | æ•°æ®æ–¹å‘æ£€æµ‹ | 200+ | `df.T` + å¯å‘å¼è§„åˆ™ | 30 |
| (åŒä¸Š) | åˆå¹¶å•å…ƒæ ¼å¤„ç† | 200+ | `openpyxl` è‡ªåŠ¨å¤„ç† | 20 |
| (åŒä¸Š) | æ•°æ®è½¬ç½® (å®½â†’é•¿) | 150+ | `pd.melt()` | 5 |
| (åŒä¸Š) | å­—æ®µç±»å‹æ£€æµ‹ | 400+ | `pd.api.types` + ç»Ÿè®¡ | 50 |
| (åŒä¸Š) | æ•°æ®ç‰¹å¾åˆ†æ | 300+ | `df.describe()` + è‡ªå®šä¹‰ | 40 |

#### P0.2 å­—æ®µè¯†åˆ«å±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| LLMFieldMappingServiceImpl | LLM å­—æ®µæ˜ å°„ | 400+ | DashScope SDK ç›´æ¥è°ƒç”¨ | 80 |
| (åŒä¸Š) | å­—æ®µè§’è‰²æ¨æ–­ | 300+ | è§„åˆ™å¼•æ“ + LLM | 60 |
| (åŒä¸Š) | å›¾è¡¨è½´ä½ç½®æ¨è | 200+ | ç‰¹å¾åˆ†æ + è§„åˆ™ | 40 |
| FieldMappingDictionary | æ ‡å‡†å­—æ®µåŒ¹é… | 150+ | æ¨¡ç³ŠåŒ¹é… + åŒä¹‰è¯åº“ | 30 |

#### P0.3 æ•°æ®å¤„ç†å±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| MetricCalculatorServiceImpl | 30+ ä¸šåŠ¡æŒ‡æ ‡ | 833 | pandas èšåˆ | 150 |
| (åŒä¸Š) | åˆ†ç»„ç»´åº¦è®¡ç®— | 200+ | `df.groupby().agg()` | 20 |
| (åŒä¸Š) | è¶‹åŠ¿è®¡ç®— | 100+ | `pct_change()` | 10 |
| (åŒä¸Š) | é¢„è­¦åˆ¤æ–­ | 150+ | é˜ˆå€¼é…ç½® + è§„åˆ™ | 30 |

#### P0.4 åˆ†ææœåŠ¡å±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| SalesAnalysisServiceImpl | é”€å”® KPIã€æ’åã€è¶‹åŠ¿ | 400+ | pandas èšåˆ | 80 |
| FinanceAnalysisServiceImpl | è´¢åŠ¡æŒ‡æ ‡ã€åŒç¯æ¯” | 350+ | pandas + å…¬å¼ | 70 |
| DepartmentAnalysisServiceImpl | éƒ¨é—¨æ’åã€æ•ˆç‡ | 300+ | pandas èšåˆ | 60 |
| RegionAnalysisServiceImpl | åŒºåŸŸä¸‹é’»ã€çƒ­åŠ›å›¾ | 350+ | pandas + åœ°ç† | 70 |

#### P0.5 é¢„æµ‹æœåŠ¡å±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| ForecastServiceImpl | ç§»åŠ¨å¹³å‡ | 50+ | `rolling().mean()` | 3 |
| (åŒä¸Š) | çº¿æ€§è¶‹åŠ¿ | 80+ | `scipy.stats.linregress` | 5 |
| (åŒä¸Š) | æŒ‡æ•°å¹³æ»‘ | 60+ | `statsmodels.ExponentialSmoothing` | 5 |
| (åŒä¸Š) | é«˜çº§é¢„æµ‹ | - | `prophet.Prophet` | 10 |
| (åŒä¸Š) | ç½®ä¿¡åŒºé—´ | 100+ | å†…ç½®äºåº“ | 0 |

#### P0.6 LLM åˆ†æå±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| SmartBIPromptService | AI æ´å¯Ÿç”Ÿæˆ | 200+ | LangChain / DashScope | 50 |
| (åŒä¸Š) | ä¸šåŠ¡å»ºè®®ç”Ÿæˆ | 150+ | Prompt Engineering | 30 |
| RecommendationServiceImpl | é¢„è­¦æ–‡æœ¬ç”Ÿæˆ | 200+ | æ¨¡æ¿ + LLM | 40 |

#### P0.7 å›¾è¡¨ç”Ÿæˆå±‚

| Java æœåŠ¡ | åŠŸèƒ½ | Java è¡Œæ•° | Python æ–¹æ¡ˆ | Python è¡Œæ•° |
|----------|------|----------|------------|------------|
| DataFeatureExtractor | æ•°æ®ç‰¹å¾æå– | 200+ | pandas ç»Ÿè®¡ | 40 |
| AdaptiveChartGenerator | å›¾è¡¨ç±»å‹æ¨è | 200+ | è§„åˆ™å¼•æ“ | 50 |
| DynamicChartConfigBuilder | ECharts é…ç½®ç”Ÿæˆ | 300+ | JSON æ¨¡æ¿ + æ•°æ®å¡«å…… | 80 |

### P0 ä»£ç é‡æ±‡æ€»

| å±‚æ¬¡ | Java æ€»è¡Œæ•° | Python é¢„ä¼° | ç®€åŒ–æ¯”ä¾‹ |
|------|-----------|------------|---------|
| æ•°æ®è§£æ | 1550+ | ~155 | 90% |
| å­—æ®µè¯†åˆ« | 1050+ | ~210 | 80% |
| æ•°æ®å¤„ç† | 1283+ | ~210 | 84% |
| åˆ†ææœåŠ¡ | 1400+ | ~280 | 80% |
| é¢„æµ‹æœåŠ¡ | 290+ | ~23 | 92% |
| LLM åˆ†æ | 550+ | ~120 | 78% |
| å›¾è¡¨ç”Ÿæˆ | 700+ | ~170 | 76% |
| **P0 æ€»è®¡** | **6823+** | **~1168** | **83%**
P1 - å°½å¿«è¿ç§» (ML ç®—æ³• + çº é”™)
Java æœåŠ¡	åŠŸèƒ½	Python æ–¹æ¡ˆ
LinUCBServiceImpl	ä¸Šä¸‹æ–‡è€è™æœº	numpy çŸ©é˜µè¿ç®—
FairMABServiceImpl	å…¬å¹³å¤šè‡‚è€è™æœº	numpy
FeatureEngineeringServiceImpl	16 ç»´ç‰¹å¾æå–	scikit-learn
IndividualEfficiencyServiceImpl	æ•ˆç‡åˆ†è§£	scipy.linalg
ErrorAttributionAnalysisServiceImpl	çº é”™ç»Ÿè®¡	pandas èšåˆ
RecommendationServiceImpl	é¢„è­¦ç”Ÿæˆ	pandas + è§„åˆ™
4.2 âœ… ä¿ç•™åœ¨ Java çš„æœåŠ¡
æ„å›¾è¯†åˆ«ç³»ç»Ÿ (ä¿ç•™ Java)
Java æœåŠ¡	åŸå› 
AIIntentServiceImpl	å¤æ‚ä¸šåŠ¡é€»è¾‘ã€å®æ—¶å“åº”ã€å¤šç§Ÿæˆ·éš”ç¦»
IntentExecutorServiceImpl	Tool ç¼–æ’ã€äº‹åŠ¡ç®¡ç†
MultiLabelIntentClassifierImpl	ä¸æ„å›¾ç³»ç»Ÿç´§å¯†è€¦åˆ
Agent/Skill ç³»ç»Ÿ (ä¿ç•™ Java)
Java æœåŠ¡	åŸå› 
AgentOrchestratorService	Spring DI ç®¡ç†ã€åå°„è·¯ç”±
SkillRouterService	å¼ºç±»å‹å‚æ•°ã€å¼‚å¸¸å¤„ç†
æ‰€æœ‰ *Tool å®ç°	ä¸åç«¯ API ç´§å¯†é›†æˆ
è°ƒåº¦ç³»ç»Ÿä¸»ä½“ (ä¿ç•™ Java)
Java æœåŠ¡	åŸå› 
SchedulingServiceImpl	é‡äº‹åŠ¡ã€çº¦æŸæ±‚è§£
APSAdaptiveSchedulingServiceImpl	Drools è§„åˆ™å¼•æ“
RescheduleTriggerServiceImpl	å¼‚æ­¥ä»»åŠ¡ã€é€šçŸ¥æ¨é€
æ³¨æ„: è°ƒåº¦ç³»ç»Ÿä¿ç•™ Javaï¼Œä½†è°ƒç”¨ Python çš„ LinUCB æœåŠ¡

äº”ã€æŠ€æœ¯æ¶æ„
5.1 æ•´ä½“æ¶æ„

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å‰ç«¯ (React Native / Web)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Java åç«¯ (Spring Boot :10010)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Controllers - REST API å…¥å£ (ä¿æŒä¸å˜)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    æœåŠ¡è°ƒç”¨å±‚                          â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚     â”‚
â”‚  â”‚  â”‚ HTTP Client â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ Python æœåŠ¡ (:8081)  â”‚â”‚     â”‚
â”‚  â”‚  â”‚ (è°ƒç”¨ Python)â”‚              â”‚ æ•°æ®å¤„ç†/åˆ†æ/ML    â”‚â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚     â”‚
â”‚  â”‚         â”‚                              â–²             â”‚     â”‚
â”‚  â”‚         â”‚ Fallback                     â”‚             â”‚     â”‚
â”‚  â”‚         â–¼                              â”‚             â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚             â”‚     â”‚
â”‚  â”‚  â”‚ Java åŸæœ‰   â”‚                       â”‚             â”‚     â”‚
â”‚  â”‚  â”‚ å®ç° (å¤‡ç”¨) â”‚                       â”‚             â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚             â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                              â”‚            â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ æ•°æ®æŒä¹…åŒ–å±‚ (JPA/MyBatis)              â”‚             â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   æ•°æ®åº“ (MySQL :3306)   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
5.2 Python SmartBI æœåŠ¡æ¶æ„

```
smartbi-python-service/
â”œâ”€â”€ main.py                           # FastAPI å…¥å£
â”œâ”€â”€ config.py                         # é…ç½® (ç«¯å£ã€LLM Key ç­‰)
â”œâ”€â”€ requirements.txt                  # ä¾èµ–
â”œâ”€â”€ Dockerfile                        # Docker é…ç½®
â”‚
â”œâ”€â”€ api/                              # API è·¯ç”± (å¯¹åº” P0 å„å±‚)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ excel.py                      # P0.1 æ•°æ®è§£æ API
â”‚   â”œâ”€â”€ field_mapping.py              # P0.2 å­—æ®µè¯†åˆ« API
â”‚   â”œâ”€â”€ metrics.py                    # P0.3 æ•°æ®å¤„ç† API
â”‚   â”œâ”€â”€ analysis.py                   # P0.4 åˆ†ææœåŠ¡ API
â”‚   â”œâ”€â”€ forecast.py                   # P0.5 é¢„æµ‹æœåŠ¡ API
â”‚   â”œâ”€â”€ insights.py                   # P0.6 LLM åˆ†æ API
â”‚   â””â”€â”€ chart.py                      # P0.7 å›¾è¡¨ç”Ÿæˆ API
â”‚
â”œâ”€â”€ services/                         # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ excel/                        # P0.1 æ•°æ®è§£æ
â”‚   â”‚   â”œâ”€â”€ parser.py                 # æ ¸å¿ƒè§£æé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ header_detector.py        # å¤šå±‚è¡¨å¤´æ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ direction_detector.py     # æ•°æ®æ–¹å‘æ£€æµ‹
â”‚   â”‚   â””â”€â”€ transformer.py            # æ•°æ®è½¬ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ field/                        # P0.2 å­—æ®µè¯†åˆ«
â”‚   â”‚   â”œâ”€â”€ type_detector.py          # å­—æ®µç±»å‹æ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ llm_mapper.py             # LLM å­—æ®µæ˜ å°„
â”‚   â”‚   â”œâ”€â”€ role_analyzer.py          # å­—æ®µè§’è‰²åˆ†æ
â”‚   â”‚   â””â”€â”€ chart_axis_recommender.py # å›¾è¡¨è½´æ¨è
â”‚   â”‚
â”‚   â”œâ”€â”€ metric/                       # P0.3 æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ calculator.py             # æŒ‡æ ‡è®¡ç®—å¼•æ“
â”‚   â”‚   â”œâ”€â”€ aggregator.py             # åˆ†ç»„èšåˆ
â”‚   â”‚   â””â”€â”€ alert_checker.py          # é¢„è­¦åˆ¤æ–­
â”‚   â”‚
â”‚   â”œâ”€â”€ analysis/                     # P0.4 åˆ†ææœåŠ¡
â”‚   â”‚   â”œâ”€â”€ sales_analysis.py         # é”€å”®åˆ†æ
â”‚   â”‚   â”œâ”€â”€ finance_analysis.py       # è´¢åŠ¡åˆ†æ
â”‚   â”‚   â”œâ”€â”€ department_analysis.py    # éƒ¨é—¨åˆ†æ
â”‚   â”‚   â””â”€â”€ region_analysis.py        # åŒºåŸŸåˆ†æ
â”‚   â”‚
â”‚   â”œâ”€â”€ forecast/                     # P0.5 é¢„æµ‹æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ moving_average.py         # ç§»åŠ¨å¹³å‡
â”‚   â”‚   â”œâ”€â”€ exponential_smoothing.py  # æŒ‡æ•°å¹³æ»‘
â”‚   â”‚   â”œâ”€â”€ linear_trend.py           # çº¿æ€§è¶‹åŠ¿
â”‚   â”‚   â””â”€â”€ prophet_wrapper.py        # Prophet å°è£…
â”‚   â”‚
â”‚   â”œâ”€â”€ insight/                      # P0.6 LLM åˆ†æ
â”‚   â”‚   â”œâ”€â”€ prompt_builder.py         # Prompt æ„å»º
â”‚   â”‚   â”œâ”€â”€ llm_client.py             # LLM API å°è£…
â”‚   â”‚   â””â”€â”€ insight_generator.py      # æ´å¯Ÿç”Ÿæˆ
â”‚   â”‚
â”‚   â””â”€â”€ chart/                        # P0.7 å›¾è¡¨ç”Ÿæˆ
â”‚       â”œâ”€â”€ feature_extractor.py      # æ•°æ®ç‰¹å¾æå–
â”‚       â”œâ”€â”€ chart_recommender.py      # å›¾è¡¨ç±»å‹æ¨è
â”‚       â””â”€â”€ echarts_builder.py        # ECharts é…ç½®ç”Ÿæˆ
â”‚
â”œâ”€â”€ models/                           # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ excel_models.py               # Excel ç›¸å…³
â”‚   â”œâ”€â”€ field_models.py               # å­—æ®µæ˜ å°„ç›¸å…³
â”‚   â”œâ”€â”€ metric_models.py              # æŒ‡æ ‡ç›¸å…³
â”‚   â”œâ”€â”€ analysis_models.py            # åˆ†æç›¸å…³
â”‚   â”œâ”€â”€ forecast_models.py            # é¢„æµ‹ç›¸å…³
â”‚   â””â”€â”€ chart_models.py               # å›¾è¡¨ç›¸å…³
â”‚
â””â”€â”€ utils/                            # å·¥å…·å‡½æ•°
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ date_utils.py                 # æ—¥æœŸå¤„ç†
    â”œâ”€â”€ number_utils.py               # æ•°å€¼æ ¼å¼åŒ–
    â””â”€â”€ cache.py                      # ç®€å•ç¼“å­˜
```

### 5.3 API ç«¯ç‚¹è¯¦ç»†è®¾è®¡ (P0)

#### P0.1 æ•°æ®è§£æ API

```
POST /api/excel/parse
- è¾“å…¥: Excel æ–‡ä»¶ (multipart/form-data)
- è¾“å‡º: {
    headers: [[...], [...]], // å¤šå±‚è¡¨å¤´
    rows: [...],
    dataDirection: 'horizontal' | 'vertical',
    fieldFeatures: [{name, type, uniqueCount, sampleValues}]
  }

POST /api/excel/transform
- è¾“å…¥: { data: [...], transformType: 'wide_to_long' | 'long_to_wide', config: {...} }
- è¾“å‡º: { transformed: [...] }
```

#### P0.2 å­—æ®µè¯†åˆ« API

```
POST /api/field/detect-types
- è¾“å…¥: { columns: [{name, values}] }
- è¾“å‡º: { results: [{name, type, format, confidence}] }

POST /api/field/map-with-llm
- è¾“å…¥: { headers: [...], sampleRows: [...], context: 'é”€å”®æ•°æ®' }
- è¾“å‡º: { mappings: [{original, standard, alias, role, chartAxis, confidence}] }

POST /api/field/recommend-chart-config
- è¾“å…¥: { mappings: [...] }
- è¾“å‡º: { xAxisField, seriesField, yAxisFields, chartType }
```

#### P0.3 æ•°æ®å¤„ç† API

```
POST /api/metrics/calculate
- è¾“å…¥: { data: [...], metrics: ['sales_amount', 'order_count'], fieldMappings: {...} }
- è¾“å‡º: { results: [{metricCode, value, formattedValue, alertLevel}] }

POST /api/metrics/calculate-by-dimension
- è¾“å…¥: { data: [...], dimensionField: 'salesperson', metrics: [...] }
- è¾“å‡º: { groups: { 'å¼ ä¸‰': [...], 'æå››': [...] } }

POST /api/metrics/trend
- è¾“å…¥: { currentValue: 100, previousValue: 80 }
- è¾“å‡º: { change: 20, changePercent: 25, direction: 'UP' }
```

#### P0.4 åˆ†ææœåŠ¡ API

```
POST /api/analysis/sales
- è¾“å…¥: { data: [...], dimensions: ['date', 'salesperson'], period: '2025-01' }
- è¾“å‡º: { kpis: {...}, trends: [...], rankings: [...], topProducts: [...] }

POST /api/analysis/finance
- è¾“å…¥: { data: [...], metrics: ['gross_profit', 'net_margin'] }
- è¾“å‡º: { profitAnalysis: {...}, costBreakdown: {...}, budgetComparison: {...} }
```

#### P0.5 é¢„æµ‹æœåŠ¡ API

```
POST /api/forecast/predict
- è¾“å…¥: { data: [{date, value}], algorithm: 'auto' | 'prophet' | 'ma', periods: 30 }
- è¾“å‡º: { forecast: [{date, value, lower, upper}], algorithm: 'prophet', confidence: 85 }

POST /api/forecast/auto-select
- è¾“å…¥: { data: [...] }
- è¾“å‡º: { algorithm: 'prophet', reason: 'æ•°æ®æœ‰æ˜æ˜¾å­£èŠ‚æ€§ç‰¹å¾' }
```

#### P0.6 LLM åˆ†æ API

```
POST /api/insight/generate
- è¾“å…¥: { analysisResult: {...}, context: 'é”€å”®åˆ†æ', language: 'zh' }
- è¾“å‡º: { summary: '...', keyFindings: [...], recommendations: [...] }

POST /api/insight/explain-metric
- è¾“å…¥: { metricName: 'æ¯›åˆ©ç‡ä¸‹é™', value: -5.2, context: {...} }
- è¾“å‡º: { explanation: '...', possibleCauses: [...], suggestedActions: [...] }
```

#### P0.7 å›¾è¡¨ç”Ÿæˆ API

```
POST /api/chart/recommend
- è¾“å…¥: { dataFeatures: {...} }
- è¾“å‡º: { chartType: 'line', reason: 'æ—¶é—´åºåˆ—æ•°æ®é€‚åˆæŠ˜çº¿å›¾' }

POST /api/chart/build-config
- è¾“å…¥: { data: [...], chartType: 'bar', xField: 'date', yFields: ['sales'] }
- è¾“å‡º: { echartOptions: {...} } // å®Œæ•´ ECharts é…ç½®
```

### 5.4 Java Fallback æœºåˆ¶è®¾è®¡

```java
// PythonSmartBIClient.java
@Service
@Slf4j
public class PythonSmartBIClient {

    @Value("${python-smartbi.enabled:true}")
    private boolean enabled;

    @Value("${python-smartbi.url:http://localhost:8081}")
    private String baseUrl;

    @Value("${python-smartbi.timeout:30000}")
    private int timeout;

    @Value("${python-smartbi.fallback-on-error:true}")
    private boolean fallbackOnError;

    // åŸæœ‰ Java æœåŠ¡ (ä½œä¸º Fallback)
    @Autowired
    private ExcelDynamicParserService javaExcelParser;
    @Autowired
    private MetricCalculatorService javaMetricCalculator;
    @Autowired
    private ForecastService javaForecastService;

    private final RestTemplate restTemplate;

    // ==================== Excel è§£æ ====================

    public ExcelParseResult parseExcel(MultipartFile file) {
        if (!enabled) {
            log.info("[SmartBI] Python æœåŠ¡å·²ç¦ç”¨ï¼Œä½¿ç”¨ Java å®ç°");
            return javaExcelParser.parse(file);
        }

        try {
            // è°ƒç”¨ Python æœåŠ¡
            HttpHeaders headers = new HttpHeaders();
            headers.setContentType(MediaType.MULTIPART_FORM_DATA);

            MultiValueMap<String, Object> body = new LinkedMultiValueMap<>();
            body.add("file", new ByteArrayResource(file.getBytes()) {
                @Override
                public String getFilename() {
                    return file.getOriginalFilename();
                }
            });

            HttpEntity<MultiValueMap<String, Object>> requestEntity = new HttpEntity<>(body, headers);

            ResponseEntity<ExcelParseResult> response = restTemplate.exchange(
                baseUrl + "/api/excel/parse",
                HttpMethod.POST,
                requestEntity,
                ExcelParseResult.class
            );

            log.info("[SmartBI] Python Excel è§£ææˆåŠŸ");
            return response.getBody();

        } catch (Exception e) {
            log.warn("[SmartBI] Python Excel è§£æå¤±è´¥: {}", e.getMessage());

            if (fallbackOnError) {
                log.info("[SmartBI] Fallback åˆ° Java å®ç°");
                return javaExcelParser.parse(file);
            }
            throw new SmartBIException("Excel è§£ææœåŠ¡ä¸å¯ç”¨", e);
        }
    }

    // ==================== æŒ‡æ ‡è®¡ç®— ====================

    public List<MetricResult> calculateMetrics(List<Map<String, Object>> data,
                                               List<String> metrics,
                                               Map<String, String> fieldMappings) {
        if (!enabled) {
            return javaMetricCalculator.calculateAllMetrics(data, fieldMappings);
        }

        try {
            MetricCalculateRequest request = new MetricCalculateRequest();
            request.setData(data);
            request.setMetrics(metrics);
            request.setFieldMappings(fieldMappings);

            ResponseEntity<MetricCalculateResponse> response = restTemplate.postForEntity(
                baseUrl + "/api/metrics/calculate",
                request,
                MetricCalculateResponse.class
            );

            return response.getBody().getResults();

        } catch (Exception e) {
            log.warn("[SmartBI] Python æŒ‡æ ‡è®¡ç®—å¤±è´¥: {}, fallback", e.getMessage());
            return javaMetricCalculator.calculateAllMetrics(data, fieldMappings);
        }
    }

    // ==================== é¢„æµ‹æœåŠ¡ ====================

    public ForecastResult forecast(List<DataPoint> data, String algorithm, int periods) {
        if (!enabled) {
            return javaForecastService.forecastMetric(...);
        }

        try {
            ForecastRequest request = ForecastRequest.builder()
                .data(data)
                .algorithm(algorithm)
                .periods(periods)
                .build();

            ResponseEntity<ForecastResult> response = restTemplate.postForEntity(
                baseUrl + "/api/forecast/predict",
                request,
                ForecastResult.class
            );

            return response.getBody();

        } catch (Exception e) {
            log.warn("[SmartBI] Python é¢„æµ‹å¤±è´¥: {}, fallback", e.getMessage());
            return javaForecastService.forecastMetric(...);
        }
    }

    // ==================== å¥åº·æ£€æŸ¥ ====================

    public boolean isAvailable() {
        if (!enabled) return false;

        try {
            ResponseEntity<Map> response = restTemplate.getForEntity(
                baseUrl + "/health",
                Map.class
            );
            return response.getStatusCode().is2xxSuccessful();
        } catch (Exception e) {
            return false;
        }
    }
}
```

### 5.5 é…ç½®è®¾è®¡

```yaml
# application.yml
python-smartbi:
  enabled: true                    # æ€»å¼€å…³
  url: http://localhost:8081       # Python æœåŠ¡åœ°å€
  timeout: 30000                   # è¶…æ—¶æ—¶é—´ (ms)
  fallback-on-error: true          # é”™è¯¯æ—¶æ˜¯å¦ fallback åˆ° Java

  # å„æ¨¡å—ç‹¬ç«‹å¼€å…³ (å¯é€‰)
  modules:
    excel-parser: true             # Excel è§£æ
    field-mapping: true            # å­—æ®µæ˜ å°„
    metric-calculator: true        # æŒ‡æ ‡è®¡ç®—
    forecast: true                 # é¢„æµ‹æœåŠ¡
    llm-insight: true              # LLM æ´å¯Ÿ
    chart-builder: true            # å›¾è¡¨ç”Ÿæˆ
```
å…­ã€API è®¾è®¡
6.1 Excel å¤„ç† API

POST /api/excel/parse
- è¾“å…¥: Excel æ–‡ä»¶ (multipart/form-data)
- è¾“å‡º: æ ‡å‡†åŒ– JSON (headers, rows, fieldMappings)

POST /api/excel/preview
- è¾“å…¥: Excel æ–‡ä»¶ + max_rows
- è¾“å‡º: é¢„è§ˆæ•°æ®
6.2 é¢„æµ‹ API

POST /api/forecast/predict
- è¾“å…¥: { "data": [...], "algorithm": "prophet", "periods": 12 }
- è¾“å‡º: { "forecast": [...], "confidence_interval": {...} }

POST /api/forecast/auto-select
- è¾“å…¥: { "data": [...] }
- è¾“å‡º: { "recommended_algorithm": "prophet", "reason": "..." }
6.3 æŒ‡æ ‡è®¡ç®— API

POST /api/metrics/calculate
- è¾“å…¥: { "metric_type": "sales", "data": [...], "dimensions": ["region", "product"] }
- è¾“å‡º: { "results": [...], "aggregations": {...} }

POST /api/metrics/batch
- è¾“å…¥: { "metrics": ["sales", "cost", "profit"], "data": [...] }
- è¾“å‡º: { "results": { "sales": {...}, "cost": {...}, "profit": {...} } }
6.4 ML ç®—æ³• API

POST /api/ml/linucb/recommend
- è¾“å…¥: { "context": [...], "arms": [...], "history": [...] }
- è¾“å‡º: { "recommended_arm": 0, "ucb_values": [...] }

POST /api/ml/features/extract
- è¾“å…¥: { "task": {...}, "worker": {...} }
- è¾“å‡º: { "features": [...] }
6.5 åˆ†æ API

POST /api/analysis/sales
- è¾“å…¥: { "factory_id": "F001", "period": "2025-01", "dimensions": [...] }
- è¾“å‡º: { "kpis": {...}, "trends": [...], "rankings": [...] }

POST /api/analysis/inventory-health
- è¾“å…¥: { "factory_id": "F001", "items": [...] }
- è¾“å‡º: { "scores": {...}, "alerts": [...], "recommendations": [...] }
ä¸ƒã€Java é›†æˆæ–¹æ¡ˆ
ä¿®æ”¹çš„ Java æ–‡ä»¶
æ–‡ä»¶	ä¿®æ”¹å†…å®¹
application.yml	æ·»åŠ  Python æœåŠ¡ URL é…ç½®
SmartBIUploadFlowServiceImpl.java	è°ƒç”¨ Python Excel æœåŠ¡
ForecastServiceImpl.java	è°ƒç”¨ Python é¢„æµ‹æœåŠ¡
MetricCalculatorServiceImpl.java	è°ƒç”¨ Python æŒ‡æ ‡è®¡ç®—
LinUCBServiceImpl.java	è°ƒç”¨ Python LinUCB
é…ç½®ç¤ºä¾‹

# application.yml
python-analytics:
  url: http://localhost:8081
  enabled: true
  timeout: 30000
  endpoints:
    excel-parse: /api/excel/parse
    forecast: /api/forecast/predict
    metrics: /api/metrics/calculate
    linucb: /api/ml/linucb/recommend
è°ƒç”¨ç¤ºä¾‹

@Service
public class PythonAnalyticsClient {

    @Value("${python-analytics.url}")
    private String pythonServiceUrl;

    private final RestTemplate restTemplate;

    public <T> T callPythonService(String endpoint, Object request, Class<T> responseType) {
        try {
            ResponseEntity<T> response = restTemplate.postForEntity(
                pythonServiceUrl + endpoint,
                request,
                responseType
            );
            return response.getBody();
        } catch (Exception e) {
            log.warn("Python æœåŠ¡è°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨ Java fallback: {}", e.getMessage());
            return null; // è§¦å‘ fallback
        }
    }
}
å…«ã€P0 è¯¦ç»†å®æ–½è®¡åˆ’

### Phase 1: é¡¹ç›®æ­å»º + Excel è§£æ (1-2 å¤©)

#### Day 1 ä¸Šåˆ: é¡¹ç›®åˆå§‹åŒ–
```bash
# 1. åˆ›å»ºé¡¹ç›®ç»“æ„
mkdir -p smartbi-python-service/{api,services/{excel,field,metric,analysis,forecast,insight,chart},models,utils}

# 2. åˆå§‹åŒ– Python ç¯å¢ƒ
cd smartbi-python-service
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install fastapi uvicorn pandas openpyxl python-multipart pydantic
```

#### Day 1 ä¸‹åˆ: Excel è§£ææ ¸å¿ƒ
- [ ] `main.py` - FastAPI å…¥å£ + å¥åº·æ£€æŸ¥
- [ ] `services/excel/parser.py` - æ ¸å¿ƒè§£æé€»è¾‘
- [ ] `services/excel/header_detector.py` - å¤šå±‚è¡¨å¤´æ£€æµ‹
- [ ] `api/excel.py` - Excel API è·¯ç”±

#### Day 2 ä¸Šåˆ: Excel é«˜çº§åŠŸèƒ½
- [ ] `services/excel/direction_detector.py` - æ•°æ®æ–¹å‘æ£€æµ‹
- [ ] `services/excel/transformer.py` - æ•°æ®è½¬ç½® (å®½â†’é•¿)
- [ ] `models/excel_models.py` - è¯·æ±‚/å“åº”æ¨¡å‹

#### Day 2 ä¸‹åˆ: æµ‹è¯• + Java é›†æˆ
- [ ] å•å…ƒæµ‹è¯• (å¤šå±‚è¡¨å¤´ã€æ•°æ®è½¬ç½®)
- [ ] `PythonSmartBIClient.java` - Java å®¢æˆ·ç«¯
- [ ] `SmartBIUploadFlowServiceImpl.java` ä¿®æ”¹ - è°ƒç”¨ Python

### Phase 2: å­—æ®µè¯†åˆ« + æŒ‡æ ‡è®¡ç®— (2-3 å¤©)

#### Day 3: å­—æ®µè¯†åˆ«
- [ ] `services/field/type_detector.py` - å­—æ®µç±»å‹æ£€æµ‹
- [ ] `services/field/llm_mapper.py` - LLM å­—æ®µæ˜ å°„
- [ ] `services/field/role_analyzer.py` - å­—æ®µè§’è‰²åˆ†æ
- [ ] `api/field_mapping.py` - å­—æ®µ API

#### Day 4: æŒ‡æ ‡è®¡ç®—
- [ ] `services/metric/calculator.py` - 30+ æŒ‡æ ‡å®ç°
- [ ] `services/metric/aggregator.py` - åˆ†ç»„èšåˆ
- [ ] `services/metric/alert_checker.py` - é¢„è­¦åˆ¤æ–­
- [ ] `api/metrics.py` - æŒ‡æ ‡ API

#### Day 5: æµ‹è¯• + é›†æˆ
- [ ] æŒ‡æ ‡è®¡ç®—å•å…ƒæµ‹è¯•
- [ ] Java `MetricCalculatorServiceImpl` é›†æˆ
- [ ] Fallback æœºåˆ¶æµ‹è¯•

### Phase 3: é¢„æµ‹ + åˆ†ææœåŠ¡ (3-4 å¤©)

#### Day 6: é¢„æµ‹æœåŠ¡
- [ ] å®‰è£… `statsmodels`, `prophet`
- [ ] `services/forecast/moving_average.py`
- [ ] `services/forecast/exponential_smoothing.py`
- [ ] `services/forecast/prophet_wrapper.py`
- [ ] `api/forecast.py`

#### Day 7-8: åˆ†ææœåŠ¡
- [ ] `services/analysis/sales_analysis.py`
- [ ] `services/analysis/finance_analysis.py`
- [ ] `services/analysis/department_analysis.py`
- [ ] `api/analysis.py`

#### Day 9: é›†æˆæµ‹è¯•
- [ ] Java `ForecastServiceImpl` é›†æˆ
- [ ] Java `SalesAnalysisServiceImpl` é›†æˆ
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•

### Phase 4: LLM æ´å¯Ÿ + å›¾è¡¨ç”Ÿæˆ (2-3 å¤©)

#### Day 10: LLM æ´å¯Ÿ
- [ ] å®‰è£… `dashscope`
- [ ] `services/insight/llm_client.py` - LLM API å°è£…
- [ ] `services/insight/prompt_builder.py` - Prompt æ¨¡æ¿
- [ ] `services/insight/insight_generator.py` - æ´å¯Ÿç”Ÿæˆ
- [ ] `api/insights.py`

#### Day 11: å›¾è¡¨ç”Ÿæˆ
- [ ] `services/chart/feature_extractor.py` - æ•°æ®ç‰¹å¾
- [ ] `services/chart/chart_recommender.py` - å›¾è¡¨æ¨è
- [ ] `services/chart/echarts_builder.py` - é…ç½®ç”Ÿæˆ
- [ ] `api/chart.py`

#### Day 12: æœ€ç»ˆé›†æˆ
- [ ] Java ç«¯å®Œæ•´é›†æˆ
- [ ] æ‰€æœ‰ Fallback æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

### Phase 5: éƒ¨ç½² + éªŒè¯ (1-2 å¤©)

#### Day 13: éƒ¨ç½²
- [ ] `Dockerfile` ç¼–å†™
- [ ] `docker-compose.yml`
- [ ] æœåŠ¡å™¨éƒ¨ç½² (139.196.165.140:8081)
- [ ] systemd æœåŠ¡é…ç½®

#### Day 14: éªŒè¯
- [ ] ç”Ÿäº§ç¯å¢ƒéªŒè¯
- [ ] ç›‘æ§é…ç½®
- [ ] æ–‡æ¡£æ›´æ–°

---

## ä¹ã€P0 éªŒè¯æ£€æŸ¥æ¸…å•

### 9.1 Excel è§£æéªŒè¯

| æµ‹è¯•åœºæ™¯ | æµ‹è¯•æ–‡ä»¶ | é¢„æœŸç»“æœ | çŠ¶æ€ |
|---------|---------|---------|------|
| å•å±‚è¡¨å¤´ | simple.xlsx | æ­£ç¡®è§£æ | [ ] |
| åŒå±‚è¡¨å¤´ | header_2level.xlsx | è‡ªåŠ¨åˆå¹¶ | [ ] |
| ä¸‰å±‚è¡¨å¤´ | header_3level.xlsx | è‡ªåŠ¨åˆå¹¶ | [ ] |
| æ¨ªå‘æ•°æ® | horizontal.xlsx | æ£€æµ‹æ–¹å‘å¹¶è½¬ç½® | [ ] |
| çºµå‘æ•°æ® | vertical.xlsx | ç›´æ¥è§£æ | [ ] |
| åˆå¹¶å•å…ƒæ ¼ | merged_cells.xlsx | æ­£ç¡®å±•å¼€ | [ ] |
| æ•°å€¼å…¨ä¸º 0 é—®é¢˜ | old_problem.xlsx | æ•°å€¼æ­£ç¡® | [ ] |

### 9.2 å­—æ®µè¯†åˆ«éªŒè¯

| æµ‹è¯•åœºæ™¯ | è¾“å…¥ | é¢„æœŸè¾“å‡º | çŠ¶æ€ |
|---------|------|---------|------|
| æ—¥æœŸæ£€æµ‹ | "2025-01-01" | type=DATE | [ ] |
| é‡‘é¢æ£€æµ‹ | "1,234.56" | type=AMOUNT | [ ] |
| ç™¾åˆ†æ¯”æ£€æµ‹ | "85.5%" | type=PERCENTAGE | [ ] |
| LLM æ˜ å°„ | "é”€å”®é‡‘é¢" | standard=sales_amount | [ ] |
| å›¾è¡¨è½´æ¨è | æ—¥æœŸå­—æ®µ | chartAxis=X_AXIS | [ ] |

### 9.3 æŒ‡æ ‡è®¡ç®—éªŒè¯

| æŒ‡æ ‡ | å…¬å¼ | æµ‹è¯•æ•°æ® | é¢„æœŸç»“æœ | çŠ¶æ€ |
|------|------|---------|---------|------|
| é”€å”®é¢ | SUM(amount) | [100, 200, 300] | 600 | [ ] |
| è®¢å•æ•° | COUNT(DISTINCT order_id) | 3 ä¸ªè®¢å• | 3 | [ ] |
| å®¢å•ä»· | é”€å”®é¢/è®¢å•æ•° | 600/3 | 200 | [ ] |
| ç¯æ¯”å¢é•¿ | (æœ¬æœŸ-ä¸ŠæœŸ)/ä¸ŠæœŸ | 120 vs 100 | 20% | [ ] |
| ç›®æ ‡å®Œæˆç‡ | å®é™…/ç›®æ ‡ | 85/100 | 85% | [ ] |

### 9.4 é¢„æµ‹éªŒè¯

| ç®—æ³• | è¾“å…¥æ•°æ® | é¢„æµ‹å¤©æ•° | éªŒè¯ç‚¹ | çŠ¶æ€ |
|------|---------|---------|-------|------|
| ç§»åŠ¨å¹³å‡ | 30 å¤©é”€å”® | 7 | è¶‹åŠ¿åˆç† | [ ] |
| æŒ‡æ•°å¹³æ»‘ | 30 å¤©é”€å”® | 7 | è¶‹åŠ¿åˆç† | [ ] |
| Prophet | 90 å¤©é”€å”® | 30 | ç½®ä¿¡åŒºé—´åˆç† | [ ] |

### 9.5 Fallback æœºåˆ¶éªŒè¯

| åœºæ™¯ | æ“ä½œ | é¢„æœŸè¡Œä¸º | çŠ¶æ€ |
|------|------|---------|------|
| Python æœåŠ¡æ­£å¸¸ | æ­£å¸¸è¯·æ±‚ | ä½¿ç”¨ Python ç»“æœ | [ ] |
| Python æœåŠ¡è¶…æ—¶ | è®¾ç½® 1ms è¶…æ—¶ | Fallback åˆ° Java | [ ] |
| Python æœåŠ¡å®•æœº | åœæ­¢ Python | Fallback åˆ° Java | [ ] |
| é…ç½®ç¦ç”¨ Python | enabled=false | ç›´æ¥ä½¿ç”¨ Java | [ ] |
| éƒ¨åˆ†æ¨¡å—ç¦ç”¨ | modules.excel=false | è¯¥æ¨¡å—ç”¨ Java | [ ] |

### 9.6 æ€§èƒ½éªŒè¯

| åœºæ™¯ | æ•°æ®é‡ | Python è€—æ—¶ | Java è€—æ—¶ | ç›®æ ‡ |
|------|-------|-----------|----------|------|
| Excel è§£æ | 1000 è¡Œ | < 2s | ~5s | Python æ›´å¿« |
| æŒ‡æ ‡è®¡ç®— | 10000 è¡Œ | < 1s | ~3s | Python æ›´å¿« |
| é¢„æµ‹ (Prophet) | 365 å¤© | < 5s | N/A | å¯ç”¨ |

---

## åã€ä¾èµ–æ¸…å• (æ›´æ–°)
## åä¸€ã€ä¾èµ–æ¸…å• (P0 å®Œæ•´ç‰ˆ)

```txt
# requirements.txt - SmartBI Python Service

# === æ ¸å¿ƒæ¡†æ¶ ===
fastapi==0.109.0
uvicorn==0.27.0
pydantic==2.5.3
python-multipart==0.0.6      # æ–‡ä»¶ä¸Šä¼ 

# === æ•°æ®å¤„ç† (P0.1-P0.3) ===
pandas==2.1.4
numpy==1.26.3
openpyxl==3.1.2              # Excel è¯»å–

# === ç»Ÿè®¡ä¸é¢„æµ‹ (P0.5) ===
statsmodels==0.14.1          # æŒ‡æ•°å¹³æ»‘ã€ARIMA
scipy==1.12.0                # ç»Ÿè®¡è®¡ç®—
prophet==1.1.5               # é«˜çº§æ—¶é—´åºåˆ—é¢„æµ‹

# === LLM é›†æˆ (P0.2, P0.6) ===
dashscope==1.14.0            # é˜¿é‡Œäº‘ LLM API
httpx==0.26.0                # HTTP å®¢æˆ·ç«¯

# === å¯é€‰ä¾èµ– ===
# scikit-learn==1.4.0        # ML ç®—æ³• (P1)
# redis==5.0.1               # ç¼“å­˜ (å¯é€‰)
```

### ä¾èµ–è¯´æ˜

| ä¾èµ– | ç”¨é€” | P0 æ¨¡å— | æ˜¯å¦å¿…éœ€ |
|------|------|--------|---------|
| pandas | æ•°æ®å¤„ç†æ ¸å¿ƒ | P0.1-P0.4 | âœ… å¿…éœ€ |
| openpyxl | Excel è§£æ | P0.1 | âœ… å¿…éœ€ |
| statsmodels | é¢„æµ‹ç®—æ³• | P0.5 | âœ… å¿…éœ€ |
| prophet | é«˜çº§é¢„æµ‹ | P0.5 | âš ï¸ å¯é€‰ |
| dashscope | LLM API | P0.2, P0.6 | âœ… å¿…éœ€ |
| scipy | ç»Ÿè®¡è®¡ç®— | P0.3, P0.5 | âœ… å¿…éœ€ |
åã€éªŒè¯æ£€æŸ¥æ¸…å•
Excel è§£æ
 å•å±‚è¡¨å¤´ Excel æ­£å¸¸è§£æ
 å¤šå±‚è¡¨å¤´ Excel æ­£å¸¸è§£æ
 æ•°å€¼å­—æ®µä¸å†æ˜¯ 0
 å­—æ®µæ˜ å°„æ­£ç¡®
é¢„æµ‹æœåŠ¡
 ç§»åŠ¨å¹³å‡æ­£ç¡®
 Prophet é¢„æµ‹æ­£ç¡®
 ç½®ä¿¡åŒºé—´æ­£ç¡®
é›†æˆéªŒè¯
 Java åç«¯èƒ½è°ƒç”¨ Python æœåŠ¡
 Python æœåŠ¡ä¸å¯ç”¨æ—¶ fallback æ­£å¸¸
 æ•°æ®æ­£ç¡®å­˜å…¥æ•°æ®åº“
éƒ¨ç½²éªŒè¯
 Docker è¿è¡Œæ­£å¸¸
 æœåŠ¡å™¨ç«¯å£ 8081 å¯è®¿é—®
 æ—¥å¿—æ­£å¸¸è®°å½•
åä¸€ã€é£é™©ä¸ç¼“è§£
é£é™©	ç¼“è§£æªæ–½
Python æœåŠ¡ä¸å¯ç”¨	ä¿ç•™ Java fallback
æ€§èƒ½é—®é¢˜	æ·»åŠ ç¼“å­˜ã€å¼‚æ­¥å¤„ç†
éƒ¨ç½²å¤æ‚åº¦å¢åŠ 	ä½¿ç”¨ Docker ç®€åŒ–
æ•°æ®æ ¼å¼ä¸å…¼å®¹	ç»Ÿä¸€ JSON schema
åäºŒã€Python å¯¹ ML/ç®—æ³•çš„ä¼˜åŠ¿è¯¦è§£
11.1 å½“å‰ Java å®ç°çš„å¤æ‚åº¦
åŠŸèƒ½	Java ä»£ç è¡Œæ•°	é—®é¢˜
LinUCB çŸ©é˜µè¿ç®—	120+ è¡Œ	æ‰‹å†™ dotProduct, outerProduct, matrixAdd, invertMatrix
é«˜æ–¯-çº¦æ—¦æ¶ˆå…ƒ	60 è¡Œ	æ•°å€¼ç¨³å®šæ€§å·®ï¼Œéœ€è‡ªå·±å¤„ç†å¥‡å¼‚çŸ©é˜µ
ç‰¹å¾å·¥ç¨‹	767 è¡Œ	å¤§é‡å†—ä½™ä»£ç 
é¢„æµ‹ç®—æ³•	200+ è¡Œ	ç§»åŠ¨å¹³å‡ã€æŒ‡æ•°å¹³æ»‘éœ€æ‰‹åŠ¨å®ç°
11.2 Python çš„ç®€åŒ–æ•ˆæœ

# LinUCB æ ¸å¿ƒè®¡ç®— (Java 120è¡Œ â†’ Python 5è¡Œ)
import numpy as np

A_inv = np.linalg.inv(A)           # çŸ©é˜µæ±‚é€†
theta = A_inv @ b                   # å‚æ•°å‘é‡
expected = context @ theta          # æœŸæœ›å¥–åŠ±
confidence = np.sqrt(context @ A_inv @ context)  # ç½®ä¿¡å®½åº¦
ucb = expected + alpha * confidence # UCB å€¼

# é¢„æµ‹ (Java 200è¡Œ â†’ Python 10è¡Œ)
from statsmodels.tsa.holtwinters import ExponentialSmoothing
model = ExponentialSmoothing(data, trend='add', seasonal='add')
forecast = model.fit().forecast(12)
11.3 Python ç¡®å®æ›´å¥½çš„åŸå› 
æ–¹é¢	Java	Python	ä¼˜åŠ¿
çŸ©é˜µè¿ç®—	æ‰‹åŠ¨å®ç°ï¼Œæ•ˆç‡ä½	NumPy Cåº•å±‚ï¼Œé«˜æ•ˆ	æ€§èƒ½ 10x+
ç®—æ³•åº“	éœ€å¼•å…¥ç¬¬ä¸‰æ–¹	sklearn/scipy åŸç”Ÿ	ç”Ÿæ€å®Œæ•´
æ•°å€¼ç¨³å®šæ€§	è‡ªå·±å¤„ç†è¾¹ç•Œ	åº“å·²ä¼˜åŒ–	æ›´å¯é 
å¼€å‘æ•ˆç‡	100è¡Œ=10è¡Œ	ä»£ç ç®€æ´	10x å¼€å‘æ•ˆç‡
ç®—æ³•æ›´æ–°	æ”¹å¤šå¤„ä»£ç 	æ¢ä¸ªåº“/å‚æ•°	æ˜“äºè¿­ä»£
åä¸‰ã€æœåŠ¡æ¶æ„ä¸ç»´æŠ¤ç­–ç•¥
12.1 Python æœåŠ¡å®šä½
ä½œä¸ºç‹¬ç«‹å¾®æœåŠ¡ï¼Œä¸æ˜¯æ¨¡å—åµŒå…¥


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Java Backend (:10010)                     â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Business Logic Layer (ä¿ç•™åœ¨ Java)                  â”‚    â”‚
â”‚   â”‚ - Controller (API å…¥å£)                             â”‚    â”‚
â”‚   â”‚ - æƒé™éªŒè¯ã€äº‹åŠ¡ç®¡ç†                                â”‚    â”‚
â”‚   â”‚ - æ•°æ®åº“ CRUD (JPA)                                â”‚    â”‚
â”‚   â”‚ - ç¼“å­˜ç®¡ç† (Redis)                                 â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                    â”‚
â”‚                         â”‚ HTTP/JSON                          â”‚
â”‚                         â–¼                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Python Client (Java ä¸­çš„é€‚é…å±‚)                     â”‚    â”‚
â”‚   â”‚ - PythonAnalyticsClient.java (100è¡Œ)               â”‚    â”‚
â”‚   â”‚ - è°ƒç”¨ Python æœåŠ¡ï¼Œå¤„ç†å“åº”                        â”‚    â”‚
â”‚   â”‚ - Fallback åˆ° Java åŸæœ‰å®ç°                        â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/JSON (å†…ç½‘)
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Python Analytics Service (:8081)               â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ Excel å¤„ç†æ¨¡å—   â”‚  â”‚ é¢„æµ‹/ç»Ÿè®¡æ¨¡å—     â”‚                â”‚
â”‚   â”‚ - å¤šå±‚è¡¨å¤´è§£æ   â”‚  â”‚ - æ—¶é—´åºåˆ—é¢„æµ‹   â”‚                â”‚
â”‚   â”‚ - æ•°æ®è½¬æ¢      â”‚  â”‚ - æŒ‡æ ‡è®¡ç®—       â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ ML ç®—æ³•æ¨¡å—      â”‚  â”‚ åˆ†ææœåŠ¡æ¨¡å—     â”‚                â”‚
â”‚   â”‚ - LinUCB         â”‚  â”‚ - é”€å”®åˆ†æ       â”‚                â”‚
â”‚   â”‚ - ç‰¹å¾å·¥ç¨‹       â”‚  â”‚ - è´¢åŠ¡åˆ†æ       â”‚                â”‚
â”‚   â”‚ - MAB ç®—æ³•       â”‚  â”‚ - åº“å­˜åˆ†æ       â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
12.2 ç»´æŠ¤ç­–ç•¥
ç‰ˆæœ¬ç®¡ç†

python-analytics-service/
â”œâ”€â”€ VERSION                    # å½“å‰ç‰ˆæœ¬å· (1.0.0)
â”œâ”€â”€ CHANGELOG.md               # å˜æ›´æ—¥å¿—
â”œâ”€â”€ requirements.txt           # é”å®šä¾èµ–ç‰ˆæœ¬
â””â”€â”€ requirements-dev.txt       # å¼€å‘ä¾èµ–
éƒ¨ç½²æ–¹å¼

# docker-compose.yml
services:
  python-analytics:
    image: cretas/python-analytics:1.0.0
    ports:
      - "8081:8081"
    environment:
      - LOG_LEVEL=INFO
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8081/health"]
    restart: unless-stopped
ç›‘æ§ä¸æ—¥å¿—
å¥åº·æ£€æŸ¥: /health ç«¯ç‚¹
æ—¥å¿—: ç»Ÿä¸€è¾“å‡ºåˆ° /var/log/python-analytics/
ç›‘æ§: Prometheus metrics /metrics
æ›´æ–°æµç¨‹

# 1. æœ¬åœ°æµ‹è¯•
pytest tests/

# 2. æ„å»ºæ–°é•œåƒ
docker build -t cretas/python-analytics:1.1.0 .

# 3. æ¨é€åˆ°æœåŠ¡å™¨
docker push cretas/python-analytics:1.1.0

# 4. æœåŠ¡å™¨æ›´æ–° (æ— ç¼åˆ‡æ¢)
docker-compose pull
docker-compose up -d --no-deps python-analytics
12.3 Fallback æœºåˆ¶

// PythonAnalyticsClient.java
@Service
public class PythonAnalyticsClient {

    @Value("${python-analytics.enabled:true}")
    private boolean pythonEnabled;

    @Value("${python-analytics.url}")
    private String pythonUrl;

    public LinUCBResult computeLinUCB(LinUCBRequest request) {
        if (!pythonEnabled) {
            // ç›´æ¥ä½¿ç”¨ Java å®ç°
            return javaLinUCBService.compute(request);
        }

        try {
            // ä¼˜å…ˆä½¿ç”¨ Python
            return callPython("/api/ml/linucb", request, LinUCBResult.class);
        } catch (Exception e) {
            log.warn("Python æœåŠ¡ä¸å¯ç”¨ï¼Œfallback åˆ° Java: {}", e.getMessage());
            // Fallback åˆ° Java
            return javaLinUCBService.compute(request);
        }
    }
}
12.4 æ¸è¿›å¼è¿ç§»ç­–ç•¥
é˜¶æ®µ	çŠ¶æ€	Python è§’è‰²	Java è§’è‰²
Phase 1	å½“å‰	åªå¤„ç† Excel	å…¶ä»–ä¿æŒä¸å˜
Phase 2	éªŒè¯å	+ é¢„æµ‹/æŒ‡æ ‡	ä¿ç•™ fallback
Phase 3	ç¨³å®šå	+ LinUCB/ç‰¹å¾	å‡å°‘ fallback
Phase 4	æˆç†Ÿå	æ‰€æœ‰è®¡ç®—	åªä¿ç•™ API/DB
å…³é”®ç‚¹: æ¯ä¸ªé˜¶æ®µéƒ½ä¿ç•™ Java fallbackï¼Œç¡®ä¿æœåŠ¡å¯ç”¨æ€§

åå››ã€å…³é”®æ–‡ä»¶æ¸…å•
æ–°å»ºæ–‡ä»¶

python-analytics-service/
â”œâ”€â”€ main.py
â”œâ”€â”€ config.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ api/*.py
â”œâ”€â”€ services/*.py
â””â”€â”€ models/*.py
ä¿®æ”¹æ–‡ä»¶

backend-java/
â”œâ”€â”€ src/main/resources/application.yml
â”œâ”€â”€ src/main/java/.../client/PythonAnalyticsClient.java  # æ–°å»º
â”œâ”€â”€ src/main/java/.../service/smartbi/impl/SmartBIUploadFlowServiceImpl.java
â”œâ”€â”€ src/main/java/.../service/smartbi/impl/ForecastServiceImpl.java
â”œâ”€â”€ src/main/java/.../service/smartbi/impl/MetricCalculatorServiceImpl.java
â””â”€â”€ src/main/java/.../service/impl/LinUCBServiceImpl.java
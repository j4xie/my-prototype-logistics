<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>溯源详情 - 食品溯源系统</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="assets/styles.css">
    <script type="module" src="components/trace-ux.js"></script>
    <script type="module" src="components/trace-a11y.js"></script>
    <script>
        // NO VERTICAL SCROLL - Tab标签页切换
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // 移除所有活动状态
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // 添加活动状态
                    button.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // 初始激活第一个标签
            if (tabButtons.length > 0) {
                tabButtons[0].click();
            }
            
            // 图片查看器
            const imageViewLinks = document.querySelectorAll('.image-view-link');
            const imageModal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            const closeModal = document.getElementById('close-image-modal');
            
            imageViewLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const imgSrc = link.getAttribute('data-img');
                    modalImage.src = imgSrc;
                    imageModal.classList.add('show');
                });
            });
            
            if (closeModal) {
                closeModal.addEventListener('click', () => {
                    imageModal.classList.remove('show');
                });
            }
            
            // 点击模态框背景关闭
            imageModal.addEventListener('click', (e) => {
                if (e.target === imageModal) {
                    imageModal.classList.remove('show');
                }
            });
        });
    </script>
</head>
<!-- NO VERTICAL SCROLL - 设置无纵向滚动布局 -->
<body class="bg-[#F7F8FA]">
    <div class="no-scroll-layout">
        <!-- 固定头部导航 -->
        <div class="fixed-header trace-navbar">
            <a href="javascript:history.back()" class="w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fas fa-arrow-left text-[#00467F]"></i>
            </a>
            <div class="trace-navbar-title">溯源详情</div>
            <div class="flex">
                <a href="#" class="w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-share-alt text-[#00467F]"></i>
                </a>
                <a href="#" class="w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-qrcode text-[#00467F]"></i>
                </a>
            </div>
        </div>

        <!-- 主要内容区域 - 标签页容器 -->
        <div class="tabs-container">
            <!-- 产品基本信息卡片（固定在顶部） -->
            <div class="bg-white p-4">
                <div class="relative h-40 mb-3 rounded-lg overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1602470520998-f4a52199a3d6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" 
                         alt="和牛肉" class="w-full h-full object-cover">
                    <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-3 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-xl font-bold">和牛肉 #WG25031701</h2>
                                <p class="text-sm text-white/80">A5级 日本北海道产</p>
                            </div>
                            <div class="trace-status-tag trace-status-tag-success">
                                <i class="fas fa-check-circle mr-1"></i> 已完成
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-3 gap-2 text-center">
                    <div class="p-2 bg-gray-50 rounded">
                        <div class="text-xs text-gray-500">批次号</div>
                        <div class="text-sm font-medium">WG-2503-A</div>
                    </div>
                    <div class="p-2 bg-gray-50 rounded">
                        <div class="text-xs text-gray-500">产地</div>
                        <div class="text-sm font-medium">日本北海道</div>
                    </div>
                    <div class="p-2 bg-gray-50 rounded">
                        <div class="text-xs text-gray-500">生产日期</div>
                        <div class="text-sm font-medium">2025-03-15</div>
                    </div>
                </div>
            </div>
            
            <!-- NO VERTICAL SCROLL - 标签导航 -->
            <div class="tabs-nav sticky">
                <button class="tab-button" data-tab="tab-info">
                    <i class="fas fa-info-circle mr-1"></i> 基本信息
                </button>
                <button class="tab-button" data-tab="tab-process">
                    <i class="fas fa-project-diagram mr-1"></i> 溯源流程
                </button>
                <button class="tab-button" data-tab="tab-cert">
                    <i class="fas fa-certificate mr-1"></i> 证书与检测
                </button>
            </div>
            
            <!-- NO VERTICAL SCROLL - 标签内容 -->
            <!-- 基本信息标签 -->
            <div id="tab-info" class="tab-content">
                <div class="p-4">
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-4">
                        <h3 class="text-lg font-medium mb-3">产品详情</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <div class="text-gray-500 text-sm">产品名称</div>
                                <div class="font-medium">A5级和牛肉</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">产品编号</div>
                                <div class="font-medium">WG25031701</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">产品等级</div>
                                <div class="font-medium">A5级</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">肉质分数</div>
                                <div class="font-medium">BMS 12分（满分12分）</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">保质期</div>
                                <div class="font-medium">2025-06-15</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">储存温度</div>
                                <div class="font-medium">-18°C 以下冷冻保存</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-4">
                        <h3 class="text-lg font-medium mb-3">生产商信息</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="text-gray-500 text-sm">生产商</div>
                                <div class="font-medium">北海道高级肉类加工厂</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">地址</div>
                                <div class="font-medium">日本北海道札幌市中央区北5条西2丁目</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">许可证号</div>
                                <div class="font-medium">JPN-FOOD-5721093</div>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">联系方式</div>
                                <div class="font-medium">+81-xx-xxxx-xxxx</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-4">
                        <h3 class="text-lg font-medium mb-3">产品说明</h3>
                        <div class="text-sm text-gray-700">
                            <p class="mb-2">日本和牛是世界上最高级的牛肉，以其独特的大理石花纹、绝佳的风味和入口即化的口感而闻名。</p>
                            <p class="mb-2">A5是日本官方和牛评级系统中的最高等级，表示肉质、肌内脂肪（雪花纹）、颜色、质地等各方面均达到顶级标准。</p>
                            <p>这批特级和牛肉产自北海道的专业养殖场，牛只享用纯净水源和优质饲料，在严格的标准下饲养超过30个月，确保最佳的肉质和风味。</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 溯源流程标签 -->
            <div id="tab-process" class="tab-content">
                <div class="p-4">
                    <div class="trace-timeline">
                        <!-- 步骤1：养殖阶段 -->
                        <div class="trace-timeline-item">
                            <div class="trace-timeline-content">
                                <div class="trace-card">
                                    <div class="trace-card-header">
                                        <div class="trace-card-title flex items-center">
                                            <i class="fas fa-seedling text-[#00467F] mr-2"></i>
                                            养殖阶段
                                        </div>
                                        <div class="trace-status-tag trace-status-tag-success">
                                            <i class="fas fa-check-circle mr-1"></i> 已完成
                                        </div>
                                    </div>
                                    <div class="trace-card-body">
                                        <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                                            <div>
                                                <div class="text-gray-500">养殖基地</div>
                                                <div>北海道和牛牧场</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">养殖周期</div>
                                                <div>36个月</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">饲料类型</div>
                                                <div>有机草料+谷物</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">检疫记录</div>
                                                <div>已通过</div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-2 rounded text-xs text-gray-600 mb-3">
                                            <div class="font-medium mb-1">饲养环境</div>
                                            <p>北海道天然草场饲养，采用传统喂养技术，保证肉质纹理分布均匀，脂肪含量适中，确保最佳品质。</p>
                                        </div>
                                        <div class="flex items-center text-xs text-gray-500">
                                            <div class="mr-4">
                                                <i class="fas fa-user-check mr-1"></i> 山本牧场主
                                            </div>
                                            <div>
                                                <i class="fas fa-clock mr-1"></i> 2024-09-30
                                            </div>
                                        </div>
                                    </div>
                                    <div class="trace-card-footer">
                                        <button class="trace-button trace-button-secondary text-xs py-1 image-view-link" data-img="https://images.unsplash.com/photo-1516467716199-8b365909d974?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                                            <i class="fas fa-images mr-1"></i> 查看照片(3)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 步骤2：屠宰加工 -->
                        <div class="trace-timeline-item">
                            <div class="trace-timeline-content">
                                <div class="trace-card">
                                    <div class="trace-card-header">
                                        <div class="trace-card-title flex items-center">
                                            <i class="fas fa-cut text-[#00467F] mr-2"></i>
                                            屠宰加工
                                        </div>
                                        <div class="trace-status-tag trace-status-tag-success">
                                            <i class="fas fa-check-circle mr-1"></i> 已完成
                                        </div>
                                    </div>
                                    <div class="trace-card-body">
                                        <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                                            <div>
                                                <div class="text-gray-500">加工厂</div>
                                                <div>北海道高级肉类加工厂</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">加工日期</div>
                                                <div>2025-03-10</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">卫生检查</div>
                                                <div>合格</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">肉质评级</div>
                                                <div>A5 (最高级)</div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-2 rounded text-xs text-gray-600 mb-3">
                                            <div class="font-medium mb-1">检验结果</div>
                                            <p>脂肪交织度(BMS)：12分（满分12分），肉色：明亮鲜红，肌间脂肪分布均匀，肉质弹性佳，符合A5标准。</p>
                                        </div>
                                        <div class="flex items-center text-xs text-gray-500">
                                            <div class="mr-4">
                                                <i class="fas fa-user-check mr-1"></i> 田中检验员
                                            </div>
                                            <div>
                                                <i class="fas fa-clock mr-1"></i> 2025-03-10
                                            </div>
                                        </div>
                                    </div>
                                    <div class="trace-card-footer">
                                        <button class="trace-button trace-button-secondary text-xs py-1 image-view-link" data-img="https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                                            <i class="fas fa-images mr-1"></i> 查看照片(2)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 步骤3：质量检验 -->
                        <div class="trace-timeline-item">
                            <div class="trace-timeline-content">
                                <div class="trace-card">
                                    <div class="trace-card-header">
                                        <div class="trace-card-title flex items-center">
                                            <i class="fas fa-microscope text-[#00467F] mr-2"></i>
                                            质量检验
                                        </div>
                                        <div class="trace-status-tag trace-status-tag-success">
                                            <i class="fas fa-check-circle mr-1"></i> 已完成
                                        </div>
                                    </div>
                                    <div class="trace-card-body">
                                        <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                                            <div>
                                                <div class="text-gray-500">检验机构</div>
                                                <div>日本食品安全检测中心</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">检验日期</div>
                                                <div>2025-03-12</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">微生物检测</div>
                                                <div>合格</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">兽药残留</div>
                                                <div>未检出</div>
                                            </div>
                                        </div>
                                        <div class="flex flex-wrap gap-2 mb-3">
                                            <div class="bg-green-50 text-green-600 rounded p-1 text-center text-xs">
                                                <i class="fas fa-check-circle mr-1"></i> 微生物
                                            </div>
                                            <div class="bg-green-50 text-green-600 rounded p-1 text-center text-xs">
                                                <i class="fas fa-check-circle mr-1"></i> 兽药残留
                                            </div>
                                            <div class="bg-green-50 text-green-600 rounded p-1 text-center text-xs">
                                                <i class="fas fa-check-circle mr-1"></i> 激素检测
                                            </div>
                                            <div class="bg-green-50 text-green-600 rounded p-1 text-center text-xs">
                                                <i class="fas fa-check-circle mr-1"></i> 寄生虫
                                            </div>
                                            <div class="bg-green-50 text-green-600 rounded p-1 text-center text-xs">
                                                <i class="fas fa-check-circle mr-1"></i> 重金属
                                            </div>
                                        </div>
                                        <div class="flex items-center text-xs text-gray-500">
                                            <div class="mr-4">
                                                <i class="fas fa-user-check mr-1"></i> 佐藤检测员
                                            </div>
                                            <div>
                                                <i class="fas fa-clock mr-1"></i> 2025-03-12
                                            </div>
                                        </div>
                                    </div>
                                    <div class="trace-card-footer">
                                        <button class="trace-button trace-button-secondary text-xs py-1">
                                            <i class="fas fa-file-pdf mr-1"></i> 查看检测报告
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 步骤4：物流运输 -->
                        <div class="trace-timeline-item">
                            <div class="trace-timeline-content">
                                <div class="trace-card">
                                    <div class="trace-card-header">
                                        <div class="trace-card-title flex items-center">
                                            <i class="fas fa-truck text-[#00467F] mr-2"></i>
                                            物流运输
                                        </div>
                                        <div class="trace-status-tag trace-status-tag-success">
                                            <i class="fas fa-check-circle mr-1"></i> 已完成
                                        </div>
                                    </div>
                                    <div class="trace-card-body">
                                        <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                                            <div>
                                                <div class="text-gray-500">物流公司</div>
                                                <div>全球冷链物流</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">运输方式</div>
                                                <div>航空+冷藏车</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">出发地</div>
                                                <div>日本北海道</div>
                                            </div>
                                            <div>
                                                <div class="text-gray-500">目的地</div>
                                                <div>上海浦东</div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-50 p-2 rounded text-xs text-gray-600 mb-3">
                                            <div class="font-medium mb-1">冷链记录</div>
                                            <p>全程-2°C±1°C冷链运输，运输过程中实时监控温度，确保产品保持最佳状态。</p>
                                        </div>
                                        <div class="flex items-center text-xs text-gray-500">
                                            <div class="mr-4">
                                                <i class="fas fa-user-check mr-1"></i> 李物流经理
                                            </div>
                                            <div>
                                                <i class="fas fa-clock mr-1"></i> 2025-03-15
                                            </div>
                                        </div>
                                    </div>
                                    <div class="trace-card-footer">
                                        <button class="trace-button trace-button-secondary text-xs py-1">
                                            <i class="fas fa-temperature-low mr-1"></i> 查看温度记录
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 证书与检测标签 -->
            <div id="tab-cert" class="tab-content">
                <div class="p-4">
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-4">
                        <h3 class="text-lg font-medium mb-3">溯源证书</h3>
                        <div class="relative bg-[#00467F] p-3 rounded-lg text-white mb-3">
                            <div class="absolute top-2 right-2 text-xs px-2 py-1 bg-yellow-500 rounded-full">官方认证</div>
                            <div class="text-center mb-2">
                                <i class="fas fa-certificate text-yellow-400 text-xl mb-1"></i>
                                <h4 class="font-medium">食品安全溯源证书</h4>
                            </div>
                            <div class="text-xs opacity-90 mb-2">证书编号: WG25031701-CERT</div>
                            <div class="flex justify-between text-xs opacity-90">
                                <span>发布日期: 2025-03-17</span>
                                <span>有效期: 1年</span>
                            </div>
                        </div>
                        <a href="trace-certificate.html" class="trace-button trace-button-primary w-full text-center py-2">
                            <i class="fas fa-eye mr-1"></i> 查看完整证书
                        </a>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-4 mb-4">
                        <h3 class="text-lg font-medium mb-3">检测报告</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <div>
                                    <div class="font-medium">微生物检测报告</div>
                                    <div class="text-xs text-gray-500">2025-03-12</div>
                                </div>
                                <a href="#" class="text-[#00467F]">
                                    <i class="fas fa-download"></i>
                                </a>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <div>
                                    <div class="font-medium">兽药残留检测报告</div>
                                    <div class="text-xs text-gray-500">2025-03-12</div>
                                </div>
                                <a href="#" class="text-[#00467F]">
                                    <i class="fas fa-download"></i>
                                </a>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <div>
                                    <div class="font-medium">重金属检测报告</div>
                                    <div class="text-xs text-gray-500">2025-03-12</div>
                                </div>
                                <a href="#" class="text-[#00467F]">
                                    <i class="fas fa-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-sm p-4">
                        <h3 class="text-lg font-medium mb-3">区块链验证</h3>
                        <div class="p-3 bg-blue-50 rounded-lg border border-blue-100 mb-3">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-link text-[#00467F] mr-2"></i>
                                <span class="font-medium">区块链数据已验证</span>
                            </div>
                            <div class="text-xs text-gray-600">
                                <p>当前产品信息已存储在区块链上，确保数据真实可靠且不可篡改。</p>
                            </div>
                        </div>
                        <div class="text-xs text-gray-500 space-y-1">
                            <div class="flex justify-between">
                                <span>哈希值:</span>
                                <span class="font-mono text-xs">0x8f72d4e9b1a46e...52f1</span>
                            </div>
                            <div class="flex justify-between">
                                <span>区块高度:</span>
                                <span>17835020</span>
                            </div>
                            <div class="flex justify-between">
                                <span>存证时间:</span>
                                <span>2025-03-17 14:32:47</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 底部操作按钮 -->
            <div class="fixed-footer">
                <div class="grid grid-cols-2 gap-3">
                    <a href="#" class="trace-button trace-button-secondary flex items-center justify-center">
                        <i class="fas fa-qrcode mr-1"></i> 查看追溯码
                    </a>
                    <a href="trace-certificate.html" class="trace-button trace-button-primary flex items-center justify-center">
                        <i class="fas fa-certificate mr-1"></i> 查看溯源证书
                    </a>
                </div>
            </div>
        </div>
        
        <!-- NO VERTICAL SCROLL - 图片查看模态框 -->
        <div id="image-modal" class="modal-backdrop">
            <div class="relative w-full max-w-lg h-auto">
                <button id="close-image-modal" class="absolute top-3 right-3 z-10 bg-white rounded-full w-8 h-8 flex items-center justify-center text-gray-700 shadow-md">
                    <i class="fas fa-times"></i>
                </button>
                <img id="modal-image" src="" alt="产品图片" class="w-full h-auto rounded-lg">
            </div>
        </div>
    </div>
</body>
</html> 
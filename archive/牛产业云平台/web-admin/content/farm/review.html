<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>养殖场审核 - 牛产业云平台</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../css/variables.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #f8fafc; color: #1e293b; }

    .layout { display: flex; min-height: 100vh; }
    .sidebar { width: 280px; background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%); padding: 24px 0; position: fixed; height: 100vh; overflow-y: auto; }
    .logo { padding: 0 24px 32px; display: flex; align-items: center; gap: 12px; color: white; font-size: 20px; font-weight: 700; }
    .logo i { font-size: 32px; color: #666fee; }

    .nav-section { margin-bottom: 8px; }
    .nav-title { padding: 12px 24px 8px; font-size: 11px; text-transform: uppercase; color: #64748b; font-weight: 600; letter-spacing: 0.5px; }
    .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 24px; color: #94a3b8; text-decoration: none; transition: all 0.2s; cursor: pointer; }
    .nav-item:hover { background: rgba(255,255,255,0.05); color: white; }
    .nav-item.active { background: rgba(102, 111, 238, 0.15); color: #666fee; border-right: 3px solid #666fee; }
    .nav-item i { font-size: 20px; width: 24px; }

    .main { flex: 1; margin-left: 280px; }
    .header { height: 64px; background: white; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; justify-content: space-between; padding: 0 32px; position: sticky; top: 0; z-index: 100; }
    .header-title { font-size: 18px; font-weight: 600; display: flex; align-items: center; gap: 12px; }
    .header-title i { color: #666fee; }
    .header-actions { display: flex; align-items: center; gap: 16px; }
    .pending-count { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 600; }

    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s; border: none; text-decoration: none; }
    .btn-outline { background: white; border: 1px solid #e2e8f0; color: #64748b; }
    .btn-outline:hover { border-color: #666fee; color: #666fee; }

    .content { padding: 0; height: calc(100vh - 64px); }

    /* Three Column Layout */
    .review-layout { display: grid; grid-template-columns: 360px 1fr 420px; height: 100%; }

    /* Pending List */
    .pending-list { background: white; border-right: 1px solid #e2e8f0; display: flex; flex-direction: column; }
    .list-header { padding: 20px; border-bottom: 1px solid #e2e8f0; }
    .list-title { font-size: 15px; font-weight: 600; color: #1e293b; margin-bottom: 12px; }
    .list-search { position: relative; }
    .list-search input { width: 100%; padding: 10px 16px 10px 40px; border: 1px solid #e2e8f0; border-radius: 10px; font-size: 14px; }
    .list-search input:focus { outline: none; border-color: #666fee; }
    .list-search i { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #94a3b8; }
    .list-items { flex: 1; overflow-y: auto; }
    .list-item { padding: 16px 20px; border-bottom: 1px solid #f1f5f9; cursor: pointer; transition: all 0.2s; }
    .list-item:hover { background: #f8fafc; }
    .list-item.selected { background: rgba(102, 111, 238, 0.08); border-left: 3px solid #666fee; }
    .item-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
    .item-name { font-size: 14px; font-weight: 600; color: #1e293b; }
    .item-time { font-size: 12px; color: #94a3b8; }
    .item-location { font-size: 13px; color: #64748b; display: flex; align-items: center; gap: 4px; margin-bottom: 8px; }
    .item-location i { font-size: 14px; }
    .item-tags { display: flex; gap: 6px; flex-wrap: wrap; }
    .item-tag { padding: 3px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; }
    .item-tag.organic { background: #dcfce7; color: #16a34a; }
    .item-tag.green { background: #d1fae5; color: #059669; }
    .item-tag.harmless { background: #e0f2fe; color: #0284c7; }
    .item-tag.scale { background: #f1f5f9; color: #64748b; }

    /* Preview Panel */
    .preview-panel { background: #f8fafc; overflow-y: auto; padding: 24px; }
    .preview-empty { height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #94a3b8; }
    .preview-empty i { font-size: 64px; margin-bottom: 16px; opacity: 0.5; }
    .preview-empty p { font-size: 14px; }

    .preview-card { background: white; border-radius: 16px; border: 1px solid #e2e8f0; margin-bottom: 20px; overflow: hidden; }
    .preview-header { padding: 24px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); }
    .preview-farm-name { font-size: 22px; font-weight: 700; color: #1e293b; margin-bottom: 4px; }
    .preview-farm-code { font-size: 13px; color: #64748b; }
    .preview-location { font-size: 14px; color: #64748b; margin-top: 12px; display: flex; align-items: center; gap: 6px; }
    .preview-tags { display: flex; gap: 8px; margin-top: 16px; }
    .preview-tag { padding: 5px 12px; border-radius: 16px; font-size: 12px; font-weight: 500; }
    .preview-tag.organic { background: #dcfce7; color: #16a34a; }
    .preview-tag.green { background: #d1fae5; color: #059669; }
    .preview-tag.beef { background: #fef3c7; color: #d97706; }
    .preview-tag.large { background: #e0e7ff; color: #4f46e5; }

    .preview-section { padding: 20px 24px; border-bottom: 1px solid #f1f5f9; }
    .preview-section:last-child { border-bottom: none; }
    .section-title { font-size: 14px; font-weight: 600; color: #1e293b; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
    .section-title i { color: #666fee; }

    .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .info-item { background: #f8fafc; padding: 12px 16px; border-radius: 10px; }
    .info-label { font-size: 12px; color: #64748b; margin-bottom: 4px; }
    .info-value { font-size: 14px; font-weight: 500; color: #1e293b; }

    /* Capacity Preview */
    .capacity-preview { background: #f8fafc; padding: 16px; border-radius: 12px; }
    .capacity-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
    .capacity-label { font-size: 13px; color: #64748b; }
    .capacity-value { font-size: 14px; font-weight: 600; color: #1e293b; }
    .capacity-bar { height: 12px; background: #e2e8f0; border-radius: 6px; overflow: hidden; }
    .capacity-fill { height: 100%; border-radius: 6px; }
    .capacity-fill.low { background: #22c55e; }
    .capacity-fill.medium { background: #f59e0b; }
    .capacity-fill.high { background: #ef4444; }

    /* Image Gallery */
    .image-gallery { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
    .gallery-image { aspect-ratio: 4/3; border-radius: 10px; overflow: hidden; cursor: pointer; }
    .gallery-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
    .gallery-image:hover img { transform: scale(1.05); }

    /* Contact Preview */
    .contact-list { display: flex; flex-direction: column; gap: 8px; }
    .contact-item { display: flex; align-items: center; gap: 12px; padding: 10px 14px; background: #f8fafc; border-radius: 10px; }
    .contact-item i { font-size: 18px; color: #64748b; width: 24px; }
    .contact-item span { font-size: 14px; color: #1e293b; }

    /* Review Panel */
    .review-panel { background: white; border-left: 1px solid #e2e8f0; display: flex; flex-direction: column; }
    .review-header { padding: 20px 24px; border-bottom: 1px solid #e2e8f0; }
    .review-title { font-size: 16px; font-weight: 600; color: #1e293b; margin-bottom: 4px; }
    .review-subtitle { font-size: 13px; color: #64748b; }
    .review-content { flex: 1; padding: 24px; overflow-y: auto; }
    .review-actions { padding: 20px 24px; border-top: 1px solid #e2e8f0; background: #f8fafc; }

    /* Review Form */
    .review-section { margin-bottom: 24px; }
    .review-section:last-child { margin-bottom: 0; }
    .review-label { font-size: 14px; font-weight: 600; color: #1e293b; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .review-label i { color: #666fee; }

    /* Decision Buttons */
    .decision-buttons { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .decision-btn { padding: 20px; border: 2px solid #e2e8f0; border-radius: 12px; text-align: center; cursor: pointer; transition: all 0.2s; background: white; }
    .decision-btn:hover { border-color: #666fee; }
    .decision-btn.approve.selected { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); border-color: #22c55e; }
    .decision-btn.reject.selected { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-color: #ef4444; }
    .decision-btn i { font-size: 32px; margin-bottom: 8px; }
    .decision-btn.approve i { color: #22c55e; }
    .decision-btn.reject i { color: #ef4444; }
    .decision-btn .text { font-size: 14px; font-weight: 600; color: #1e293b; }

    /* Reject Reasons */
    .reject-reasons { display: none; flex-direction: column; gap: 8px; }
    .reject-reasons.show { display: flex; }
    .reason-option { display: flex; align-items: center; gap: 10px; padding: 12px 14px; border: 1px solid #e2e8f0; border-radius: 10px; cursor: pointer; transition: all 0.2s; }
    .reason-option:hover { border-color: #666fee; }
    .reason-option.selected { border-color: #ef4444; background: #fef2f2; }
    .reason-option input { display: none; }
    .reason-checkbox { width: 18px; height: 18px; border: 2px solid #d1d5db; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
    .reason-option.selected .reason-checkbox { background: #ef4444; border-color: #ef4444; }
    .reason-checkbox i { font-size: 12px; color: white; opacity: 0; }
    .reason-option.selected .reason-checkbox i { opacity: 1; }
    .reason-text { font-size: 13px; color: #1e293b; }

    /* Comment Box */
    .comment-box { width: 100%; min-height: 100px; padding: 14px; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 14px; resize: vertical; font-family: inherit; }
    .comment-box:focus { outline: none; border-color: #666fee; }
    .comment-box::placeholder { color: #94a3b8; }

    /* Submit Button */
    .submit-btn { width: 100%; padding: 14px; border: none; border-radius: 12px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
    .submit-btn.approve { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); color: white; }
    .submit-btn.approve:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4); }
    .submit-btn.reject { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; }
    .submit-btn.reject:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4); }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }

    /* Keyboard Shortcuts */
    .shortcuts { padding: 20px 24px; border-top: 1px solid #e2e8f0; background: #f8fafc; }
    .shortcuts-title { font-size: 12px; color: #64748b; margin-bottom: 8px; }
    .shortcut-list { display: flex; flex-wrap: wrap; gap: 12px; }
    .shortcut { display: flex; align-items: center; gap: 6px; }
    .shortcut kbd { padding: 3px 8px; background: white; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 11px; font-weight: 600; color: #64748b; }
    .shortcut span { font-size: 12px; color: #64748b; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
  </style>
</head>
<body>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <i class="mdi mdi-cow"></i>
        <span>牛产业云平台</span>
      </div>

      <nav>
        <div class="nav-section">
          <div class="nav-title">内容管理</div>
          <a href="../cattle/list.html" class="nav-item"><i class="mdi mdi-cow"></i><span>活牛管理</span></a>
          <a href="../breeding/list.html" class="nav-item"><i class="mdi mdi-dna"></i><span>育种种牛</span></a>
          <a href="../beef/list.html" class="nav-item"><i class="mdi mdi-food-steak"></i><span>牛肉产品</span></a>
          <a href="../feed/list.html" class="nav-item"><i class="mdi mdi-barley"></i><span>饲料产品</span></a>
          <a href="../equipment/list.html" class="nav-item"><i class="mdi mdi-tools"></i><span>设备管理</span></a>
          <a href="list.html" class="nav-item active"><i class="mdi mdi-home-group"></i><span>养殖场</span></a>
          <a href="../slaughter/list.html" class="nav-item"><i class="mdi mdi-factory"></i><span>屠宰场</span></a>
        </div>

        <div class="nav-section">
          <div class="nav-title">系统设置</div>
          <a href="../settings/category.html" class="nav-item"><i class="mdi mdi-shape"></i><span>分类管理</span></a>
          <a href="../settings/banner.html" class="nav-item"><i class="mdi mdi-image"></i><span>Banner广告</span></a>
          <a href="../settings/users.html" class="nav-item"><i class="mdi mdi-account-group"></i><span>用户管理</span></a>
          <a href="../settings/config.html" class="nav-item"><i class="mdi mdi-cog"></i><span>系统配置</span></a>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main">
      <header class="header">
        <div class="header-title">
          <i class="mdi mdi-check-decagram"></i>
          <span>养殖场入驻审核</span>
        </div>
        <div class="header-actions">
          <span class="pending-count">待审核: 6</span>
          <a href="list.html" class="btn btn-outline">
            <i class="mdi mdi-arrow-left"></i>返回列表
          </a>
        </div>
      </header>

      <div class="content">
        <div class="review-layout">
          <!-- Pending List -->
          <div class="pending-list">
            <div class="list-header">
              <div class="list-title">待审核申请</div>
              <div class="list-search">
                <i class="mdi mdi-magnify"></i>
                <input type="text" placeholder="搜索养殖场...">
              </div>
            </div>
            <div class="list-items" id="pendingList">
              <!-- Items will be rendered by JS -->
            </div>
          </div>

          <!-- Preview Panel -->
          <div class="preview-panel" id="previewPanel">
            <div class="preview-empty">
              <i class="mdi mdi-home-search"></i>
              <p>请从左侧选择一个待审核的养殖场</p>
            </div>
          </div>

          <!-- Review Panel -->
          <div class="review-panel">
            <div class="review-header">
              <div class="review-title">审核操作</div>
              <div class="review-subtitle">请仔细核对养殖场信息后做出审核决定</div>
            </div>
            <div class="review-content">
              <div class="review-section">
                <div class="review-label"><i class="mdi mdi-clipboard-check"></i>审核决定</div>
                <div class="decision-buttons">
                  <div class="decision-btn approve" onclick="selectDecision('approve')">
                    <i class="mdi mdi-check-circle"></i>
                    <div class="text">通过审核</div>
                  </div>
                  <div class="decision-btn reject" onclick="selectDecision('reject')">
                    <i class="mdi mdi-close-circle"></i>
                    <div class="text">驳回申请</div>
                  </div>
                </div>
              </div>

              <div class="review-section reject-reasons" id="rejectReasons">
                <div class="review-label"><i class="mdi mdi-alert-circle"></i>驳回原因</div>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="incomplete">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">资料不完整</span>
                </label>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="invalid_cert">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">资质证书无效或过期</span>
                </label>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="fake_info">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">信息存在虚假</span>
                </label>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="scale_mismatch">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">实际规模与申报不符</span>
                </label>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="environmental">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">环保要求不达标</span>
                </label>
                <label class="reason-option" onclick="toggleReason(this)">
                  <input type="checkbox" value="other">
                  <div class="reason-checkbox"><i class="mdi mdi-check"></i></div>
                  <span class="reason-text">其他原因</span>
                </label>
              </div>

              <div class="review-section">
                <div class="review-label"><i class="mdi mdi-message-text"></i>审核备注</div>
                <textarea class="comment-box" placeholder="请输入审核意见或备注（选填）"></textarea>
              </div>
            </div>

            <div class="review-actions">
              <button class="submit-btn approve" id="submitBtn" disabled onclick="submitReview()">
                <i class="mdi mdi-check"></i>
                <span>提交审核</span>
              </button>
            </div>

            <div class="shortcuts">
              <div class="shortcuts-title">快捷键</div>
              <div class="shortcut-list">
                <div class="shortcut"><kbd>A</kbd><span>通过</span></div>
                <div class="shortcut"><kbd>R</kbd><span>驳回</span></div>
                <div class="shortcut"><kbd>↑↓</kbd><span>切换</span></div>
                <div class="shortcut"><kbd>Enter</kbd><span>提交</span></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Mock pending data
    const pendingFarms = [
      {
        id: 'FARM_NEW_001',
        name: '青山生态牧业',
        location: '新疆维吾尔自治区伊犁州昭苏县',
        submitTime: '2025-01-20 09:30',
        certs: ['organic', 'green'],
        scale: '大型',
        type: 'beef',
        capacity: 2500,
        current: 0,
        area: 4200,
        contact: '李明辉',
        phone: '138-9999-8888',
        email: 'qsstyy@example.com',
        breeds: '安格斯、夏洛莱',
        images: [
          'https://images.unsplash.com/photo-1516467508483-a7212febe31a?w=400',
          'https://images.unsplash.com/photo-1570042225831-d98fa7577f1e?w=400',
          'https://images.unsplash.com/photo-1500595046743-cd271d694d30?w=400'
        ],
        description: '青山生态牧业位于伊犁河谷，拥有优质天然草场，采用现代化养殖技术，专注高端肉牛养殖。'
      },
      {
        id: 'FARM_NEW_002',
        name: '天泽养殖合作社',
        location: '四川省阿坝州若尔盖县',
        submitTime: '2025-01-19 16:45',
        certs: ['harmless'],
        scale: '中型',
        type: 'beef',
        capacity: 1200,
        current: 0,
        area: 1800,
        contact: '王建军',
        phone: '136-8888-7777',
        email: 'tzyzhs@example.com',
        breeds: '西门塔尔、黄牛',
        images: [
          'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400',
          'https://images.unsplash.com/photo-1500595046743-cd271d694d30?w=400'
        ],
        description: '天泽养殖合作社采用传统放牧与圈养相结合的模式，主营高原生态牛肉。'
      },
      {
        id: 'FARM_NEW_003',
        name: '北疆牧歌牧场',
        location: '新疆维吾尔自治区阿勒泰地区',
        submitTime: '2025-01-19 11:20',
        certs: ['organic'],
        scale: '大型',
        type: 'mixed',
        capacity: 3500,
        current: 0,
        area: 6800,
        contact: '赵志远',
        phone: '159-1234-5678',
        email: 'bjmg@example.com',
        breeds: '哈萨克牛、新疆褐牛',
        images: [
          'https://images.unsplash.com/photo-1570042225831-d98fa7577f1e?w=400',
          'https://images.unsplash.com/photo-1516467508483-a7212febe31a?w=400',
          'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400'
        ],
        description: '北疆牧歌牧场地处阿勒泰山脉，拥有万亩天然牧场，是新疆最大的有机牛肉生产基地。'
      },
      {
        id: 'FARM_NEW_004',
        name: '草原明珠牧业',
        location: '内蒙古自治区锡林郭勒盟',
        submitTime: '2025-01-18 14:30',
        certs: ['green', 'harmless'],
        scale: '中型',
        type: 'dairy',
        capacity: 800,
        current: 0,
        area: 1200,
        contact: '巴图',
        phone: '137-6666-5555',
        email: 'cymz@example.com',
        breeds: '荷斯坦、西门塔尔',
        images: [
          'https://images.unsplash.com/photo-1500595046743-cd271d694d30?w=400'
        ],
        description: '草原明珠牧业专注于高品质乳制品生产，牧场采用自然放牧模式。'
      },
      {
        id: 'FARM_NEW_005',
        name: '金牛种业基地',
        location: '山东省滨州市无棣县',
        submitTime: '2025-01-18 10:15',
        certs: ['organic', 'green', 'harmless'],
        scale: '超大型',
        type: 'breeding',
        capacity: 5000,
        current: 0,
        area: 3200,
        contact: '陈国强',
        phone: '156-7777-8888',
        email: 'jnzy@example.com',
        breeds: '鲁西黄牛、渤海黑牛',
        images: [
          'https://images.unsplash.com/photo-1516467508483-a7212febe31a?w=400',
          'https://images.unsplash.com/photo-1570042225831-d98fa7577f1e?w=400'
        ],
        description: '金牛种业基地是国家级种牛繁育中心，专注优质肉牛种源培育与推广。'
      },
      {
        id: 'FARM_NEW_006',
        name: '云岭高原牧业',
        location: '云南省迪庆州香格里拉市',
        submitTime: '2025-01-17 09:00',
        certs: ['organic'],
        scale: '小型',
        type: 'beef',
        capacity: 350,
        current: 0,
        area: 580,
        contact: '扎西',
        phone: '188-9999-0000',
        email: 'ylgy@example.com',
        breeds: '云南黄牛、牦牛',
        images: [
          'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400'
        ],
        description: '云岭高原牧业位于海拔3200米的高原牧场，主营高原特色牛肉产品。'
      }
    ];

    const certMap = { organic: '有机认证', green: '绿色食品', harmless: '无公害' };
    const typeMap = { beef: '肉牛养殖', dairy: '奶牛养殖', breeding: '种牛繁育', mixed: '综合养殖' };

    let selectedFarm = null;
    let decision = null;
    let selectedReasons = [];

    // Render pending list
    function renderPendingList() {
      const container = document.getElementById('pendingList');
      container.innerHTML = pendingFarms.map((farm, index) => `
        <div class="list-item ${index === 0 ? 'selected' : ''}" data-id="${farm.id}" onclick="selectFarm('${farm.id}')">
          <div class="item-header">
            <span class="item-name">${farm.name}</span>
            <span class="item-time">${farm.submitTime.split(' ')[0]}</span>
          </div>
          <div class="item-location"><i class="mdi mdi-map-marker"></i>${farm.location.split('省')[0] || farm.location.split('自治区')[0]}...</div>
          <div class="item-tags">
            ${farm.certs.map(c => `<span class="item-tag ${c}">${certMap[c]}</span>`).join('')}
            <span class="item-tag scale">${farm.scale}</span>
          </div>
        </div>
      `).join('');

      // Auto-select first item
      if (pendingFarms.length > 0) {
        selectFarm(pendingFarms[0].id);
      }
    }

    // Select farm
    function selectFarm(id) {
      selectedFarm = pendingFarms.find(f => f.id === id);
      if (!selectedFarm) return;

      // Update list selection
      document.querySelectorAll('.list-item').forEach(item => {
        item.classList.toggle('selected', item.dataset.id === id);
      });

      // Render preview
      renderPreview();
    }

    // Render preview
    function renderPreview() {
      const farm = selectedFarm;
      if (!farm) return;

      const container = document.getElementById('previewPanel');
      container.innerHTML = `
        <div class="preview-card">
          <div class="preview-header">
            <div class="preview-farm-name">${farm.name}</div>
            <div class="preview-farm-code">${farm.id}</div>
            <div class="preview-location"><i class="mdi mdi-map-marker"></i>${farm.location}</div>
            <div class="preview-tags">
              ${farm.certs.map(c => `<span class="preview-tag ${c}">${certMap[c]}</span>`).join('')}
              <span class="preview-tag beef">${typeMap[farm.type]}</span>
              <span class="preview-tag large">${farm.scale}</span>
            </div>
          </div>

          <div class="preview-section">
            <div class="section-title"><i class="mdi mdi-information"></i>基本信息</div>
            <div class="info-grid">
              <div class="info-item">
                <div class="info-label">设计容量</div>
                <div class="info-value">${farm.capacity.toLocaleString()} 头</div>
              </div>
              <div class="info-item">
                <div class="info-label">占地面积</div>
                <div class="info-value">${farm.area.toLocaleString()} 亩</div>
              </div>
              <div class="info-item">
                <div class="info-label">主营品种</div>
                <div class="info-value">${farm.breeds}</div>
              </div>
              <div class="info-item">
                <div class="info-label">提交时间</div>
                <div class="info-value">${farm.submitTime}</div>
              </div>
            </div>
          </div>

          <div class="preview-section">
            <div class="section-title"><i class="mdi mdi-text-box"></i>养殖场简介</div>
            <p style="font-size: 14px; color: #64748b; line-height: 1.6;">${farm.description}</p>
          </div>

          <div class="preview-section">
            <div class="section-title"><i class="mdi mdi-image-multiple"></i>场区照片</div>
            <div class="image-gallery">
              ${farm.images.map(img => `<div class="gallery-image"><img src="${img}" alt=""></div>`).join('')}
            </div>
          </div>

          <div class="preview-section">
            <div class="section-title"><i class="mdi mdi-card-account-phone"></i>联系信息</div>
            <div class="contact-list">
              <div class="contact-item"><i class="mdi mdi-account"></i><span>${farm.contact}</span></div>
              <div class="contact-item"><i class="mdi mdi-phone"></i><span>${farm.phone}</span></div>
              <div class="contact-item"><i class="mdi mdi-email"></i><span>${farm.email}</span></div>
            </div>
          </div>
        </div>
      `;
    }

    // Select decision
    function selectDecision(type) {
      decision = type;
      document.querySelectorAll('.decision-btn').forEach(btn => btn.classList.remove('selected'));
      document.querySelector(`.decision-btn.${type}`).classList.add('selected');

      // Show/hide reject reasons
      const reasonsPanel = document.getElementById('rejectReasons');
      reasonsPanel.classList.toggle('show', type === 'reject');

      // Update submit button
      updateSubmitButton();
    }

    // Toggle reason
    function toggleReason(element) {
      element.classList.toggle('selected');
      const value = element.querySelector('input').value;
      if (element.classList.contains('selected')) {
        selectedReasons.push(value);
      } else {
        selectedReasons = selectedReasons.filter(r => r !== value);
      }
      updateSubmitButton();
    }

    // Update submit button
    function updateSubmitButton() {
      const btn = document.getElementById('submitBtn');
      let enabled = false;

      if (decision === 'approve' && selectedFarm) {
        enabled = true;
        btn.className = 'submit-btn approve';
        btn.innerHTML = '<i class="mdi mdi-check"></i><span>确认通过</span>';
      } else if (decision === 'reject' && selectedFarm && selectedReasons.length > 0) {
        enabled = true;
        btn.className = 'submit-btn reject';
        btn.innerHTML = '<i class="mdi mdi-close"></i><span>确认驳回</span>';
      }

      btn.disabled = !enabled;
    }

    // Submit review
    function submitReview() {
      if (!selectedFarm || !decision) return;

      const action = decision === 'approve' ? '通过' : '驳回';
      if (confirm(`确定要${action}「${selectedFarm.name}」的入驻申请吗？`)) {
        alert(`审核完成：已${action}「${selectedFarm.name}」`);

        // Remove from list
        const index = pendingFarms.findIndex(f => f.id === selectedFarm.id);
        if (index > -1) {
          pendingFarms.splice(index, 1);
        }

        // Reset state
        selectedFarm = null;
        decision = null;
        selectedReasons = [];
        document.querySelectorAll('.decision-btn').forEach(btn => btn.classList.remove('selected'));
        document.getElementById('rejectReasons').classList.remove('show');
        document.querySelectorAll('.reason-option').forEach(opt => opt.classList.remove('selected'));
        document.querySelector('.comment-box').value = '';
        updateSubmitButton();

        // Re-render
        renderPendingList();

        // Update pending count
        document.querySelector('.pending-count').textContent = `待审核: ${pendingFarms.length}`;
      }
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

      switch (e.key.toLowerCase()) {
        case 'a':
          selectDecision('approve');
          break;
        case 'r':
          selectDecision('reject');
          break;
        case 'arrowup':
          navigateList(-1);
          break;
        case 'arrowdown':
          navigateList(1);
          break;
        case 'enter':
          if (!document.getElementById('submitBtn').disabled) {
            submitReview();
          }
          break;
      }
    });

    // Navigate list
    function navigateList(direction) {
      if (!selectedFarm) return;
      const currentIndex = pendingFarms.findIndex(f => f.id === selectedFarm.id);
      const newIndex = Math.max(0, Math.min(pendingFarms.length - 1, currentIndex + direction));
      if (newIndex !== currentIndex) {
        selectFarm(pendingFarms[newIndex].id);
      }
    }

    // Initialize
    renderPendingList();
  </script>
</body>
</html>

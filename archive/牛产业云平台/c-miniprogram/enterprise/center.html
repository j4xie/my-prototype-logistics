<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>企业中心 - 中国牛产业数智云平台</title>
  <link rel="stylesheet" href="../../assets/css/variables.css">
  <link rel="stylesheet" href="../../assets/css/common.css">
  <link rel="stylesheet" href="../../assets/css/mobile.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
      background: #F5F5F5;
      min-height: 100vh;
      /* padding-bottom 由 mobile.css 的 body.has-bottom-nav 统一控制 (75px) */
    }

    /* 顶部区域 */
    .profile-header {
      background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
      padding: 48px 20px 32px;
      position: relative;
    }

    .profile-bg-pattern {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: 0.1;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L60 30L30 60L0 30L30 0z' fill='%23fff' fill-opacity='0.4'/%3E%3C/svg%3E");
      background-size: 30px;
    }

    .header-actions {
      position: absolute;
      top: 48px;
      right: 16px;
      display: flex;
      gap: 16px;
    }

    .header-btn {
      color: white;
      font-size: 20px;
      text-decoration: none;
    }

    /* 用户信息 */
    .user-info {
      position: relative;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .avatar {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .user-details {
      flex: 1;
      color: white;
    }

    .user-name {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .vip-badge {
      background: linear-gradient(135deg, #FFD700 0%, #FFA000 100%);
      color: #5D4037;
      font-size: 11px;
      font-weight: 600;
      padding: 2px 8px;
      border-radius: 10px;
    }

    .enterprise-name {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 4px;
    }

    .verify-status {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
    }

    /* 登录卡片 */
    .login-card {
      position: relative;
      text-align: center;
      padding: 20px;
      color: white;
    }

    .login-card .avatar {
      margin: 0 auto 16px;
      background: rgba(255, 255, 255, 0.2);
      border: 2px dashed rgba(255, 255, 255, 0.5);
    }

    .login-title {
      font-size: 18px;
      margin-bottom: 8px;
    }

    .login-desc {
      font-size: 13px;
      opacity: 0.8;
      margin-bottom: 16px;
    }

    .login-btns {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .login-btn {
      padding: 10px 32px;
      border-radius: 20px;
      font-size: 14px;
      text-decoration: none;
      font-weight: 500;
    }

    .login-btn.primary {
      background: white;
      color: #2E7D32;
    }

    .login-btn.secondary {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    /* 统计卡片 */
    .stats-card {
      background: white;
      margin: -20px 16px 16px;
      border-radius: 12px;
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      position: relative;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .stat-item {
      text-align: center;
      text-decoration: none;
      color: inherit;
    }

    .stat-number {
      font-size: 22px;
      font-weight: 600;
      color: #212121;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 12px;
      color: #757575;
    }

    .stat-item:not(:last-child)::after {
      content: '';
      position: absolute;
      width: 1px;
      height: 32px;
      background: #F0F0F0;
      right: -6px;
      top: 50%;
      transform: translateY(-50%);
    }

    /* 菜单区块 */
    .menu-section {
      background: white;
      margin: 0 16px 16px;
      border-radius: 12px;
      overflow: hidden;
    }

    .section-title {
      font-size: 15px;
      font-weight: 600;
      color: #212121;
      padding: 16px 16px 12px;
      border-bottom: 1px solid #F5F5F5;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      padding: 16px 8px;
      gap: 8px;
    }

    .menu-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 12px 8px;
      text-decoration: none;
      color: inherit;
      transition: all 0.3s;
    }

    .menu-item:active {
      background: #F5F5F5;
      border-radius: 8px;
    }

    .menu-icon {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .menu-icon.green {
      background: #E8F5E9;
    }

    .menu-icon.blue {
      background: #E3F2FD;
    }

    .menu-icon.orange {
      background: #FFF3E0;
    }

    .menu-icon.purple {
      background: #F3E5F5;
    }

    .menu-icon.pink {
      background: #FCE4EC;
    }

    .menu-icon.teal {
      background: #E0F2F1;
    }

    .menu-icon.amber {
      background: #FFF8E1;
    }

    .menu-icon.grey {
      background: #F5F5F5;
    }

    .menu-name {
      font-size: 12px;
      color: #424242;
      text-align: center;
    }

    /* 列表菜单 */
    .menu-list {
      padding: 0;
    }

    .menu-list-item {
      display: flex;
      align-items: center;
      padding: 16px;
      text-decoration: none;
      color: inherit;
      border-bottom: 1px solid #F5F5F5;
      transition: background 0.3s;
    }

    .menu-list-item:last-child {
      border-bottom: none;
    }

    .menu-list-item:active {
      background: #F5F5F5;
    }

    .menu-list-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      margin-right: 12px;
    }

    .menu-list-info {
      flex: 1;
    }

    .menu-list-title {
      font-size: 15px;
      color: #212121;
      margin-bottom: 2px;
    }

    .menu-list-desc {
      font-size: 12px;
      color: #9E9E9E;
    }

    .menu-list-arrow {
      color: #BDBDBD;
      font-size: 14px;
    }

    .menu-list-badge {
      background: #FF5722;
      color: white;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-right: 8px;
    }

    /* 企业工作台入口 */
    .workbench-entry {
      margin: -20px 16px 16px;
      position: relative;
    }

    .workbench-card {
      display: flex;
      align-items: center;
      gap: 12px;
      background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
      border-radius: 12px;
      padding: 16px;
      text-decoration: none;
      color: white;
      box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
      transition: transform 0.3s;
    }

    .workbench-card:active {
      transform: scale(0.98);
    }

    .workbench-icon {
      width: 48px;
      height: 48px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .workbench-info {
      flex: 1;
    }

    .workbench-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .workbench-desc {
      font-size: 12px;
      opacity: 0.9;
    }

    .workbench-stats .stat-badge {
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
    }

    .workbench-arrow {
      font-size: 20px;
      opacity: 0.8;
    }

    /* 服务入口 */
    .service-banner {
      background: white;
      margin: 0 16px 16px;
      border-radius: 12px;
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .service-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, #FF8F00 0%, #F57C00 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: white;
    }

    .service-info {
      flex: 1;
    }

    .service-title {
      font-size: 15px;
      font-weight: 600;
      color: #212121;
      margin-bottom: 4px;
    }

    .service-desc {
      font-size: 12px;
      color: #757575;
    }

    .service-btn {
      background: linear-gradient(135deg, #FF8F00 0%, #F57C00 100%);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 16px;
      font-size: 13px;
      cursor: pointer;
    }

    /* 版本信息 */
    .footer-info {
      text-align: center;
      padding: 24px 16px;
      color: #BDBDBD;
      font-size: 12px;
    }

    .footer-info a {
      color: #9E9E9E;
      text-decoration: none;
    }

    /* Toast */
    .toast {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.75);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
    }

    .toast.show {
      opacity: 1;
    }

    /* ==================== MDI 图标标准化 ==================== */
    .mdi {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      line-height: 1;
    }

    .header-btn {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .avatar {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .menu-icon {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .menu-list-icon {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .service-icon {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .nav-item .nav-icon {
      display: flex !important;
      align-items: center;
      justify-content: center;
    }
  </style>
</head>

<body class="theme-green has-bottom-nav">
  <!-- 顶部区域 -->
  <div class="profile-header">
    <div class="profile-bg-pattern"></div>
    <div class="header-actions">
      <a href="#" class="header-btn" onclick="showSettings()"><i class="mdi mdi-cog"></i></a>
      <a href="messages.html" class="header-btn"><i class="mdi mdi-bell"></i></a>
    </div>

    <!-- 已登录用户信息 -->
    <div class="user-info" id="userInfo" style="display: none;">
      <div class="avatar" id="userAvatar"><i class="mdi mdi-account"></i></div>
      <div class="user-details">
        <div class="user-name">
          <span id="userName">用户名</span>
          <span class="vip-badge" id="userLevel">VIP</span>
        </div>
        <div class="enterprise-name" id="enterpriseName">企业名称</div>
        <div class="verify-status" id="verifyStatus">
          <span><i class="mdi mdi-check-circle"></i></span>
          <span>已认证</span>
        </div>
      </div>
    </div>

    <!-- 未登录卡片 -->
    <div class="login-card" id="loginCard">
      <div class="avatar"><i class="mdi mdi-account"></i></div>
      <div class="login-title">登录/注册</div>
      <div class="login-desc">登录后享受更多服务</div>
      <div class="login-btns">
        <a href="../auth/login.html" class="login-btn primary">立即登录</a>
        <a href="../auth/register.html" class="login-btn secondary">企业注册</a>
      </div>
    </div>
  </div>

  <!-- 企业工作台入口 (登录后显示) -->
  <div class="workbench-entry" id="workbenchEntry" style="display: none;">
    <a href="workbench.html" class="workbench-card">
      <div class="workbench-icon"><i class="mdi mdi-briefcase"></i></div>
      <div class="workbench-info">
        <div class="workbench-title">企业工作台</div>
        <div class="workbench-desc">业务管理 · 订单 · 数据报表</div>
      </div>
      <div class="workbench-stats">
        <span class="stat-badge" id="workbenchBadge">3条待处理</span>
      </div>
      <span class="workbench-arrow mdi mdi-chevron-right"></span>
    </a>
  </div>

  <!-- 常用功能 (登录后显示) -->
  <div class="menu-section" id="quickMenu" style="display: none;">
    <div class="section-title">常用功能</div>
    <div class="menu-grid">
      <a href="my-publish.html" class="menu-item">
        <div class="menu-icon green"><i class="mdi mdi-clipboard-list"></i></div>
        <div class="menu-name">我的发布</div>
      </a>
      <a href="favorites.html" class="menu-item">
        <div class="menu-icon pink"><i class="mdi mdi-heart"></i></div>
        <div class="menu-name">我的收藏</div>
      </a>
      <a href="../trace/history.html" class="menu-item">
        <div class="menu-icon teal"><i class="mdi mdi-magnify"></i></div>
        <div class="menu-name">溯源记录</div>
      </a>
      <a href="../ai-rag/chat.html" class="menu-item">
        <div class="menu-icon blue"><i class="mdi mdi-robot"></i></div>
        <div class="menu-name">AI助手</div>
      </a>
    </div>
  </div>

  <!-- 更多服务 -->
  <div class="menu-section">
    <div class="section-title">更多服务</div>
    <div class="menu-list">
      <a href="help.html" class="menu-list-item">
        <div class="menu-list-icon grey"><i class="mdi mdi-help-circle"></i></div>
        <div class="menu-list-info">
          <div class="menu-list-title">帮助中心</div>
          <div class="menu-list-desc">常见问题解答</div>
        </div>
        <span class="menu-list-arrow">›</span>
      </a>
      <a href="#" class="menu-list-item" onclick="showService()">
        <div class="menu-list-icon green"><i class="mdi mdi-face-agent"></i></div>
        <div class="menu-list-info">
          <div class="menu-list-title">在线客服</div>
          <div class="menu-list-desc">工作时间 9:00-18:00</div>
        </div>
        <span class="menu-list-arrow">›</span>
      </a>
      <a href="feedback.html" class="menu-list-item">
        <div class="menu-list-icon amber"><i class="mdi mdi-pencil-box"></i></div>
        <div class="menu-list-info">
          <div class="menu-list-title">意见反馈</div>
          <div class="menu-list-desc">帮助我们做得更好</div>
        </div>
        <span class="menu-list-arrow">›</span>
      </a>
      <a href="#" class="menu-list-item" onclick="showAbout()">
        <div class="menu-list-icon blue"><i class="mdi mdi-information"></i></div>
        <div class="menu-list-info">
          <div class="menu-list-title">关于平台</div>
          <div class="menu-list-desc">版本 1.0.0</div>
        </div>
        <span class="menu-list-arrow">›</span>
      </a>
    </div>
  </div>

  <!-- 退出登录按钮 -->
  <div class="menu-section" id="logoutSection" style="display: none;">
    <a href="#" class="menu-list-item" onclick="doLogout()" style="justify-content: center; color: #D32F2F;">
      <span style="font-size: 15px;">退出登录</span>
    </a>
  </div>

  <!-- 版本信息 -->
  <div class="footer-info">
    <p>中国牛产业数智云平台 v1.0.0</p>
    <p style="margin-top: 8px;">
      <a href="#">用户协议</a> | <a href="#">隐私政策</a>
    </p>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- 底部导航 -->
  <nav class="bottom-nav">
    <a href="../home/home.html" class="nav-item">
      <span class="nav-icon mdi mdi-home"></span>
      <span>首页</span>
    </a>
    <a href="../cattle/publish.html" class="nav-item">
      <span class="nav-icon mdi mdi-plus-circle"></span>
      <span>发布</span>
    </a>
    <a href="../ai-rag/chat.html" class="nav-item">
      <span class="nav-icon mdi mdi-robot"></span>
      <span>AI</span>
    </a>
    <a href="messages.html" class="nav-item">
      <span class="nav-icon mdi mdi-bell"></span>
      <span>消息</span>
    </a>
    <a href="javascript:void(0)" class="nav-item active">
      <span class="nav-icon mdi mdi-account"></span>
      <span>我的</span>
    </a>
  </nav>

  <!-- JS -->
  <script src="../../assets/js/utils.js"></script>
  <script src="../../assets/js/stateManager.js"></script>
  <script src="../../assets/js/dictionaries.js"></script>
  <script src="../../assets/js/mockData.js"></script>

  <script>
    // ==================== 初始化 ====================
    document.addEventListener('DOMContentLoaded', function () {
      checkLoginStatus();
    });

    // ==================== 登录状态检查 ====================
    function checkLoginStatus() {
      const isLoggedIn = globalState.get('auth.isLoggedIn');
      const user = globalState.get('user');

      if (isLoggedIn && user) {
        showLoggedInUI(user);
      } else {
        showLoggedOutUI();
      }
    }

    // ==================== 已登录UI ====================
    function showLoggedInUI(user) {
      // 隐藏登录卡片，显示用户信息
      document.getElementById('loginCard').style.display = 'none';
      document.getElementById('userInfo').style.display = 'flex';
      document.getElementById('workbenchEntry').style.display = 'block';
      document.getElementById('quickMenu').style.display = 'block';
      document.getElementById('logoutSection').style.display = 'block';

      // 填充用户信息
      document.getElementById('userName').textContent = user.name || '用户';
      document.getElementById('enterpriseName').textContent = user.enterpriseName || '未绑定企业';

      if (user.level) {
        document.getElementById('userLevel').textContent = user.level;
        document.getElementById('userLevel').style.display = 'inline';
      } else {
        document.getElementById('userLevel').style.display = 'none';
      }

      // 获取企业信息
      const enterprise = user.enterpriseId ? MockData.getEnterpriseById(user.enterpriseId) : null;
      if (enterprise) {
        // 更新认证状态
        const verifyStatus = document.getElementById('verifyStatus');
        if (enterprise.status === 'VERIFIED') {
          verifyStatus.innerHTML = `<span><i class="mdi mdi-check-circle"></i></span><span>${enterprise.verifiedLevel}</span>`;
        } else {
          verifyStatus.innerHTML = `<span><i class="mdi mdi-timer-sand"></i></span><span>待认证</span>`;
        }

        // 更新工作台徽章（模拟待处理数量）
        const pendingCount = Math.floor(Math.random() * 5) + 1;
        document.getElementById('workbenchBadge').textContent = pendingCount + '条待处理';
      }
    }

    // ==================== 未登录UI ====================
    function showLoggedOutUI() {
      document.getElementById('loginCard').style.display = 'block';
      document.getElementById('userInfo').style.display = 'none';
      document.getElementById('workbenchEntry').style.display = 'none';
      document.getElementById('quickMenu').style.display = 'none';
      document.getElementById('logoutSection').style.display = 'none';
    }

    // ==================== 登录检查 ====================
    function checkLogin(feature) {
      const isLoggedIn = globalState.get('auth.isLoggedIn');

      if (!isLoggedIn) {
        showToast('请先登录');
        setTimeout(() => {
          window.location.href = '../auth/login.html?redirect=' + encodeURIComponent(window.location.href);
        }, 1000);
        return false;
      }

      // 已登录，显示功能开发中
      const featureNames = {
        inquiries: '询价记录',
        orders: '订单管理',
        deals: '交易记录',
        favorites: '我的收藏',
        trace: '溯源记录',
        contacts: '联系人',
        reports: '数据报表',
        enterprise: '企业信息',
        verify: '认证管理',
        staff: '员工管理'
      };

      showToast(`${featureNames[feature] || feature}功能开发中...`);
      return false;
    }

    // ==================== 显示浏览 ====================
    function showViews() {
      const isLoggedIn = globalState.get('auth.isLoggedIn');
      if (!isLoggedIn) {
        showToast('请先登录');
        return;
      }
      showToast('浏览记录功能开发中...');
    }

    // ==================== 退出登录 ====================
    function doLogout() {
      if (confirm('确定要退出登录吗？')) {
        globalState.set('auth.isLoggedIn', false);
        globalState.set('user', null);
        showToast('已退出登录');
        setTimeout(() => {
          checkLoginStatus();
        }, 500);
      }
    }

    // ==================== 功能入口 ====================
    function showSettings() {
      showToast('设置功能开发中...');
    }

    function showVIP() {
      showToast('VIP功能开发中...');
    }

    function showService() {
      showToast('客服功能开发中...');
    }

    function showAbout() {
      alert('中国牛产业数智云平台\n\n版本：1.0.0\n\n一个连接养殖、贸易、屠宰全链条的数智化交易平台');
    }

    // ==================== Toast ====================
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }
  </script>
</body>

</html>
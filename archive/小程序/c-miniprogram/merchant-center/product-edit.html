<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>编辑商品 - 商家中心</title>
  <link rel="stylesheet" href="../../assets/css/variables.css">
  <link rel="stylesheet" href="../../assets/css/common.css">
  <link rel="stylesheet" href="../../assets/css/mobile.css">
  <style>
    .form-group {
        background: white;
        padding: 15px;
        margin-bottom: 10px;
    }
    .form-label {
        font-size: 14px;
        color: #333;
        margin-bottom: 8px;
        display: block;
    }
    .form-input {
        width: 100%;
        border: none;
        font-size: 15px;
        outline: none;
        padding: 5px 0;
    }
    .img-upload {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    .img-box {
        width: 80px;
        height: 80px;
        background: #f5f5f5;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        font-size: 24px;
        position: relative;
    }
    .img-preview {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 4px;
    }
    .bottom-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        padding: 15px 20px;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        display: flex;
        gap: 15px;
        z-index: 100;
        padding-bottom: calc(15px + env(safe-area-inset-bottom));
        height: auto;
    }
    .btn-submit {
        flex: 1;
        background: var(--primary-gradient); /* Use high-end gradient */
        color: white; /* Contrast text */
        border: none;
        padding: 14px; /* Increased padding */
        border-radius: 25px;
        font-weight: bold;
        font-size: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* Add shadow */
    }
  </style>
</head>
<body>
  <div class="mobile-container">
    <div class="mobile-header">
        <div class="mobile-header-left" onclick="history.back()">←</div>
        <div class="mobile-header-title" id="pageTitle">发布商品</div>
        <div class="mobile-header-right"></div>
    </div>

    <div class="mobile-content" style="padding-top: 60px; padding-bottom: 80px;">
        <div class="form-group">
            <label class="form-label">商品图片</label>
            <div class="img-upload">
                <div class="img-box" id="imgUploadBtn" onclick="Utils.showToast('选择图片', 'info')">+</div>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">商品名称</label>
            <input type="text" class="form-input" id="name" placeholder="请输入商品名称，如：自产有机大米">
        </div>

        <div class="form-group">
            <label class="form-label">商品描述</label>
            <textarea class="form-input" id="desc" rows="3" placeholder="描述商品的产地、口感、特色等"></textarea>
        </div>

        <div class="form-group">
            <label class="form-label">商品分类</label>
            <select class="form-input" id="category" style="background: white;">
                <option value="rice_noodle">米面粮油</option>
                <option value="vegetables">蔬菜果蔬</option>
                <option value="poultry_egg">肉禽蛋品</option>
                <option value="seafood">海鲜水产</option>
            </select>
        </div>

        <div class="form-group">
            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <label class="form-label">出售价格 (元)</label>
                    <input type="number" class="form-input" id="price" placeholder="0.00" style="color: var(--error-color); font-weight: bold;">
                </div>
                <div style="flex: 1;">
                    <label class="form-label">库存数量</label>
                    <input type="number" class="form-input" id="stock" placeholder="0">
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="form-label">规格单位</label>
            <input type="text" class="form-input" id="unit" placeholder="如：5kg/袋，30枚/箱">
        </div>

        <div class="form-group">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <label class="form-label" style="margin: 0;">支持溯源</label>
                <input type="checkbox" id="traceability" checked style="accent-color: var(--primary-color); transform: scale(1.2);">
            </div>
            <div style="font-size: 12px; color: #999; margin-top: 5px;">开启后，需在电脑端录入批次溯源信息</div>
        </div>
    </div>

    <div class="bottom-bar">
        <button class="btn-submit" onclick="submitProduct()">提交审核</button>
    </div>
  </div>

  <script src="../../assets/js/utils.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        if (params.get('id')) {
            document.getElementById('pageTitle').textContent = '编辑商品';
            loadProduct(params.get('id'));
        }
    });

    function loadProduct(id) {
        // Mock Load
        document.getElementById('name').value = '自产有机大米 5kg';
        document.getElementById('desc').value = '自家农场种植，无农药残留，口感软糯。';
        document.getElementById('price').value = '68.00';
        document.getElementById('stock').value = '500';
        document.getElementById('unit').value = '5kg/袋';
        
        // Mock Image
        const imgBox = document.createElement('div');
        imgBox.className = 'img-box';
        imgBox.innerHTML = '<img src="https://images.unsplash.com/photo-1586201375761-83865001e31c?w=200" class="img-preview">';
        document.querySelector('.img-upload').insertBefore(imgBox, document.getElementById('imgUploadBtn'));
    }

    function submitProduct() {
        if (!document.getElementById('name').value) {
            Utils.showToast('请输入商品名称', 'error');
            return;
        }
        if (!document.getElementById('price').value) {
            Utils.showToast('请输入价格', 'error');
            return;
        }

        Utils.showToast('提交成功，等待平台审核', 'success');
        setTimeout(() => {
            history.back();
        }, 1500);
    }
  </script>
</body>
</html>


{"openapi":"3.1.0","info":{"title":"Python Services","description":"Unified Python services for SmartBI analytics and client requirements","version":"2.0.0"},"paths":{"/api/excel/list-sheets":{"post":{"tags":["Excel"],"summary":"List Sheets Detailed","description":"Get detailed information about all sheets in an Excel file.\n\nReturns sheet names, indices, dimensions, and preview headers.\n\n- **file**: Excel file (.xlsx, .xls)","operationId":"list_sheets_detailed_api_excel_list_sheets_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_list_sheets_detailed_api_excel_list_sheets_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListSheetsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/sheets":{"post":{"tags":["Excel"],"summary":"Get Sheet Names","description":"Get all sheet names from an Excel file\n\n- **file**: Excel file (.xlsx, .xls)","operationId":"get_sheet_names_api_excel_sheets_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_get_sheet_names_api_excel_sheets_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SheetNamesResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/detect-header":{"post":{"tags":["Excel"],"summary":"Detect Multi Header","description":"Detect if Excel file has multi-level headers\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_name**: Sheet name to analyze (default: first sheet)\n- **sheet_index**: Sheet index to analyze (0-based)\n- **sheetIndex**: Alias for sheet_index","operationId":"detect_multi_header_api_excel_detect_header_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_detect_multi_header_api_excel_detect_header_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiHeaderDetectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/preview":{"post":{"tags":["Excel"],"summary":"Preview Excel","description":"Preview first N rows of Excel file\n\n- **file**: Excel file\n- **sheet_name**: Sheet name to preview\n- **sheet_index**: Sheet index to preview (0-based)\n- **sheetIndex**: Alias for sheet_index\n- **rows**: Number of rows to preview (default: 10)","operationId":"preview_excel_api_excel_preview_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_preview_excel_api_excel_preview_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/analyze-sheets":{"post":{"tags":["Excel"],"summary":"Analyze Sheets","description":"Analyze Excel sheets using LLM to identify which contain valid analyzable data.\n\nReturns:\n- sheets: List of sheet analysis results\n- recommended: List of recommended sheet indices to analyze\n- summary: Analysis summary\n\n- **file**: Excel file (.xlsx, .xls)","operationId":"analyze_sheets_api_excel_analyze_sheets_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_analyze_sheets_api_excel_analyze_sheets_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SheetAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/auto-parse":{"post":{"tags":["Excel"],"summary":"Auto Parse Excel","description":"Zero-Code Excel Auto-Parse\n\nAutomatically detects Excel structure and maps fields without user configuration.\n\nProcess:\n1. Check cache for previously parsed files\n2. Auto-detect header structure (title rows, merged cells, data start)\n3. Semantically map columns to standard business fields\n4. Extract and standardize data\n\nFeatures:\n- Fully automatic - no headerRow or field mapping configuration needed\n- Multi-layer detection: rules → LLM-fast → LLM-VL → multi-model\n- Result caching for cost optimization\n- Learns from user corrections\n\n- **file**: Excel file (.xlsx, .xls) or CSV\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **sheet_name**: Sheet name to parse (alternative to sheet_index)\n- **sheetName**: Alias for sheet_name (Java client compatibility)\n- **factory_id**: Optional factory ID for custom mappings\n- **use_cache**: Use cached results if available (default: true)\n- **max_rows**: Maximum rows to extract (default: 10000)\n- **skip_empty_rows**: Skip empty rows (default: true)\n- **calculate_stats**: Calculate column statistics (default: true)\n- **transpose**: Transpose data (swap rows and columns, default: false)\n- **header_rows_override**: Manual override for header row count (bypasses auto-detection)\n- **headerRowsOverride**: Alias for header_rows_override (Java client compatibility)","operationId":"auto_parse_excel_api_excel_auto_parse_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_auto_parse_excel_api_excel_auto_parse_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AutoParseResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/auto-parse/feedback":{"post":{"tags":["Excel"],"summary":"Submit Auto Parse Feedback","description":"Submit feedback for auto-parse results to improve future detection.\n\n- **cache_key**: The cache key from auto-parse response\n- **correction_type**: Type of correction (mapping, structure, data_type)\n- **original_value**: The original detected value\n- **correct_value**: The user's corrected value","operationId":"submit_auto_parse_feedback_api_excel_auto_parse_feedback_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_submit_auto_parse_feedback_api_excel_auto_parse_feedback_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/extract-context":{"post":{"tags":["Excel"],"summary":"Extract Context","description":"Extract context information from Excel file.\n\nExtracts:\n- Notes (备注)\n- Compilation explanations (编制说明)\n- Term definitions\n- Metadata (title, unit, period, department)\n\nThis is part of the Three-Layer Data Model:\n- Layer 1: Metadata (title, unit, period)\n- Layer 2: Data (business records)\n- Layer 3: Context (notes, explanations, definitions)\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **data_end_row**: Optional row where data ends (auto-detected if not provided)","operationId":"extract_context_api_excel_extract_context_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_extract_context_api_excel_extract_context_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExtractContextResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export":{"post":{"tags":["Excel"],"summary":"Export Excel","description":"Export Excel file to multiple formats.\n\nSupported formats:\n- **json**: Structured JSON (best for internal processing, storage)\n- **markdown**: Markdown table (best for LLM prompts, ~60.7% accuracy)\n- **csv**: CSV with header comments (best for export, debugging)\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **format**: Output format (json, markdown, csv)\n- **include_metadata**: Include metadata in output (default: true)\n- **max_rows**: Maximum rows to export (default: all for json/csv, 50 for markdown)","operationId":"export_excel_api_excel_export_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_excel_api_excel_export_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/json":{"post":{"tags":["Excel"],"summary":"Export To Json","description":"Export Excel file to JSON format.\n\nBest for: Internal processing, storage, API responses.\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **include_metadata**: Include metadata in output\n- **max_rows**: Maximum rows to export (default: all)","operationId":"export_to_json_api_excel_export_json_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_to_json_api_excel_export_json_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/markdown":{"post":{"tags":["Excel"],"summary":"Export To Markdown","description":"Export Excel file to Markdown format.\n\nBest for: LLM prompts (highest accuracy ~60.7%).\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **include_metadata**: Include metadata header\n- **max_rows**: Maximum rows to include (default: 50 for LLM context limits)","operationId":"export_to_markdown_api_excel_export_markdown_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_to_markdown_api_excel_export_markdown_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/csv":{"post":{"tags":["Excel"],"summary":"Export To Csv","description":"Export Excel file to CSV format.\n\nBest for: Export, debugging, Excel compatibility.\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index\n- **include_metadata**: Include metadata as header comments\n- **max_rows**: Maximum rows to export (default: all)","operationId":"export_to_csv_api_excel_export_csv_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_to_csv_api_excel_export_csv_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/metadata":{"post":{"tags":["Excel"],"summary":"Get Export Metadata","description":"Get metadata and column information without full export.\n\nUseful for previewing data structure before choosing export format.\n\n- **file**: Excel file (.xlsx, .xls)\n- **sheet_index**: Sheet index (0-based, default: 0)\n- **sheetIndex**: Alias for sheet_index","operationId":"get_export_metadata_api_excel_export_metadata_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_get_export_metadata_api_excel_export_metadata_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportMetadataResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/batch":{"post":{"tags":["Excel"],"summary":"Batch Export All Sheets","description":"批量导出Excel所有Sheets。\n\n输出结构：\n- all_sheets.json: 合并的JSON文件（包含所有sheets）\n- md/{sheet_name}.md: 每个sheet的Markdown文件\n- csv/{sheet_name}.csv: 每个sheet的CSV文件\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **max_rows_per_md**: Markdown文件最大行数 (默认500)\n- **return_content**: 是否在响应中返回文件内容 (默认false，仅返回结构信息)","operationId":"batch_export_all_sheets_api_excel_export_batch_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_batch_export_all_sheets_api_excel_export_batch_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/batch/save":{"post":{"tags":["Excel"],"summary":"Batch Export And Save","description":"批量导出并保存到指定目录。\n\n参数:\n- **file**: Excel文件\n- **output_dir**: 输出目录路径\n- **max_rows_per_md**: Markdown文件最大行数","operationId":"batch_export_and_save_api_excel_export_batch_save_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_batch_export_and_save_api_excel_export_batch_save_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/smart-parse/match-rule":{"post":{"tags":["Excel"],"summary":"Match Parse Rule","description":"匹配最佳解析规则（不执行解析）。\n\n用于预览将使用哪个规则，以及可用的规则列表。\n\n参数:\n- **file**: Excel文件\n- **sheet_index**: Sheet索引","operationId":"match_parse_rule_api_excel_smart_parse_match_rule_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_match_parse_rule_api_excel_smart_parse_match_rule_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RuleMatchResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/smart-parse":{"post":{"tags":["Excel"],"summary":"Smart Parse Excel","description":"智能解析Excel - 规则优先，LLM回退。\n\n工作流程:\n1. 快速扫描Excel，提取特征\n2. 尝试匹配已有规则（builtin或custom）\n3. 如无匹配，调用LLM分析结构\n4. 返回解析结果和使用的规则\n\n参数:\n- **file**: Excel文件\n- **sheet_index**: Sheet索引\n- **force_llm**: 强制使用LLM（跳过规则匹配）\n- **preview_rows_count**: 预览行数","operationId":"smart_parse_excel_api_excel_smart_parse_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_smart_parse_excel_api_excel_smart_parse_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SmartParseResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/validate":{"post":{"tags":["Excel"],"summary":"Export With Validation","description":"导出Excel并进行LLM二次核对。\n\n流程:\n1. 解析Excel并导出数据\n2. 规则验证（行数、列数、元信息、备注）\n3. LLM二次核对（如果启用）\n4. 返回导出数据和验证结果\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **sheet_index**: Sheet索引 (默认0)\n- **sheetIndex**: sheet_index的别名\n- **use_llm**: 是否使用LLM二次核对 (默认true)\n- **preview_rows_count**: 响应中预览的行数 (默认20)","operationId":"export_with_validation_api_excel_export_validate_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_with_validation_api_excel_export_validate_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportWithValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/validate-fix":{"post":{"tags":["Excel"],"summary":"Export With Validation And Fix","description":"导出Excel + LLM核对 + 自动修复差异。\n\n流程:\n1. 解析Excel并导出数据\n2. 规则验证 + LLM二次核对\n3. 如果发现差异且启用auto_fix，调用LLM修复\n4. 返回修复后的数据和修复记录\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **sheet_index**: Sheet索引 (默认0)\n- **sheetIndex**: sheet_index的别名\n- **auto_fix**: 发现差异时自动修复 (默认true)\n- **preview_rows_count**: 响应中预览的行数 (默认20)","operationId":"export_with_validation_and_fix_api_excel_export_validate_fix_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_export_with_validation_and_fix_api_excel_export_validate_fix_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExportWithValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/export/batch/validate":{"post":{"tags":["Excel"],"summary":"Batch Export With Validation","description":"批量导出所有Sheets并验证。\n\n对每个Sheet进行:\n1. 导出数据\n2. 规则验证 + LLM二次核对\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **use_llm**: 是否使用LLM核对 (默认true)\n- **max_rows_per_md**: Markdown最大行数","operationId":"batch_export_with_validation_api_excel_export_batch_validate_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_batch_export_with_validation_api_excel_export_batch_validate_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/raw-export":{"post":{"tags":["Excel"],"summary":"Raw Export Excel","description":"原始数据导出 - 100%保真模式\n\n不做任何智能处理，把Excel数据原样导出，保留：\n- 所有行（不猜测表头）\n- 合并单元格信息\n- 原始行号、列号\n- 单元格数据类型\n\n支持格式:\n- **json**: 结构化JSON（完整信息）\n- **json_simple**: 简化JSON（紧凑格式）\n- **markdown**: Markdown表格（适合LLM处理）\n- **csv**: CSV格式（带可选元数据注释）\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **sheet_index**: Sheet索引 (0-based, 默认0)\n- **sheetIndex**: sheet_index的别名\n- **format**: 输出格式 (json/json_simple/markdown/csv)\n- **max_rows**: 最大行数限制（None表示全部）\n- **truncate**: Markdown格式是否截断长单元格（默认True）\n- **include_metadata**: CSV格式是否包含元数据注释（默认True）","operationId":"raw_export_excel_api_excel_raw_export_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_raw_export_excel_api_excel_raw_export_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RawExportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/raw-export/all-sheets":{"post":{"tags":["Excel"],"summary":"Raw Export All Sheets","description":"导出所有Sheets的原始数据\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **format**: 输出格式 (json/json_simple)\n- **max_rows_per_sheet**: 每个Sheet的最大行数","operationId":"raw_export_all_sheets_api_excel_raw_export_all_sheets_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_raw_export_all_sheets_api_excel_raw_export_all_sheets_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/analyze-structure":{"post":{"tags":["Excel"],"summary":"Analyze Excel Structure","description":"使用LLM分析Excel结构\n\n流程:\n1. 使用RawExporter导出原始数据（保真）\n2. 将数据转为Markdown格式\n3. 调用LLM识别表头、数据起始行、列含义\n4. 返回结构化分析结果和分析推荐\n\n输出:\n- structure: 结构分析（表头行、数据起始行、列信息、表格类型）\n- recommendations: 推荐的分析类型和图表\n- insights: 初步洞察\n- warnings: 数据质量警告\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **sheet_index**: Sheet索引 (0-based, 默认0)\n- **sheetIndex**: sheet_index的别名\n- **include_recommendations**: 是否包含分析推荐（默认True）","operationId":"analyze_excel_structure_api_excel_analyze_structure_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_analyze_excel_structure_api_excel_analyze_structure_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LLMAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/smart-analyze":{"post":{"tags":["Excel"],"summary":"Smart Analyze Excel","description":"智能分析Excel - 完整流程\n\n流程:\n1. 原始导出（保真）\n2. LLM结构分析\n3. 基于结构提取数据\n4. 执行推荐的分析\n5. 生成洞察和建议\n\n参数:\n- **file**: Excel文件 (.xlsx, .xls)\n- **sheet_index**: Sheet索引 (0-based, 默认0)\n- **sheetIndex**: sheet_index的别名\n- **max_analyses**: 最多执行的分析数量（默认5）","operationId":"smart_analyze_excel_api_excel_smart_analyze_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_smart_analyze_excel_api_excel_smart_analyze_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/excel/analyze-workbook":{"post":{"tags":["Excel"],"summary":"Analyze Workbook","description":"Analyze all sheets in an Excel workbook with index metadata extraction.\n\nFeatures:\n- Parallel processing of all sheets\n- Index/TOC sheet metadata extraction (report names, descriptions)\n- Chart and insight generation for each sheet\n- Cache support for repeated analysis\n\nReturns:\n- totalSheets: Total number of sheets in workbook\n- successCount: Number of successfully analyzed sheets\n- sheetResults: Analysis results for each sheet (charts, metrics, insights)\n- indexMetadata: If index sheet detected, contains sheet name mappings\n\nArgs:\n- **file**: Excel file (.xlsx, .xls)\n- **factory_id**: Optional factory ID for custom field mappings\n- **skip_empty**: Skip empty sheets (default: true)\n- **skip_index_sheets**: Skip index/TOC sheets from analysis (default: true)\n- **extract_index_metadata**: Extract metadata from index sheet (default: true)\n- **max_rows_per_sheet**: Maximum rows to analyze per sheet (default: 10000)\n- **generate_charts**: Generate chart configurations (default: true)\n- **generate_insights**: Generate AI insights (default: true)","operationId":"analyze_workbook_api_excel_analyze_workbook_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_analyze_workbook_api_excel_analyze_workbook_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiSheetAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/field/detect":{"post":{"tags":["Field Detection"],"summary":"Detect Fields","description":"Detect field types from sample data\n\n- **headers**: Column headers\n- **rows**: Data rows (sample of data)\n\nReturns detected field types including data type, semantic type, and recommended chart role.","operationId":"detect_fields_api_field_detect_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FieldDetectionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FieldDetectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/field/map":{"post":{"tags":["Field Detection"],"summary":"Map Fields","description":"Map detected fields to standard business fields using LLM\n\n- **detectedFields**: List of detected field information from /detect endpoint\n- **context**: Optional business context for better mapping\n\nReturns mapping from source fields to standard business fields.","operationId":"map_fields_api_field_map_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FieldMappingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FieldMappingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/field/chart-config":{"post":{"tags":["Field Detection"],"summary":"Recommend Chart Config","description":"Recommend chart configuration based on detected fields\n\n- **detectedFields**: List of detected field information\n- **analysisGoal**: Optional description of analysis goal\n\nReturns recommended chart types and configurations.","operationId":"recommend_chart_config_api_field_chart_config_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChartConfigRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChartConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/field/types":{"get":{"tags":["Field Detection"],"summary":"Get Field Types","description":"Get available field types and their descriptions","operationId":"get_field_types_api_field_types_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/metrics/calculate":{"post":{"tags":["Metrics"],"summary":"Calculate Metrics","description":"Calculate specified metrics from data\n\n- **data**: List of data records\n- **metrics**: List of metric types to calculate (e.g., [\"sales_amount\", \"gross_margin\"])\n- **groupBy**: Optional fields to group by\n- **timeField**: Optional time dimension field\n- **fieldMapping**: Optional mapping from standard field names to actual column names\n\nSupported metrics:\n- Sales: sales_amount, order_count, avg_order_value, daily_avg_sales\n- Profitability: gross_profit, gross_margin, net_profit, net_margin, roi\n- Cost: material_cost_ratio, labor_cost_ratio, unit_cost\n- Target: target_completion, target_variance\n- Budget: budget_execution_rate, budget_variance\n- Growth: sales_yoy, sales_mom","operationId":"calculate_metrics_api_metrics_calculate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MetricCalculationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MetricCalculationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/metrics/available":{"get":{"tags":["Metrics"],"summary":"Get Available Metrics","description":"Get list of all available metrics with their definitions","operationId":"get_available_metrics_api_metrics_available_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/MetricInfo"},"type":"array","title":"Response Get Available Metrics Api Metrics Available Get"}}}}}}},"/api/metrics/categories":{"get":{"tags":["Metrics"],"summary":"Get Metric Categories","description":"Get metrics organized by category","operationId":"get_metric_categories_api_metrics_categories_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/metrics/batch":{"post":{"tags":["Metrics"],"summary":"Calculate Batch","description":"Calculate metrics for multiple datasets in batch\n\nUseful for calculating same metrics across different time periods or dimensions.","operationId":"calculate_batch_api_metrics_batch_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/MetricCalculationRequest"},"type":"array","title":"Requests"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/forecast/predict":{"post":{"tags":["Forecast"],"summary":"Predict","description":"Generate time series forecast\n\n- **data**: Historical data values (minimum 3 data points)\n- **algorithm**: Forecasting algorithm to use:\n    - `moving_average`: Simple moving average\n    - `linear_trend`: Linear regression-based trend\n    - `exponential_smoothing`: Holt's exponential smoothing\n    - `seasonal_decomposition`: Seasonal decomposition (requires enough data)\n    - `auto`: Automatically select best algorithm (default)\n- **periods**: Number of periods to forecast (1-24)\n- **confidenceLevel**: Confidence level for prediction intervals (0.5-0.99)\n- **seasonality**: Optional seasonal period for seasonal algorithms\n\nReturns predictions with confidence intervals.","operationId":"predict_api_forecast_predict_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForecastRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForecastResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/forecast/accuracy":{"post":{"tags":["Forecast"],"summary":"Calculate Accuracy","description":"Calculate forecast accuracy metrics\n\n- **actual**: Actual observed values\n- **predicted**: Predicted/forecasted values\n\nReturns accuracy metrics:\n- MAE: Mean Absolute Error\n- MSE: Mean Squared Error\n- RMSE: Root Mean Squared Error\n- MAPE: Mean Absolute Percentage Error","operationId":"calculate_accuracy_api_forecast_accuracy_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccuracyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccuracyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/forecast/algorithms":{"get":{"tags":["Forecast"],"summary":"Get Algorithms","description":"Get available forecasting algorithms with descriptions","operationId":"get_algorithms_api_forecast_algorithms_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/forecast/batch":{"post":{"tags":["Forecast"],"summary":"Batch Forecast","description":"Generate forecasts for multiple time series in batch\n\nUseful for forecasting multiple metrics or dimensions simultaneously.","operationId":"batch_forecast_api_forecast_batch_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ForecastRequest"},"type":"array","maxItems":50,"title":"Requests"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/insight/generate":{"post":{"tags":["Insight"],"summary":"Generate Insights","description":"Generate AI-powered business insights from data\n\n- **data**: Data records to analyze\n- **metrics**: Optional pre-calculated metrics (from /metrics/calculate)\n- **analysisContext**: Optional business context for better insights\n- **insightTypes**: Optional filter for insight types:\n    - `trend`: Trend analysis insights\n    - `anomaly`: Anomaly detection insights\n    - `comparison`: Comparison insights\n    - `forecast`: Forecast-based insights\n    - `recommendation`: Actionable recommendations\n    - `summary`: Summary statistics\n- **maxInsights**: Maximum number of insights to return (default: 5)\n\nReturns AI-generated business insights with importance scores.","operationId":"generate_insights_api_insight_generate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InsightRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InsightResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/insight/types":{"get":{"tags":["Insight"],"summary":"Get Insight Types","description":"Get available insight types with descriptions","operationId":"get_insight_types_api_insight_types_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/insight/analyze-metrics":{"post":{"tags":["Insight"],"summary":"Analyze Metrics","description":"Generate insights specifically from pre-calculated metrics\n\n- **metrics**: List of metric calculation results from /metrics/calculate\n\nThis is a convenience endpoint when you only have metrics without raw data.","operationId":"analyze_metrics_api_insight_analyze_metrics_post","requestBody":{"content":{"application/json":{"schema":{"items":{"type":"object"},"type":"array","title":"Metrics"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/insight/quick-summary":{"post":{"tags":["Insight"],"summary":"Quick Summary","description":"Generate a quick summary of the data\n\nReturns basic statistical insights without LLM analysis.\nFaster than full insight generation.","operationId":"quick_summary_api_insight_quick_summary_post","requestBody":{"content":{"application/json":{"schema":{"items":{"type":"object"},"type":"array","title":"Data"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chart/build":{"post":{"tags":["Chart"],"summary":"Build Chart","description":"Build ECharts configuration from data\n\n- **chartType**: Type of chart to build:\n    - `line`: Line chart for trends\n    - `bar`: Bar chart for comparisons\n    - `pie`: Pie chart for proportions\n    - `area`: Area chart for cumulative trends\n    - `scatter`: Scatter chart for correlations\n    - `waterfall`: Waterfall chart for incremental changes\n    - `radar`: Radar chart for multi-dimensional comparison\n    - `funnel`: Funnel chart for conversion analysis\n    - `gauge`: Gauge chart for KPI display\n    - `heatmap`: Heatmap for distribution\n    - `combination`: Combined bar and line chart\n- **data**: Data records\n- **xField**: Field name for X-axis\n- **yFields**: Field names for Y-axis values\n- **seriesField**: Field name for series grouping\n- **title**: Chart title\n- **subtitle**: Chart subtitle\n- **theme**: Color theme (default, dark)\n- **options**: Additional ECharts options to merge\n\nReturns complete ECharts configuration object.","operationId":"build_chart_api_chart_build_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChartBuildRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChartBuildResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chart/types":{"get":{"tags":["Chart"],"summary":"Get Chart Types","description":"Get available chart types with descriptions","operationId":"get_chart_types_api_chart_types_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ChartTypeInfo"},"type":"array","title":"Response Get Chart Types Api Chart Types Get"}}}}}}},"/api/chart/preview":{"post":{"tags":["Chart"],"summary":"Preview Chart","description":"Build chart configuration with sample data for preview\n\nSame as /build but includes additional preview information.","operationId":"preview_chart_api_chart_preview_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChartBuildRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chart/batch":{"post":{"tags":["Chart"],"summary":"Batch Build","description":"Build multiple chart configurations in batch\n\nUseful for dashboard generation with multiple charts.","operationId":"batch_build_api_chart_batch_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ChartBuildRequest"},"type":"array","title":"Requests"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chart/themes":{"get":{"tags":["Chart"],"summary":"Get Themes","description":"Get available chart themes","operationId":"get_themes_api_chart_themes_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/chart/recommend":{"post":{"tags":["Chart"],"summary":"Recommend Chart","description":"Recommend best chart type based on data characteristics\n\n- **data**: Data records\n- **fields**: Optional field detection results from /field/detect\n\nReturns recommended chart types with reasons.","operationId":"recommend_chart_api_chart_recommend_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Body_recommend_chart_api_chart_recommend_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/overview":{"post":{"tags":["Analysis"],"summary":"Get Finance Overview","description":"Get financial overview with key metrics\n\nReturns aggregated financial metrics including:\n- Total revenue\n- Total cost\n- Gross profit and margin\n- Net profit and margin\n- Period-over-period changes\n\n- **data**: List of financial data records\n- **periodType**: Period type for aggregation (day, week, month, quarter, year)\n- **fieldMapping**: Optional mapping from standard field names to actual column names","operationId":"get_finance_overview_api_analysis_finance_overview_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FinanceOverviewRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/profit-trend":{"post":{"tags":["Analysis"],"summary":"Get Profit Trend","description":"Analyze profit trends over time\n\nReturns time series data showing:\n- Revenue trend\n- Cost trend\n- Profit trend\n- Margin changes\n\n- **data**: List of financial data records\n- **periodType**: Period type for trend analysis\n- **periods**: Number of periods to include\n- **fieldMapping**: Optional field mapping","operationId":"get_profit_trend_api_analysis_finance_profit_trend_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfitTrendRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/cost-structure":{"post":{"tags":["Analysis"],"summary":"Get Cost Structure","description":"Analyze cost structure breakdown\n\nReturns cost breakdown by category:\n- Material costs\n- Labor costs\n- Overhead costs\n- Other costs\n- Percentage of each category\n\n- **data**: List of cost data records\n- **groupBy**: Optional field to group costs by\n- **fieldMapping**: Optional field mapping","operationId":"get_cost_structure_api_analysis_finance_cost_structure_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CostStructureRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/budget-waterfall":{"post":{"tags":["Analysis"],"summary":"Get Budget Waterfall","description":"Generate budget waterfall chart data\n\nReturns waterfall data showing:\n- Starting budget\n- Incremental changes by category\n- Final actual value\n- Variance explanations\n\n- **data**: List of budget/actual data records\n- **budgetField**: Field name for budget values\n- **actualField**: Field name for actual values\n- **fieldMapping**: Optional field mapping","operationId":"get_budget_waterfall_api_analysis_finance_budget_waterfall_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetWaterfallRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/budget-vs-actual":{"post":{"tags":["Analysis"],"summary":"Get Budget Vs Actual","description":"Compare budget vs actual values\n\nReturns comparison data:\n- Budget values by period/category\n- Actual values by period/category\n- Variance amount and percentage\n- Achievement rate\n\n- **data**: List of budget/actual data records\n- **periodType**: Period type for comparison\n- **fieldMapping**: Optional field mapping","operationId":"get_budget_vs_actual_api_analysis_finance_budget_vs_actual_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetVsActualRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/yoy-mom":{"post":{"tags":["Analysis"],"summary":"Get Yoy Mom Comparison","description":"Year-over-Year and Month-over-Month comparison\n\nReturns comparison data:\n- YoY growth rates\n- MoM growth rates\n- Period-by-period comparison\n- Trend indicators\n\n- **data**: List of time series data records\n- **year1**: First year for comparison\n- **year2**: Second year for comparison\n- **metric**: Metric to compare\n- **fieldMapping**: Optional field mapping","operationId":"get_yoy_mom_comparison_api_analysis_finance_yoy_mom_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/YoYMoMRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/category-comparison":{"post":{"tags":["Analysis"],"summary":"Get Category Comparison","description":"Compare category structure across periods\n\nReturns comparison data:\n- Category distribution for each period\n- Changes in category proportions\n- Growth/decline by category\n\n- **data**: List of categorized data records\n- **categoryField**: Field name for category\n- **periodField**: Field name for time period\n- **fieldMapping**: Optional field mapping","operationId":"get_category_comparison_api_analysis_finance_category_comparison_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CategoryComparisonRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/kpis":{"post":{"tags":["Analysis"],"summary":"Get Sales Kpis","description":"Get key sales KPIs\n\nReturns sales KPI metrics:\n- Total sales amount\n- Order count\n- Average order value\n- Target completion rate (if target data provided)\n- Growth indicators\n\n- **data**: List of sales data records\n- **targetData**: Optional target data for completion rate\n- **fieldMapping**: Optional field mapping","operationId":"get_sales_kpis_api_analysis_sales_kpis_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SalesKPIsRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/ranking/salesperson":{"post":{"tags":["Analysis"],"summary":"Get Salesperson Ranking","description":"Get salesperson performance ranking\n\nReturns ranked list of salespeople:\n- Salesperson name/ID\n- Total sales amount\n- Order count\n- Average order value\n- Rank and percentage of total\n\n- **data**: List of sales data records\n- **topN**: Number of top salespeople to return\n- **rankBy**: Metric to rank by (sales_amount, order_count, etc.)\n- **fieldMapping**: Optional field mapping","operationId":"get_salesperson_ranking_api_analysis_sales_ranking_salesperson_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/ranking/product":{"post":{"tags":["Analysis"],"summary":"Get Product Ranking","description":"Get product sales ranking\n\nReturns ranked list of products:\n- Product name/ID\n- Total sales amount\n- Units sold\n- Average unit price\n- Rank and percentage of total\n\n- **data**: List of sales data records\n- **topN**: Number of top products to return\n- **rankBy**: Metric to rank by (sales_amount, quantity, etc.)\n- **fieldMapping**: Optional field mapping","operationId":"get_product_ranking_api_analysis_sales_ranking_product_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/trend":{"post":{"tags":["Analysis"],"summary":"Get Sales Trend","description":"Analyze sales trends over time\n\nReturns time series data:\n- Sales amount by period\n- Order count by period\n- Growth rate by period\n- Moving averages\n\n- **data**: List of sales data records\n- **periodType**: Period type for trend analysis\n- **periods**: Number of periods to include\n- **fieldMapping**: Optional field mapping","operationId":"get_sales_trend_api_analysis_sales_trend_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SalesTrendRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/region-distribution":{"post":{"tags":["Analysis"],"summary":"Get Region Distribution","description":"Analyze sales distribution by region\n\nReturns regional breakdown:\n- Sales amount by region\n- Percentage of total by region\n- Order count by region\n- Regional growth rates\n\n- **data**: List of sales data records with region information\n- **regionField**: Field name for region\n- **fieldMapping**: Optional field mapping","operationId":"get_region_distribution_api_analysis_sales_region_distribution_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegionDistributionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/sales/customer-analysis":{"post":{"tags":["Analysis"],"summary":"Get Customer Analysis","description":"Analyze customer purchasing behavior\n\nReturns customer analysis:\n- Top customers by sales\n- Customer count\n- Average customer value\n- Repeat purchase rate\n- Customer segmentation\n\n- **data**: List of sales data records with customer information\n- **customerField**: Field name for customer identifier\n- **topN**: Number of top customers to return\n- **fieldMapping**: Optional field mapping","operationId":"get_customer_analysis_api_analysis_sales_customer_analysis_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CustomerAnalysisRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/ranking":{"post":{"tags":["Analysis"],"summary":"Get Department Ranking","description":"Get department performance ranking\n\nReturns ranked list of departments:\n- Department name/ID\n- Sales amount\n- Order count\n- Target achievement rate\n- Rank and percentage of total\n\n- **data**: List of sales data records with department information\n- **topN**: Number of top departments to return\n- **metric**: Metric to rank by\n- **fieldMapping**: Optional field mapping","operationId":"get_department_ranking_api_analysis_department_ranking_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentRankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/detail":{"post":{"tags":["Analysis"],"summary":"Get Department Detail","description":"Get detailed analysis for a specific department\n\nReturns:\n- Department KPIs\n- Sales breakdown\n- Performance metrics\n- Historical trends\n\n- **data**: List of data records\n- **departmentId**: Department ID or name\n- **fieldMapping**: Optional field mapping","operationId":"get_department_detail_api_analysis_department_detail_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentDetailRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/completion-rates":{"post":{"tags":["Analysis"],"summary":"Get Department Completion Rates","description":"Get target completion rates by department\n\nReturns:\n- Department name\n- Target value\n- Actual value\n- Completion rate percentage\n- Variance\n\n- **data**: List of data records with department performance\n- **targetData**: Optional separate target data\n- **fieldMapping**: Optional field mapping","operationId":"get_department_completion_rates_api_analysis_department_completion_rates_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentCompletionRatesRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/efficiency-matrix":{"post":{"tags":["Analysis"],"summary":"Get Department Efficiency Matrix","description":"Get efficiency matrix across departments\n\nReturns matrix data:\n- Department names\n- Multiple efficiency metrics per department\n- Normalized scores\n- Radar chart ready data\n\n- **data**: List of data records\n- **metrics**: List of metrics to include\n- **fieldMapping**: Optional field mapping","operationId":"get_department_efficiency_matrix_api_analysis_department_efficiency_matrix_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentEfficiencyMatrixRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/trend-comparison":{"post":{"tags":["Analysis"],"summary":"Get Department Trend Comparison","description":"Compare trends across multiple departments\n\nReturns:\n- Time series data for each department\n- Growth rates\n- Comparison metrics\n\n- **data**: List of data records\n- **departments**: List of department IDs to compare\n- **periodType**: Period type for trend\n- **fieldMapping**: Optional field mapping","operationId":"get_department_trend_comparison_api_analysis_department_trend_comparison_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentTrendComparisonRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/department/share-trend":{"post":{"tags":["Analysis"],"summary":"Get Department Share Trend","description":"Get department market share trends over time\n\nReturns:\n- Period labels\n- Share percentage per department per period\n- Trend indicators\n\n- **data**: List of data records\n- **periodType**: Period type for trend\n- **periods**: Number of periods to analyze\n- **fieldMapping**: Optional field mapping","operationId":"get_department_share_trend_api_analysis_department_share_trend_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DepartmentShareTrendRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/ranking":{"post":{"tags":["Analysis"],"summary":"Get Region Ranking","description":"Get region performance ranking\n\nReturns ranked list of regions:\n- Region name\n- Sales amount\n- Order count\n- Growth rate\n- Rank and percentage\n\n- **data**: List of data records with region information\n- **topN**: Number of top regions to return\n- **metric**: Metric to rank by\n- **level**: Region level (region, province, city)\n- **fieldMapping**: Optional field mapping","operationId":"get_region_ranking_api_analysis_region_ranking_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegionRankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/province-ranking":{"post":{"tags":["Analysis"],"summary":"Get Province Ranking","description":"Get province-level performance ranking\n\nReturns ranked list of provinces:\n- Province name\n- Sales amount\n- Order count\n- City count\n- Rank and percentage\n\n- **data**: List of data records with province information\n- **topN**: Number of top provinces to return\n- **metric**: Metric to rank by\n- **fieldMapping**: Optional field mapping","operationId":"get_province_ranking_api_analysis_region_province_ranking_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProvinceRankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/city-ranking":{"post":{"tags":["Analysis"],"summary":"Get City Ranking","description":"Get city-level performance ranking\n\nReturns ranked list of cities:\n- City name\n- Province\n- Sales amount\n- Order count\n- Rank and percentage\n\n- **data**: List of data records with city information\n- **topN**: Number of top cities to return\n- **metric**: Metric to rank by\n- **province**: Optional filter by province\n- **fieldMapping**: Optional field mapping","operationId":"get_city_ranking_api_analysis_region_city_ranking_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CityRankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/detail":{"post":{"tags":["Analysis"],"summary":"Get Region Detail","description":"Get detailed analysis for a specific region\n\nReturns:\n- Region KPIs\n- Sub-region breakdown\n- Performance metrics\n- Historical trends\n\n- **data**: List of data records\n- **regionId**: Region ID or name\n- **fieldMapping**: Optional field mapping","operationId":"get_region_detail_api_analysis_region_detail_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegionDetailRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/trend":{"post":{"tags":["Analysis"],"summary":"Get Region Trend","description":"Get trend analysis for a specific region\n\nReturns:\n- Time series data\n- Growth rates\n- Trend indicators\n\n- **data**: List of data records\n- **regionId**: Region ID or name\n- **periodType**: Period type for trend\n- **periods**: Number of periods\n- **fieldMapping**: Optional field mapping","operationId":"get_region_trend_api_analysis_region_trend_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegionTrendRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/heatmap":{"post":{"tags":["Analysis"],"summary":"Get Geographic Heatmap Data","description":"Get geographic heatmap data\n\nReturns:\n- Geographic coordinates or region codes\n- Intensity values for heatmap\n- Legend configuration\n\n- **data**: List of data records with geographic information\n- **metric**: Metric for heatmap intensity\n- **level**: Geographic level (province, city)\n- **fieldMapping**: Optional field mapping","operationId":"get_geographic_heatmap_data_api_analysis_region_heatmap_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GeographicHeatmapRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/opportunity-scores":{"post":{"tags":["Analysis"],"summary":"Get Region Opportunity Scores","description":"Get opportunity scores by region\n\nReturns:\n- Region name\n- Opportunity score\n- Contributing factors\n- Recommendations\n\n- **data**: List of data records\n- **factors**: Factors to include in scoring\n- **fieldMapping**: Optional field mapping","operationId":"get_region_opportunity_scores_api_analysis_region_opportunity_scores_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegionOpportunityScoresRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/region/hierarchy":{"post":{"tags":["Analysis"],"summary":"Get Hierarchy Data","description":"Get hierarchical region data\n\nReturns:\n- Tree structure of regions\n- Aggregated values at each level\n- Drill-down capabilities\n\n- **data**: List of data records\n- **level**: Hierarchy level to return\n- **fieldMapping**: Optional field mapping","operationId":"get_hierarchy_data_api_analysis_region_hierarchy_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HierarchyDataRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/ar-aging":{"post":{"tags":["Analysis"],"summary":"Get Receivable Aging","description":"Get accounts receivable aging analysis\n\nReturns:\n- Aging buckets (current, 30 days, 60 days, 90+ days)\n- Amount in each bucket\n- Percentage distribution\n- Risk indicators\n\n- **data**: List of receivable records\n- **agingBuckets**: Custom aging bucket boundaries\n- **fieldMapping**: Optional field mapping","operationId":"get_receivable_aging_api_analysis_finance_ar_aging_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReceivableAgingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/ar-metrics":{"post":{"tags":["Analysis"],"summary":"Get Receivable Metrics","description":"Get accounts receivable key metrics\n\nReturns:\n- Total receivables\n- Days Sales Outstanding (DSO)\n- Collection rate\n- Bad debt ratio\n\n- **data**: List of receivable records\n- **fieldMapping**: Optional field mapping","operationId":"get_receivable_metrics_api_analysis_finance_ar_metrics_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReceivableMetricsRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/overdue-customers":{"post":{"tags":["Analysis"],"summary":"Get Overdue Customer Ranking","description":"Get ranking of customers with overdue receivables\n\nReturns:\n- Customer name\n- Overdue amount\n- Days overdue\n- Payment history\n- Risk level\n\n- **data**: List of receivable records\n- **topN**: Number of top overdue customers\n- **fieldMapping**: Optional field mapping","operationId":"get_overdue_customer_ranking_api_analysis_finance_overdue_customers_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OverdueCustomerRankingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/ap-aging":{"post":{"tags":["Analysis"],"summary":"Get Payable Aging","description":"Get accounts payable aging analysis\n\nReturns:\n- Aging buckets (current, 30 days, 60 days, 90+ days)\n- Amount in each bucket\n- Percentage distribution\n- Payment schedule\n\n- **data**: List of payable records\n- **agingBuckets**: Custom aging bucket boundaries\n- **fieldMapping**: Optional field mapping","operationId":"get_payable_aging_api_analysis_finance_ap_aging_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayableAgingRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/budget-execution-waterfall":{"post":{"tags":["Analysis"],"summary":"Get Budget Execution Waterfall","description":"Get budget execution waterfall chart data\n\nReturns:\n- Starting budget\n- Category-wise execution changes\n- Final executed amount\n- Variance breakdown\n\n- **data**: List of budget execution records\n- **categoryField**: Field name for budget category\n- **fieldMapping**: Optional field mapping","operationId":"get_budget_execution_waterfall_api_analysis_finance_budget_execution_waterfall_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetExecutionWaterfallRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/budget-achievement":{"post":{"tags":["Analysis"],"summary":"Get Budget Achievement By Period","description":"Get budget achievement rates by period\n\nReturns:\n- Period labels\n- Budget values per period\n- Actual values per period\n- Achievement rate per period\n- Cumulative achievement\n\n- **data**: List of budget/actual records\n- **periodType**: Period type for aggregation\n- **fieldMapping**: Optional field mapping","operationId":"get_budget_achievement_by_period_api_analysis_finance_budget_achievement_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetAchievementByPeriodRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/finance/multi-year-comparison":{"post":{"tags":["Analysis"],"summary":"Get Multi Year Comparison","description":"Compare financial metrics across multiple years\n\nReturns:\n- Year labels\n- Metric values per year\n- Year-over-year growth rates\n- CAGR (Compound Annual Growth Rate)\n\n- **data**: List of multi-year financial records\n- **years**: List of years to compare\n- **metric**: Metric to compare\n- **fieldMapping**: Optional field mapping","operationId":"get_multi_year_comparison_api_analysis_finance_multi_year_comparison_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiYearComparisonRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/analysis/available":{"get":{"tags":["Analysis"],"summary":"Get Available Analyses","description":"Get list of all available analysis types","operationId":"get_available_analyses_api_analysis_available_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/ml/least-squares":{"post":{"tags":["ML"],"summary":"Solve Least Squares","description":"Solve least squares problem: minimize ||Ax - b||^2\n\nThis endpoint provides efficient numerical solution for least squares problems,\ncommonly used for:\n- Linear regression\n- System identification\n- Individual efficiency decomposition from team performance data\n\n**Methods available:**\n- `ridge`: Ridge regression with Tikhonov regularization (default, most stable)\n- `lstsq`: Standard least squares via LAPACK (fastest for well-conditioned matrices)\n- `svd`: SVD-based pseudo-inverse (best for ill-conditioned matrices)\n\n**Example:**\n```json\n{\n  \"matrixA\": [[1, 1], [2, 1], [3, 1]],\n  \"vectorB\": [2, 4, 5],\n  \"regularization\": 0.001,\n  \"method\": \"ridge\"\n}\n```\n\nReturns the solution vector x and diagnostic metrics.","operationId":"solve_least_squares_api_ml_least_squares_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeastSquaresRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeastSquaresResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/ml/validate-matrix":{"post":{"tags":["ML"],"summary":"Validate Matrix","description":"Validate matrix and vector for least squares solving\n\nReturns information about the matrix properties without actually solving.\nUseful for diagnosing numerical issues before running the full computation.\n\n**Diagnostics provided:**\n- Matrix dimensions and rank\n- Condition number (indicates numerical stability)\n- Whether matrix has NaN or Inf values\n- Recommended solving method","operationId":"validate_matrix_api_ml_validate_matrix_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MatrixValidationRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MatrixValidationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/ml/methods":{"get":{"tags":["ML"],"summary":"Get Methods","description":"Get available solving methods with descriptions","operationId":"get_methods_api_ml_methods_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/ml/batch":{"post":{"tags":["ML"],"summary":"Batch Solve","description":"Solve multiple least squares problems in batch\n\nUseful for processing multiple independent systems simultaneously.","operationId":"batch_solve_api_ml_batch_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/LeastSquaresRequest"},"type":"array","title":"Requests"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/compute-ucb":{"post":{"tags":["LinUCB"],"summary":"Compute Ucb","description":"Compute UCB for a single worker.\n\nUCB(a) = theta^T * x + alpha * sqrt(x^T * A^(-1) * x)\n\nWhere:\n- theta = A^(-1) * b (parameter vector)\n- x = context features\n- alpha = exploration parameter\n\n**Use case:** Calculate the UCB score for a specific worker given their model\nparameters and the current task context.\n\n**Example:**\n```json\n{\n  \"matrixA\": [[1.0, 0.0], [0.0, 1.0]],\n  \"vectorB\": [0.5, 0.3],\n  \"context\": [1.0, 0.5],\n  \"alpha\": 0.5\n}\n```","operationId":"compute_ucb_api_linucb_compute_ucb_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComputeUCBRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ComputeUCBResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/update-model":{"post":{"tags":["LinUCB"],"summary":"Update Model","description":"Update LinUCB model with feedback.\n\nUpdates the model parameters after observing a reward:\n- A_new = A + x * x^T (outer product update)\n- b_new = b + r * x (reward-weighted feature accumulation)\n\n**Use case:** Update a worker's model after task completion with the observed reward.\n\n**Example:**\n```json\n{\n  \"matrixA\": [[1.0, 0.0], [0.0, 1.0]],\n  \"vectorB\": [0.0, 0.0],\n  \"context\": [1.0, 0.5],\n  \"reward\": 0.85\n}\n```","operationId":"update_model_api_linucb_update_model_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateModelRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateModelResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/batch-compute":{"post":{"tags":["LinUCB"],"summary":"Batch Compute","description":"Batch compute UCB for multiple workers.\n\nComputes UCB scores for multiple workers in a single request, which is more\nefficient than making N individual requests when recommending from a candidate list.\n\n**Use case:** Rank multiple candidate workers for a task based on their UCB scores.\n\n**Example:**\n```json\n{\n  \"matrixAList\": [\n    [[1.0, 0.0], [0.0, 1.0]],\n    [[1.5, 0.1], [0.1, 1.5]]\n  ],\n  \"vectorBList\": [\n    [0.5, 0.3],\n    [0.8, 0.4]\n  ],\n  \"context\": [1.0, 0.5],\n  \"alpha\": 0.5\n}\n```","operationId":"batch_compute_api_linucb_batch_compute_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchComputeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchComputeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/initialize":{"post":{"tags":["LinUCB"],"summary":"Initialize","description":"Create initial LinUCB model parameters.\n\nInitializes a new LinUCB model with:\n- A = lambda * I (identity matrix scaled by regularization)\n- A^(-1) = I / lambda\n- b = 0 (zero vector)\n\n**Use case:** Initialize model parameters for a new worker.\n\n**Example:**\n```json\n{\n  \"featureDim\": 16,\n  \"regularization\": 1.0\n}\n```","operationId":"initialize_api_linucb_initialize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InitializeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InitializeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/validate":{"post":{"tags":["LinUCB"],"summary":"Validate","description":"Validate LinUCB model parameters.\n\nChecks model parameters for numerical stability and correctness:\n- Matrix dimensions and symmetry\n- Positive definiteness (required for LinUCB)\n- Condition number (numerical stability indicator)\n- Presence of NaN/Inf values\n\n**Use case:** Diagnose model health before using it for recommendations.\n\n**Example:**\n```json\n{\n  \"matrixA\": [[1.0, 0.0], [0.0, 1.0]],\n  \"vectorB\": [0.5, 0.3]\n}\n```","operationId":"validate_api_linucb_validate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/linucb/info":{"get":{"tags":["LinUCB"],"summary":"Get Info","description":"Get LinUCB service information and default parameters.","operationId":"get_info_api_linucb_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/chat/drill-down":{"post":{"tags":["Chat","Chat"],"summary":"Drill Down","description":"Perform drill-down analysis on a dimension.\n\nCalled by Java when user asks questions like:\n- \"按区域拆分看看\"\n- \"华东区具体怎么样\"\n- \"深入分析产品类别\"\n\nArgs:\n    request: DrillDownRequest with dimension and filter parameters\n\nReturns:\n    DrillDownResponse with detailed breakdown and chart config","operationId":"drill_down_api_chat_drill_down_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DrillDownRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DrillDownResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/benchmark":{"post":{"tags":["Chat","Chat"],"summary":"Benchmark","description":"Compare metrics with industry benchmarks.\n\nCalled by Java when user asks questions like:\n- \"跟行业比怎么样\"\n- \"我们的毛利率在行业什么水平\"\n- \"对标同行业\"\n\nArgs:\n    request: BenchmarkRequest with industry and metrics\n\nReturns:\n    BenchmarkResponse with comparison results and recommendations","operationId":"benchmark_api_chat_benchmark_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BenchmarkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BenchmarkResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/root-cause":{"post":{"tags":["Chat","Chat"],"summary":"Root Cause","description":"Analyze root causes for a KPI change.\n\nCalled by Java when user asks questions like:\n- \"为什么利润下降\"\n- \"分析销售额下滑原因\"\n- \"利润率降低的原因是什么\"\n\nArgs:\n    request: RootCauseRequest with KPI and threshold\n\nReturns:\n    RootCauseResponse with identified causes and recommendations","operationId":"root_cause_api_chat_root_cause_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RootCauseRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RootCauseResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/general-analysis":{"post":{"tags":["Chat","Chat"],"summary":"General Analysis","description":"Perform general analysis based on query.\n\nCalled by Java for general questions about the data.\n\nArgs:\n    request: GeneralAnalysisRequest with query and data\n\nReturns:\n    GeneralAnalysisResponse with analysis results","operationId":"general_analysis_api_chat_general_analysis_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GeneralAnalysisRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GeneralAnalysisResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/multi-dimension":{"post":{"tags":["Chat","Chat"],"summary":"Multi Dimension Analysis","description":"Perform multi-dimensional insight analysis.\n\nGenerates insights across multiple dimensions:\n- What happened (descriptive)\n- Why it happened (diagnostic)\n- What will happen (predictive)\n- What to do (prescriptive)\n\nArgs:\n    request: MultiDimensionRequest with data and optional dimensions\n\nReturns:\n    MultiDimensionResponse with comprehensive insights","operationId":"multi_dimension_analysis_api_chat_multi_dimension_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiDimensionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MultiDimensionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/health":{"get":{"tags":["Chat","Chat"],"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_api_chat_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/smartbi/cross-sheet-analysis":{"post":{"tags":["Cross-Sheet Analysis","Cross-Sheet Analysis"],"summary":"Cross Sheet Analysis","description":"Perform cross-sheet comprehensive analysis.\n\n1. Fetches data from all specified uploads\n2. Extracts key numeric KPIs per sheet\n3. Builds comparison charts\n4. Generates AI-powered cross-sheet insights\n\nArgs:\n    request: CrossSheetRequest with upload IDs and sheet names\n\nReturns:\n    CrossSheetResponse with KPI comparison, charts, and AI summary","operationId":"cross_sheet_analysis_api_smartbi_cross_sheet_analysis_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrossSheetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CrossSheetResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/smartbi/yoy-comparison":{"post":{"tags":["YoY Comparison","YoY Comparison"],"summary":"Yoy Comparison","description":"Compare two uploads for Year-over-Year analysis.\n\nMatches financial rows by keyword and computes growth rates.\nIf compare_upload_id is not provided, attempts to find the most recent\nprevious upload with a similar sheet structure.","operationId":"yoy_comparison_api_smartbi_yoy_comparison_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/YoYRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/YoYResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/classifier/classify":{"post":{"tags":["Intent Classifier"],"summary":"Classify Intent","description":"对单条文本进行意图分类\n\nArgs:\n    request: 包含 text, top_k, threshold 的请求体\n\nReturns:\n    分类结果，兼容 Java ClassifierIntentMatcher","operationId":"classify_intent_api_classifier_classify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/classifier/classify/batch":{"post":{"tags":["Intent Classifier"],"summary":"Classify Intent Batch","description":"批量意图分类\n\nArgs:\n    request: 包含 texts 列表的请求体\n\nReturns:\n    分类结果列表","operationId":"classify_intent_batch_api_classifier_classify_batch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyBatchRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/classifier/confidence":{"post":{"tags":["Intent Classifier"],"summary":"Get Intent Confidence","description":"获取特定意图的置信度\n\nArgs:\n    request: 包含 text 和 intent_code 的请求体\n\nReturns:\n    指定意图的置信度","operationId":"get_intent_confidence_api_classifier_confidence_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfidenceRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/classifier/load":{"post":{"tags":["Intent Classifier"],"summary":"Load Model","description":"加载或重新加载模型\n\nArgs:\n    request: 包含 model_path 的请求体\n\nReturns:\n    加载结果","operationId":"load_model_api_classifier_load_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoadModelRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/classifier/info":{"get":{"tags":["Intent Classifier"],"summary":"Get Model Info","description":"获取模型信息\n\nReturns:\n    模型状态和配置信息，兼容 Java ModelInfoResponse","operationId":"get_model_info_api_classifier_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/classifier/health":{"get":{"tags":["Intent Classifier"],"summary":"Classifier Health","description":"分类器健康检查\n\nReturns:\n    服务健康状态，兼容 Java HealthResponse","operationId":"classifier_health_api_classifier_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/smartbi/analysis/db/overview":{"post":{"tags":["Database Analysis","Database Analysis"],"summary":"Analyze From Db","description":"Analyze data from PostgreSQL and return dashboard response.\n\nReads dynamic data from PostgreSQL, auto-detects analysis type,\nand returns KPIs, charts, and insights.","operationId":"analyze_from_db_api_smartbi_analysis_db_overview_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnalyzeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/smartbi/analysis/db/aggregate":{"post":{"tags":["Database Analysis","Database Analysis"],"summary":"Aggregate From Db","description":"Dynamic aggregation query on PostgreSQL JSONB data.\n\nUses PostgreSQL native JSONB operators with GIN index support\nfor efficient aggregation.","operationId":"aggregate_from_db_api_smartbi_analysis_db_aggregate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AggregateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AggregateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/smartbi/analysis/db/fields/{upload_id}":{"get":{"tags":["Database Analysis","Database Analysis"],"summary":"Get Field Definitions","description":"Get field definitions for an upload.\n\nReturns metadata about each field including type, semantic type,\nand chart role for frontend rendering.","operationId":"get_field_definitions_api_smartbi_analysis_db_fields__upload_id__get","parameters":[{"name":"upload_id","in":"path","required":true,"schema":{"type":"integer","title":"Upload Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/smartbi/analysis/db/distinct/{upload_id}":{"get":{"tags":["Database Analysis","Database Analysis"],"summary":"Get Distinct Values","description":"Get distinct values for a field (for filter dropdowns).","operationId":"get_distinct_values_api_smartbi_analysis_db_distinct__upload_id__get","parameters":[{"name":"upload_id","in":"path","required":true,"schema":{"type":"integer","title":"Upload Id"}},{"name":"factory_id","in":"query","required":true,"schema":{"type":"string","title":"Factory Id"}},{"name":"field_name","in":"query","required":true,"schema":{"type":"string","title":"Field Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/smartbi/analysis/db/health":{"get":{"tags":["Database Analysis","Database Analysis"],"summary":"Db Health Check","description":"Check PostgreSQL connection health","operationId":"db_health_check_api_smartbi_analysis_db_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/client-requirement/login":{"post":{"tags":["Client Requirement"],"summary":"Login","description":"客户登录 - 输入公司名 → 返回companyId + 已有反馈","operationId":"login_api_client_requirement_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/client-requirement/save":{"post":{"tags":["Client Requirement"],"summary":"Save","description":"批量保存反馈项 (upsert)","operationId":"save_api_client_requirement_save_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SaveRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/client-requirement/companies":{"get":{"tags":["Client Requirement"],"summary":"List Companies","description":"管理端: 所有公司列表 + 完成度","operationId":"list_companies_api_client_requirement_companies_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/client-requirement/{company_id}":{"get":{"tags":["Client Requirement"],"summary":"Get Company Feedback","description":"管理端: 某公司完整反馈","operationId":"get_company_feedback_api_client_requirement__company_id__get","parameters":[{"name":"company_id","in":"path","required":true,"schema":{"type":"string","title":"Company Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint with service information","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AccuracyRequest":{"properties":{"actual":{"items":{"type":"number"},"type":"array","title":"Actual"},"predicted":{"items":{"type":"number"},"type":"array","title":"Predicted"}},"type":"object","required":["actual","predicted"],"title":"AccuracyRequest","description":"Accuracy calculation request model"},"AccuracyResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"mae":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Mae"},"mse":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Mse"},"rmse":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Rmse"},"mape":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Mape"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"AccuracyResponse","description":"Accuracy calculation response model"},"AggregateRequest":{"properties":{"factory_id":{"type":"string","title":"Factory Id"},"upload_id":{"type":"integer","title":"Upload Id"},"group_field":{"type":"string","title":"Group Field"},"measure_field":{"type":"string","title":"Measure Field"},"agg_func":{"type":"string","title":"Agg Func","default":"SUM"}},"type":"object","required":["factory_id","upload_id","group_field","measure_field"],"title":"AggregateRequest"},"AggregateResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"data":{"items":{"type":"object"},"type":"array","title":"Data"},"groupField":{"type":"string","title":"Groupfield"},"measureField":{"type":"string","title":"Measurefield"},"total":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total"}},"type":"object","required":["success","data","groupField","measureField"],"title":"AggregateResponse"},"AnalysisRecommendationModel":{"properties":{"analysis_type":{"type":"string","title":"Analysis Type"},"description":{"type":"string","title":"Description"},"priority":{"type":"integer","title":"Priority"},"chart_types":{"items":{"type":"string"},"type":"array","title":"Chart Types"},"required_columns":{"items":{"type":"string"},"type":"array","title":"Required Columns"}},"type":"object","required":["analysis_type","description","priority","chart_types","required_columns"],"title":"AnalysisRecommendationModel","description":"分析推荐模型"},"AnalysisResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"data":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Data"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"AnalysisResponse","description":"Standard analysis response model"},"AnalyzeRequest":{"properties":{"factory_id":{"type":"string","title":"Factory Id"},"upload_id":{"type":"integer","title":"Upload Id"},"analysis_type":{"type":"string","title":"Analysis Type","default":"auto"}},"type":"object","required":["factory_id","upload_id"],"title":"AnalyzeRequest"},"AutoParseResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"errorMessage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Errormessage"},"headers":{"items":{"type":"string"},"type":"array","title":"Headers","default":[]},"rowCount":{"type":"integer","title":"Rowcount","default":0},"columnCount":{"type":"integer","title":"Columncount","default":0},"fieldMappings":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Fieldmappings"},"dataFeatures":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Datafeatures"},"previewData":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Previewdata"},"missingRequiredFields":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Missingrequiredfields"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"rows":{"items":{"items":{},"type":"array"},"type":"array","title":"Rows","default":[]},"direction":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direction"},"sheetNames":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Sheetnames"},"currentSheet":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Currentsheet"},"autoDetected":{"type":"boolean","title":"Autodetected","default":true},"tableType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tabletype"},"linkedSheets":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Linkedsheets"},"structure":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Structure"},"unmappedFields":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Unmappedfields"},"originalHeaders":{"items":{"type":"string"},"type":"array","title":"Originalheaders","default":[]},"dataTypes":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Datatypes"},"statistics":{"anyOf":[{"additionalProperties":{"type":"object"},"type":"object"},{"type":"null"}],"title":"Statistics"},"context":{"anyOf":[{"$ref":"#/components/schemas/ContextResponse"},{"type":"null"}]},"detectionMethod":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detectionmethod"},"confidence":{"type":"number","title":"Confidence","default":0.0},"cacheKey":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cachekey"},"processingTimeMs":{"type":"integer","title":"Processingtimems","default":0},"notes":{"items":{"type":"string"},"type":"array","title":"Notes","default":[]},"recommendedCharts":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Recommendedcharts"}},"type":"object","required":["success"],"title":"AutoParseResponse","description":"Response model for auto-parse endpoint.\nUses camelCase field names for Java compatibility."},"BatchComputeRequest":{"properties":{"matrixAList":{"items":{"items":{"items":{"type":"number"},"type":"array"},"type":"array"},"type":"array","title":"Matrixalist","description":"List of A matrices, one per worker"},"vectorBList":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","title":"Vectorblist","description":"List of b vectors, one per worker"},"context":{"items":{"type":"number"},"type":"array","title":"Context","description":"Shared context features (task + current state)"},"alpha":{"type":"number","maximum":5.0,"minimum":0.0,"title":"Alpha","description":"Exploration parameter (default 0.5)","default":0.5}},"type":"object","required":["matrixAList","vectorBList","context"],"title":"BatchComputeRequest","description":"Request model for batch UCB computation"},"BatchComputeResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"results":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Results","description":"List of individual UCB results"},"totalWorkers":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Totalworkers","description":"Total number of workers processed"},"successCount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Successcount","description":"Number of successful computations"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"}},"type":"object","required":["success"],"title":"BatchComputeResponse","description":"Response model for batch UCB computation"},"BatchExportResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"source_file":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source File"},"sheet_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Count"},"sheets":{"anyOf":[{"items":{"$ref":"#/components/schemas/BatchExportSheetInfo"},"type":"array"},{"type":"null"}],"title":"Sheets"},"files":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Files"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["success"],"title":"BatchExportResponse","description":"批量导出响应"},"BatchExportSheetInfo":{"properties":{"index":{"type":"integer","title":"Index"},"name":{"type":"string","title":"Name"},"safe_name":{"type":"string","title":"Safe Name"},"row_count":{"type":"integer","title":"Row Count"},"column_count":{"type":"integer","title":"Column Count"}},"type":"object","required":["index","name","safe_name","row_count","column_count"],"title":"BatchExportSheetInfo","description":"单个Sheet的导出信息"},"BenchmarkRequest":{"properties":{"sheet_id":{"type":"string","title":"Sheet Id","description":"Sheet identifier"},"industry":{"type":"string","title":"Industry","description":"Industry for comparison (food_processing, retail, etc.)"},"metrics":{"additionalProperties":{"type":"number"},"type":"object","title":"Metrics","description":"Company metrics to compare"},"metric_mapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Metric Mapping","description":"Optional metric name mapping"}},"type":"object","required":["sheet_id","industry","metrics"],"title":"BenchmarkRequest","description":"Request for industry benchmark comparison"},"BenchmarkResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"result":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Result"},"sources":{"items":{"type":"string"},"type":"array","title":"Sources","default":[]},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"BenchmarkResponse","description":"Response for benchmark comparison"},"Body_analyze_excel_structure_api_excel_analyze_structure_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"include_recommendations":{"type":"boolean","title":"Include Recommendations","default":true}},"type":"object","required":["file"],"title":"Body_analyze_excel_structure_api_excel_analyze_structure_post"},"Body_analyze_sheets_api_excel_analyze_sheets_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_analyze_sheets_api_excel_analyze_sheets_post"},"Body_analyze_workbook_api_excel_analyze_workbook_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"factory_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Factory Id"},"skip_empty":{"type":"boolean","title":"Skip Empty","default":true},"skip_index_sheets":{"type":"boolean","title":"Skip Index Sheets","default":true},"extract_index_metadata":{"type":"boolean","title":"Extract Index Metadata","default":true},"max_rows_per_sheet":{"type":"integer","title":"Max Rows Per Sheet","default":10000},"generate_charts":{"type":"boolean","title":"Generate Charts","default":true},"generate_insights":{"type":"boolean","title":"Generate Insights","default":true}},"type":"object","required":["file"],"title":"Body_analyze_workbook_api_excel_analyze_workbook_post"},"Body_auto_parse_excel_api_excel_auto_parse_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"sheet_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheet Name"},"sheetName":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheetname"},"factory_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Factory Id"},"use_cache":{"type":"boolean","title":"Use Cache","default":true},"max_rows":{"type":"integer","title":"Max Rows","default":10000},"skip_empty_rows":{"type":"boolean","title":"Skip Empty Rows","default":true},"calculate_stats":{"type":"boolean","title":"Calculate Stats","default":true},"transpose":{"type":"boolean","title":"Transpose","default":false},"header_rows_override":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Header Rows Override"},"headerRowsOverride":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Headerrowsoverride"}},"type":"object","required":["file"],"title":"Body_auto_parse_excel_api_excel_auto_parse_post"},"Body_batch_export_all_sheets_api_excel_export_batch_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"max_rows_per_md":{"type":"integer","title":"Max Rows Per Md","default":500},"return_content":{"type":"boolean","title":"Return Content","default":false}},"type":"object","required":["file"],"title":"Body_batch_export_all_sheets_api_excel_export_batch_post"},"Body_batch_export_and_save_api_excel_export_batch_save_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"output_dir":{"type":"string","title":"Output Dir"},"max_rows_per_md":{"type":"integer","title":"Max Rows Per Md","default":500}},"type":"object","required":["file","output_dir"],"title":"Body_batch_export_and_save_api_excel_export_batch_save_post"},"Body_batch_export_with_validation_api_excel_export_batch_validate_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"use_llm":{"type":"boolean","title":"Use Llm","default":true},"max_rows_per_md":{"type":"integer","title":"Max Rows Per Md","default":500}},"type":"object","required":["file"],"title":"Body_batch_export_with_validation_api_excel_export_batch_validate_post"},"Body_detect_multi_header_api_excel_detect_header_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheet Name"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"}},"type":"object","required":["file"],"title":"Body_detect_multi_header_api_excel_detect_header_post"},"Body_export_excel_api_excel_export_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"format":{"type":"string","title":"Format","default":"json"},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows"}},"type":"object","required":["file"],"title":"Body_export_excel_api_excel_export_post"},"Body_export_to_csv_api_excel_export_csv_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows"}},"type":"object","required":["file"],"title":"Body_export_to_csv_api_excel_export_csv_post"},"Body_export_to_json_api_excel_export_json_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows"}},"type":"object","required":["file"],"title":"Body_export_to_json_api_excel_export_json_post"},"Body_export_to_markdown_api_excel_export_markdown_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true},"max_rows":{"type":"integer","title":"Max Rows","default":50}},"type":"object","required":["file"],"title":"Body_export_to_markdown_api_excel_export_markdown_post"},"Body_export_with_validation_and_fix_api_excel_export_validate_fix_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"auto_fix":{"type":"boolean","title":"Auto Fix","default":true},"preview_rows_count":{"type":"integer","title":"Preview Rows Count","default":20}},"type":"object","required":["file"],"title":"Body_export_with_validation_and_fix_api_excel_export_validate_fix_post"},"Body_export_with_validation_api_excel_export_validate_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"use_llm":{"type":"boolean","title":"Use Llm","default":true},"preview_rows_count":{"type":"integer","title":"Preview Rows Count","default":20}},"type":"object","required":["file"],"title":"Body_export_with_validation_api_excel_export_validate_post"},"Body_extract_context_api_excel_extract_context_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"data_end_row":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Data End Row"}},"type":"object","required":["file"],"title":"Body_extract_context_api_excel_extract_context_post"},"Body_get_export_metadata_api_excel_export_metadata_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"}},"type":"object","required":["file"],"title":"Body_get_export_metadata_api_excel_export_metadata_post"},"Body_get_sheet_names_api_excel_sheets_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_get_sheet_names_api_excel_sheets_post"},"Body_list_sheets_detailed_api_excel_list_sheets_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_list_sheets_detailed_api_excel_list_sheets_post"},"Body_match_parse_rule_api_excel_smart_parse_match_rule_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0}},"type":"object","required":["file"],"title":"Body_match_parse_rule_api_excel_smart_parse_match_rule_post"},"Body_preview_excel_api_excel_preview_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheet Name"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index"},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"rows":{"type":"integer","title":"Rows","default":10}},"type":"object","required":["file"],"title":"Body_preview_excel_api_excel_preview_post"},"Body_raw_export_all_sheets_api_excel_raw_export_all_sheets_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"format":{"type":"string","title":"Format","default":"json"},"max_rows_per_sheet":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows Per Sheet"}},"type":"object","required":["file"],"title":"Body_raw_export_all_sheets_api_excel_raw_export_all_sheets_post"},"Body_raw_export_excel_api_excel_raw_export_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"format":{"type":"string","title":"Format","default":"json"},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows"},"truncate":{"type":"boolean","title":"Truncate","default":true},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true}},"type":"object","required":["file"],"title":"Body_raw_export_excel_api_excel_raw_export_post"},"Body_recommend_chart_api_chart_recommend_post":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data"},"fields":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Fields"}},"type":"object","required":["data"],"title":"Body_recommend_chart_api_chart_recommend_post"},"Body_smart_analyze_excel_api_excel_smart_analyze_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"sheetIndex":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheetindex"},"max_analyses":{"type":"integer","title":"Max Analyses","default":5}},"type":"object","required":["file"],"title":"Body_smart_analyze_excel_api_excel_smart_analyze_post"},"Body_smart_parse_excel_api_excel_smart_parse_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"sheet_index":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sheet Index","default":0},"force_llm":{"type":"boolean","title":"Force Llm","default":false},"preview_rows_count":{"type":"integer","title":"Preview Rows Count","default":10}},"type":"object","required":["file"],"title":"Body_smart_parse_excel_api_excel_smart_parse_post"},"Body_submit_auto_parse_feedback_api_excel_auto_parse_feedback_post":{"properties":{"cache_key":{"type":"string","title":"Cache Key"},"correction_type":{"type":"string","title":"Correction Type"},"original_value":{"type":"string","title":"Original Value"},"correct_value":{"type":"string","title":"Correct Value"}},"type":"object","required":["cache_key","correction_type","original_value","correct_value"],"title":"Body_submit_auto_parse_feedback_api_excel_auto_parse_feedback_post"},"BudgetAchievementByPeriodRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"}},"type":"object","required":["data"],"title":"BudgetAchievementByPeriodRequest","description":"Request model for budget achievement by period"},"BudgetExecutionWaterfallRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"categoryField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Categoryfield","description":"Field name for budget category"}},"type":"object","required":["data"],"title":"BudgetExecutionWaterfallRequest","description":"Request model for budget execution waterfall"},"BudgetVsActualRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"}},"type":"object","required":["data"],"title":"BudgetVsActualRequest","description":"Request model for budget vs actual comparison"},"BudgetWaterfallRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"budgetField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Budgetfield","description":"Field name for budget values"},"actualField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Actualfield","description":"Field name for actual values"}},"type":"object","required":["data"],"title":"BudgetWaterfallRequest","description":"Request model for budget waterfall analysis"},"CategoryComparisonRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"categoryField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Categoryfield","description":"Field name for category"},"periodField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodfield","description":"Field name for time period"}},"type":"object","required":["data"],"title":"CategoryComparisonRequest","description":"Request model for category structure comparison"},"ChartBuildRequest":{"properties":{"chartType":{"type":"string","title":"Charttype"},"data":{"items":{"type":"object"},"type":"array","title":"Data"},"xField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Xfield"},"yFields":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Yfields"},"seriesField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Seriesfield"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"subtitle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subtitle"},"theme":{"type":"string","title":"Theme","default":"default"},"options":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Options"}},"type":"object","required":["chartType","data"],"title":"ChartBuildRequest","description":"Chart build request model"},"ChartBuildResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"chartType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Charttype"},"config":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Config"},"anomalies":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Anomalies"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ChartBuildResponse","description":"Chart build response model"},"ChartConfigRequest":{"properties":{"detectedFields":{"items":{"type":"object"},"type":"array","title":"Detectedfields"},"analysisGoal":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Analysisgoal"}},"type":"object","required":["detectedFields"],"title":"ChartConfigRequest","description":"Chart configuration request model"},"ChartConfigResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"recommendations":{"items":{"type":"object"},"type":"array","title":"Recommendations","default":[]},"method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Method"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ChartConfigResponse","description":"Chart configuration response model"},"ChartTypeInfo":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"type":"string","title":"Description"}},"type":"object","required":["id","name","description"],"title":"ChartTypeInfo","description":"Chart type information"},"CityRankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top cities to return","default":20},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to rank by","default":"sales_amount"},"province":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Province","description":"Filter by province"}},"type":"object","required":["data"],"title":"CityRankingRequest","description":"Request model for city ranking"},"ClassifyBatchRequest":{"properties":{"texts":{"items":{"type":"string"},"type":"array","title":"Texts","description":"待分类文本列表"},"top_k":{"type":"integer","maximum":10.0,"minimum":1.0,"title":"Top K","description":"每个文本返回 top-k 个结果","default":1}},"type":"object","required":["texts"],"title":"ClassifyBatchRequest","description":"批量分类请求"},"ClassifyRequest":{"properties":{"text":{"type":"string","title":"Text","description":"待分类文本"},"top_k":{"type":"integer","maximum":10.0,"minimum":1.0,"title":"Top K","description":"返回 top-k 个结果","default":5},"threshold":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Threshold","description":"最小置信度阈值","default":0.0}},"type":"object","required":["text"],"title":"ClassifyRequest","description":"单条分类请求"},"ColumnInfoModel":{"properties":{"col_letter":{"type":"string","title":"Col Letter"},"col_index":{"type":"integer","title":"Col Index"},"name":{"type":"string","title":"Name"},"data_type":{"type":"string","title":"Data Type"},"meaning":{"type":"string","title":"Meaning"},"role":{"type":"string","title":"Role"},"is_key":{"type":"boolean","title":"Is Key","default":false}},"type":"object","required":["col_letter","col_index","name","data_type","meaning","role"],"title":"ColumnInfoModel","description":"列信息模型"},"ComparisonItem":{"properties":{"label":{"type":"string","title":"Label"},"current_value":{"type":"number","title":"Current Value"},"previous_value":{"type":"number","title":"Previous Value"},"yoy_growth":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Yoy Growth"},"category":{"type":"string","title":"Category","default":"other"}},"type":"object","required":["label","current_value","previous_value"],"title":"ComparisonItem","description":"Single row comparison result"},"ComputeUCBRequest":{"properties":{"matrixA":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","title":"Matrixa","description":"A matrix (n x n), accumulated feature outer products + regularization"},"vectorB":{"items":{"type":"number"},"type":"array","title":"Vectorb","description":"b vector (n,), accumulated reward-weighted features"},"context":{"items":{"type":"number"},"type":"array","title":"Context","description":"Context features x (n,) for current task+worker"},"alpha":{"type":"number","maximum":5.0,"minimum":0.0,"title":"Alpha","description":"Exploration parameter (default 0.5)","default":0.5}},"type":"object","required":["matrixA","vectorB","context"],"title":"ComputeUCBRequest","description":"Request model for computing UCB"},"ComputeUCBResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"ucb":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Ucb","description":"Upper Confidence Bound score"},"expectedReward":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Expectedreward","description":"Expected reward (exploitation term)"},"confidenceWidth":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Confidencewidth","description":"Confidence width (exploration term)"},"theta":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Theta","description":"Parameter vector"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"}},"type":"object","required":["success"],"title":"ComputeUCBResponse","description":"Response model for UCB computation"},"ConfidenceRequest":{"properties":{"text":{"type":"string","title":"Text","description":"待分类文本"},"intent_code":{"type":"string","title":"Intent Code","description":"目标意图代码"}},"type":"object","required":["text","intent_code"],"title":"ConfidenceRequest","description":"意图置信度请求"},"ContextResponse":{"properties":{"notes":{"items":{"type":"string"},"type":"array","title":"Notes","default":[]},"explanations":{"items":{"type":"string"},"type":"array","title":"Explanations","default":[]},"definitions":{"additionalProperties":{"type":"string"},"type":"object","title":"Definitions","default":{}},"source_rows":{"items":{"type":"integer"},"type":"array","title":"Source Rows","default":[]},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"}},"type":"object","title":"ContextResponse","description":"Context information from Excel sheet (Three-Layer Model - Layer 3)"},"CostStructureRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"groupBy":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Groupby","description":"Optional field to group costs by"}},"type":"object","required":["data"],"title":"CostStructureRequest","description":"Request model for cost structure analysis"},"CrossSheetChart":{"properties":{"chartType":{"type":"string","title":"Charttype"},"title":{"type":"string","title":"Title"},"config":{"type":"object","title":"Config"}},"type":"object","required":["chartType","title","config"],"title":"CrossSheetChart","description":"Chart configuration for cross-sheet visualization"},"CrossSheetRequest":{"properties":{"upload_ids":{"items":{"type":"integer"},"type":"array","title":"Upload Ids","description":"Upload IDs to include"},"sheet_names":{"items":{"type":"string"},"type":"array","title":"Sheet Names","description":"Sheet display names","default":[]},"factory_id":{"type":"string","title":"Factory Id","description":"Factory ID","default":"F001"}},"type":"object","required":["upload_ids"],"title":"CrossSheetRequest","description":"Request for cross-sheet analysis"},"CrossSheetResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"kpiComparison":{"items":{"$ref":"#/components/schemas/SheetKPI"},"type":"array","title":"Kpicomparison","default":[]},"charts":{"items":{"$ref":"#/components/schemas/CrossSheetChart"},"type":"array","title":"Charts","default":[]},"aiSummary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aisummary"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processingTimeMs":{"type":"integer","title":"Processingtimems","default":0}},"type":"object","required":["success"],"title":"CrossSheetResponse","description":"Response for cross-sheet analysis"},"CustomerAnalysisRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"customerField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Customerfield","description":"Field name for customer identifier"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top customers to return","default":10}},"type":"object","required":["data"],"title":"CustomerAnalysisRequest","description":"Request model for customer analysis"},"DashboardResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"uploadId":{"type":"integer","title":"Uploadid"},"tableType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tabletype"},"kpiCards":{"items":{"type":"object"},"type":"array","title":"Kpicards","default":[]},"charts":{"items":{"type":"object"},"type":"array","title":"Charts","default":[]},"insights":{"items":{"type":"string"},"type":"array","title":"Insights","default":[]},"fieldDefinitions":{"items":{"type":"object"},"type":"array","title":"Fielddefinitions","default":[]}},"type":"object","required":["success","uploadId"],"title":"DashboardResponse"},"DepartmentCompletionRatesRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"targetData":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Targetdata","description":"Target data for completion rate calculation"}},"type":"object","required":["data"],"title":"DepartmentCompletionRatesRequest","description":"Request model for department completion rates"},"DepartmentDetailRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"departmentId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Departmentid","description":"Department ID or name to get details for"}},"type":"object","required":["data"],"title":"DepartmentDetailRequest","description":"Request model for department detail"},"DepartmentEfficiencyMatrixRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"metrics":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Metrics","description":"List of metrics to include in matrix"}},"type":"object","required":["data"],"title":"DepartmentEfficiencyMatrixRequest","description":"Request model for department efficiency matrix"},"DepartmentRankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top departments to return","default":10},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to rank by (sales_amount, order_count, profit, etc.)","default":"sales_amount"}},"type":"object","required":["data"],"title":"DepartmentRankingRequest","description":"Request model for department ranking"},"DepartmentShareTrendRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"},"periods":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Periods","description":"Number of periods to analyze","default":12}},"type":"object","required":["data"],"title":"DepartmentShareTrendRequest","description":"Request model for department share trend"},"DepartmentTrendComparisonRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"departments":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Departments","description":"List of department IDs to compare"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"}},"type":"object","required":["data"],"title":"DepartmentTrendComparisonRequest","description":"Request model for department trend comparison"},"DrillDownRequest":{"properties":{"sheet_id":{"type":"string","title":"Sheet Id","description":"Sheet identifier"},"dimension":{"type":"string","title":"Dimension","description":"Dimension to drill down on"},"filter_value":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Filter Value","description":"Value to filter on"},"measures":{"items":{"type":"string"},"type":"array","title":"Measures","description":"Measures to aggregate","default":["amount","revenue","profit"]},"aggregation":{"type":"string","title":"Aggregation","description":"Aggregation method","default":"sum"},"data":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Data","description":"Data to analyze (if not from cache)"}},"type":"object","required":["sheet_id","dimension"],"title":"DrillDownRequest","description":"Request for drill-down analysis"},"DrillDownResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"result":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Result"},"chart_config":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Chart Config"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"DrillDownResponse","description":"Response for drill-down analysis"},"ExportMetadataResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"columns":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Columns"},"row_count":{"type":"integer","title":"Row Count","default":0},"column_count":{"type":"integer","title":"Column Count","default":0},"context":{"anyOf":[{"$ref":"#/components/schemas/ContextResponse"},{"type":"null"}]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ExportMetadataResponse","description":"Metadata-only response for export preview"},"ExportResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"format":{"type":"string","title":"Format"},"content":{"type":"string","title":"Content"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success","format","content"],"title":"ExportResponse","description":"Response model for export endpoints"},"ExportWithValidationResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"columns":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Columns"},"row_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Row Count"},"column_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Column Count"},"preview_rows":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Preview Rows"},"validation":{"anyOf":[{"$ref":"#/components/schemas/ValidationResultModel"},{"type":"null"}]},"fix_log":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Fix Log"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"ExportWithValidationResponse","description":"导出+验证响应"},"ExtractContextResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"context":{"anyOf":[{"$ref":"#/components/schemas/ContextResponse"},{"type":"null"}]},"has_content":{"type":"boolean","title":"Has Content","default":false}},"type":"object","required":["success"],"title":"ExtractContextResponse","description":"Response model for context extraction endpoint"},"FeedbackItem":{"properties":{"section":{"type":"string","title":"Section"},"rowIndex":{"type":"integer","title":"Rowindex"},"fieldName":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Fieldname"},"applicability":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Applicability"},"priority":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Priority"},"note":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Note"}},"type":"object","required":["section","rowIndex"],"title":"FeedbackItem"},"FieldDetectionRequest":{"properties":{"headers":{"items":{"type":"string"},"type":"array","title":"Headers"},"rows":{"items":{"items":{},"type":"array"},"type":"array","title":"Rows"}},"type":"object","required":["headers","rows"],"title":"FieldDetectionRequest","description":"Field detection request model"},"FieldDetectionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"fields":{"items":{"$ref":"#/components/schemas/FieldInfo"},"type":"array","title":"Fields","default":[]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"FieldDetectionResponse","description":"Field detection response model"},"FieldInfo":{"properties":{"fieldName":{"type":"string","title":"Fieldname"},"dataType":{"type":"string","title":"Datatype"},"semanticType":{"type":"string","title":"Semantictype"},"chartRole":{"type":"string","title":"Chartrole"},"nullable":{"type":"boolean","title":"Nullable"},"nullCount":{"type":"integer","title":"Nullcount"},"uniqueCount":{"type":"integer","title":"Uniquecount"},"sampleValues":{"items":{},"type":"array","title":"Samplevalues","default":[]},"statistics":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Statistics"},"uniqueValues":{"anyOf":[{"items":{},"type":"array"},{"type":"null"}],"title":"Uniquevalues"}},"type":"object","required":["fieldName","dataType","semanticType","chartRole","nullable","nullCount","uniqueCount"],"title":"FieldInfo","description":"Single field information"},"FieldMappingRequest":{"properties":{"detectedFields":{"items":{"type":"object"},"type":"array","title":"Detectedfields"},"context":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Context"}},"type":"object","required":["detectedFields"],"title":"FieldMappingRequest","description":"Field mapping request model"},"FieldMappingResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"mappings":{"items":{"type":"object"},"type":"array","title":"Mappings","default":[]},"unmapped":{"items":{"type":"string"},"type":"array","title":"Unmapped","default":[]},"method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Method"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"FieldMappingResponse","description":"Field mapping response model"},"FinanceOverviewRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"}},"type":"object","required":["data"],"title":"FinanceOverviewRequest","description":"Request model for finance overview"},"ForecastRequest":{"properties":{"data":{"items":{"type":"number"},"type":"array","minItems":3,"title":"Data","description":"Historical data values"},"algorithm":{"type":"string","title":"Algorithm","description":"Forecasting algorithm","default":"auto"},"periods":{"type":"integer","maximum":24.0,"minimum":1.0,"title":"Periods","description":"Number of periods to forecast","default":3},"confidenceLevel":{"type":"number","maximum":0.99,"minimum":0.5,"title":"Confidencelevel","description":"Confidence level for intervals","default":0.95},"seasonality":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Seasonality","description":"Seasonal period (e.g., 12 for monthly)"}},"type":"object","required":["data"],"title":"ForecastRequest","description":"Forecast request model"},"ForecastResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"algorithm":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Algorithm"},"inputLength":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Inputlength"},"forecastPeriods":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Forecastperiods"},"predictions":{"items":{"type":"number"},"type":"array","title":"Predictions","default":[]},"lowerBound":{"items":{"type":"number"},"type":"array","title":"Lowerbound","default":[]},"upperBound":{"items":{"type":"number"},"type":"array","title":"Upperbound","default":[]},"parameters":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Parameters"},"selectedAlgorithm":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Selectedalgorithm"},"validationError":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Validationerror"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ForecastResponse","description":"Forecast response model"},"GeneralAnalysisRequest":{"properties":{"sheet_id":{"type":"string","title":"Sheet Id","description":"Sheet identifier"},"query":{"type":"string","title":"Query","description":"Analysis query/question"},"data":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Data","description":"Data to analyze"},"context":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Context","description":"Additional context"}},"type":"object","required":["sheet_id","query"],"title":"GeneralAnalysisRequest","description":"Request for general analysis"},"GeneralAnalysisResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"answer":{"type":"string","title":"Answer","default":""},"insights":{"items":{"type":"object"},"type":"array","title":"Insights","default":[]},"charts":{"items":{"type":"object"},"type":"array","title":"Charts","default":[]},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"GeneralAnalysisResponse","description":"Response for general analysis"},"GeographicHeatmapRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric for heatmap intensity","default":"sales_amount"},"level":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Level","description":"Geographic level: province, city","default":"province"}},"type":"object","required":["data"],"title":"GeographicHeatmapRequest","description":"Request model for geographic heatmap"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HierarchyDataRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"level":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Level","description":"Hierarchy level to return: all, region, province, city","default":"all"}},"type":"object","required":["data"],"title":"HierarchyDataRequest","description":"Request model for hierarchy data"},"IndexMetadataModel":{"properties":{"hasIndex":{"type":"boolean","title":"Hasindex","default":false},"indexSheetIndex":{"type":"integer","title":"Indexsheetindex","default":-1},"indexSheetName":{"type":"string","title":"Indexsheetname","default":""},"sheetMappings":{"items":{"$ref":"#/components/schemas/IndexSheetMappingModel"},"type":"array","title":"Sheetmappings","default":[]}},"type":"object","title":"IndexMetadataModel","description":"Index/TOC sheet metadata"},"IndexSheetMappingModel":{"properties":{"index":{"type":"integer","title":"Index"},"sheetName":{"type":"string","title":"Sheetname"},"reportName":{"type":"string","title":"Reportname"},"description":{"type":"string","title":"Description","default":""}},"type":"object","required":["index","sheetName","reportName"],"title":"IndexSheetMappingModel","description":"Mapping from index sheet to report info"},"InitializeRequest":{"properties":{"featureDim":{"type":"integer","maximum":256.0,"minimum":1.0,"title":"Featuredim","description":"Feature dimension (default 16)","default":16},"regularization":{"type":"number","maximum":100.0,"exclusiveMinimum":0.0,"title":"Regularization","description":"Regularization parameter lambda (default 1.0)","default":1.0}},"type":"object","title":"InitializeRequest","description":"Request model for initializing LinUCB model"},"InitializeResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"matrixA":{"anyOf":[{"items":{"items":{"type":"number"},"type":"array"},"type":"array"},{"type":"null"}],"title":"Matrixa","description":"Initial A matrix (lambda * I)"},"matrixAInverse":{"anyOf":[{"items":{"items":{"type":"number"},"type":"array"},"type":"array"},{"type":"null"}],"title":"Matrixainverse","description":"Initial A inverse matrix (I / lambda)"},"vectorB":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Vectorb","description":"Initial b vector (zeros)"},"featureDim":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Featuredim","description":"Feature dimension used"},"regularization":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Regularization","description":"Regularization parameter used"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"}},"type":"object","required":["success"],"title":"InitializeResponse","description":"Response model for model initialization"},"Insight":{"properties":{"type":{"type":"string","title":"Type"},"text":{"type":"string","title":"Text"},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric"},"value":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Value"},"changeRate":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Changerate"},"sentiment":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sentiment"},"importance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Importance"},"recommendation":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Recommendation"},"action_items":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Action Items"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"},"executive_summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Executive Summary"},"risk_alerts":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Risk Alerts"},"opportunities":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Opportunities"}},"type":"object","required":["type","text"],"title":"Insight","description":"Single insight model"},"InsightRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data"},"metrics":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Metrics"},"analysisContext":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Analysiscontext"},"insightTypes":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Insighttypes"},"maxInsights":{"type":"integer","title":"Maxinsights","default":5}},"type":"object","required":["data"],"title":"InsightRequest","description":"Insight generation request model"},"InsightResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"insights":{"items":{"$ref":"#/components/schemas/Insight"},"type":"array","title":"Insights","default":[]},"totalGenerated":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Totalgenerated"},"method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Method"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"InsightResponse","description":"Insight generation response model"},"LLMAnalysisResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"structure":{"anyOf":[{"$ref":"#/components/schemas/StructureAnalysisModel"},{"type":"null"}]},"recommendations":{"items":{"$ref":"#/components/schemas/AnalysisRecommendationModel"},"type":"array","title":"Recommendations","default":[]},"insights":{"items":{"type":"string"},"type":"array","title":"Insights","default":[]},"warnings":{"items":{"type":"string"},"type":"array","title":"Warnings","default":[]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"LLMAnalysisResponse","description":"LLM分析响应"},"LeastSquaresMetrics":{"properties":{"rmse":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Rmse","description":"Root Mean Square Error of residuals"},"conditionNumber":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Conditionnumber","description":"Condition number of A^T A"},"rank":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rank","description":"Rank of matrix A"},"regularization":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Regularization","description":"Regularization used"},"singularValues":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Singularvalues","description":"Singular values (for lstsq/svd)"}},"type":"object","title":"LeastSquaresMetrics","description":"Metrics from least squares solution"},"LeastSquaresRequest":{"properties":{"matrixA":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","minItems":1,"title":"Matrixa","description":"Coefficient matrix A (m x n)"},"vectorB":{"items":{"type":"number"},"type":"array","minItems":1,"title":"Vectorb","description":"Target vector b (m x 1)"},"regularization":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Regularization","description":"Regularization parameter (lambda for ridge regression)","default":0.001},"method":{"type":"string","title":"Method","description":"Solving method: 'ridge', 'lstsq', or 'svd'","default":"ridge"}},"type":"object","required":["matrixA","vectorB"],"title":"LeastSquaresRequest","description":"Least squares request model"},"LeastSquaresResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"solution":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Solution","description":"Solution vector x"},"metrics":{"anyOf":[{"$ref":"#/components/schemas/LeastSquaresMetrics"},{"type":"null"}]},"method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Method","description":"Method used for solving"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"}},"type":"object","required":["success"],"title":"LeastSquaresResponse","description":"Least squares response model"},"ListSheetsResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"totalSheets":{"type":"integer","title":"Totalsheets","default":0},"sheets":{"items":{"$ref":"#/components/schemas/SheetInfo"},"type":"array","title":"Sheets","default":[]},"errorMessage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Errormessage"}},"type":"object","required":["success"],"title":"ListSheetsResponse","description":"Detailed sheet listing response model"},"LoadModelRequest":{"properties":{"model_path":{"type":"string","title":"Model Path","description":"模型目录路径"}},"type":"object","required":["model_path"],"title":"LoadModelRequest","description":"加载模型请求"},"LoginRequest":{"properties":{"companyName":{"type":"string","title":"Companyname"},"contactName":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contactname"},"contactPhone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Contactphone"}},"type":"object","required":["companyName"],"title":"LoginRequest"},"MatrixValidationRequest":{"properties":{"matrixA":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","title":"Matrixa"},"vectorB":{"items":{"type":"number"},"type":"array","title":"Vectorb"}},"type":"object","required":["matrixA","vectorB"],"title":"MatrixValidationRequest","description":"Matrix validation request model"},"MatrixValidationResponse":{"properties":{"valid":{"type":"boolean","title":"Valid"},"rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rows"},"cols":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Cols"},"rank":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rank"},"conditionNumber":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Conditionnumber"},"isFullRank":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Isfullrank"},"isOverdetermined":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Isoverdetermined"},"isUnderdetermined":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Isunderdetermined"},"hasNaN":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Hasnan"},"hasInf":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Hasinf"},"isWellConditioned":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Iswellconditioned"},"recommendedMethod":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Recommendedmethod"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["valid"],"title":"MatrixValidationResponse","description":"Matrix validation response model"},"MetricCalculationRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data"},"metrics":{"items":{"type":"string"},"type":"array","title":"Metrics"},"groupBy":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Groupby"},"timeField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Timefield"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping"}},"type":"object","required":["data","metrics"],"title":"MetricCalculationRequest","description":"Metric calculation request model"},"MetricCalculationResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"results":{"items":{"$ref":"#/components/schemas/MetricResult"},"type":"array","title":"Results","default":[]},"summary":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Summary"},"groupBy":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Groupby"},"timeField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Timefield"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"MetricCalculationResponse","description":"Metric calculation response model"},"MetricInfo":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"unit":{"type":"string","title":"Unit"},"formula":{"type":"string","title":"Formula"},"required_fields":{"items":{"type":"string"},"type":"array","title":"Required Fields"}},"type":"object","required":["id","name","unit","formula","required_fields"],"title":"MetricInfo","description":"Metric information"},"MetricResult":{"properties":{"success":{"type":"boolean","title":"Success"},"metric":{"type":"string","title":"Metric"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"value":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Value"},"unit":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Unit"},"breakdown":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Breakdown"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success","metric"],"title":"MetricResult","description":"Single metric result"},"MultiDimensionRequest":{"properties":{"sheet_id":{"type":"string","title":"Sheet Id","description":"Sheet identifier"},"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"dimensions":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Dimensions","description":"Insight dimensions to focus on"},"context":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Context","description":"Analysis context"}},"type":"object","required":["sheet_id","data"],"title":"MultiDimensionRequest","description":"Request for multi-dimensional insight analysis"},"MultiDimensionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"executive_summary":{"type":"string","title":"Executive Summary","default":""},"insights":{"items":{"type":"object"},"type":"array","title":"Insights","default":[]},"risk_alerts":{"items":{"type":"object"},"type":"array","title":"Risk Alerts","default":[]},"opportunities":{"items":{"type":"object"},"type":"array","title":"Opportunities","default":[]},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"MultiDimensionResponse","description":"Response for multi-dimensional analysis"},"MultiHeaderDetectionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"isMultiHeader":{"type":"boolean","title":"Ismultiheader","default":false},"recommendedHeaderRows":{"type":"integer","title":"Recommendedheaderrows","default":1},"previewRows":{"anyOf":[{"items":{"items":{},"type":"array"},"type":"array"},{"type":"null"}],"title":"Previewrows"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"MultiHeaderDetectionResponse","description":"Multi-header detection response model"},"MultiSheetAnalysisResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"totalSheets":{"type":"integer","title":"Totalsheets","default":0},"successCount":{"type":"integer","title":"Successcount","default":0},"failedCount":{"type":"integer","title":"Failedcount","default":0},"skippedCount":{"type":"integer","title":"Skippedcount","default":0},"cacheHitCount":{"type":"integer","title":"Cachehitcount","default":0},"sheetResults":{"items":{"$ref":"#/components/schemas/SheetAnalysisResultModel"},"type":"array","title":"Sheetresults","default":[]},"indexMetadata":{"anyOf":[{"$ref":"#/components/schemas/IndexMetadataModel"},{"type":"null"}]},"processingTimeMs":{"type":"integer","title":"Processingtimems","default":0},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"MultiSheetAnalysisResponse","description":"Response for multi-sheet workbook analysis"},"MultiYearComparisonRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"years":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Years","description":"List of years to compare"},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to compare across years","default":"sales_amount"}},"type":"object","required":["data"],"title":"MultiYearComparisonRequest","description":"Request model for multi-year comparison"},"OverdueCustomerRankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top overdue customers to return","default":10}},"type":"object","required":["data"],"title":"OverdueCustomerRankingRequest","description":"Request model for overdue customer ranking"},"PayableAgingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"agingBuckets":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Agingbuckets","description":"Aging bucket boundaries in days (e.g., [30, 60, 90, 180])"}},"type":"object","required":["data"],"title":"PayableAgingRequest","description":"Request model for accounts payable aging"},"ProfitTrendRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"},"periods":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Periods","description":"Number of periods to analyze","default":12}},"type":"object","required":["data"],"title":"ProfitTrendRequest","description":"Request model for profit trend analysis"},"ProvinceRankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top provinces to return","default":10},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to rank by","default":"sales_amount"}},"type":"object","required":["data"],"title":"ProvinceRankingRequest","description":"Request model for province ranking"},"RankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top items to return","default":10},"rankBy":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Rankby","description":"Metric to rank by","default":"sales_amount"}},"type":"object","required":["data"],"title":"RankingRequest","description":"Request model for ranking analysis"},"RawExportResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"format":{"type":"string","title":"Format"},"content":{"type":"string","title":"Content"},"sheet_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheet Name"},"total_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Rows"},"total_cols":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Total Cols"},"merged_cells_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Merged Cells Count"},"stats":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Stats"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success","format","content"],"title":"RawExportResponse","description":"原始导出响应"},"ReceivableAgingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"agingBuckets":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Agingbuckets","description":"Aging bucket boundaries in days (e.g., [30, 60, 90, 180])"}},"type":"object","required":["data"],"title":"ReceivableAgingRequest","description":"Request model for accounts receivable aging"},"ReceivableMetricsRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"}},"type":"object","required":["data"],"title":"ReceivableMetricsRequest","description":"Request model for receivable metrics"},"RegionDetailRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"regionId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Regionid","description":"Region ID or name to get details for"}},"type":"object","required":["data"],"title":"RegionDetailRequest","description":"Request model for region detail"},"RegionDistributionRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"regionField":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Regionfield","description":"Field name for region"}},"type":"object","required":["data"],"title":"RegionDistributionRequest","description":"Request model for region distribution analysis"},"RegionOpportunityScoresRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"factors":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Factors","description":"Factors to include in opportunity scoring"}},"type":"object","required":["data"],"title":"RegionOpportunityScoresRequest","description":"Request model for region opportunity scores"},"RegionRankingRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"topN":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Topn","description":"Number of top regions to return","default":10},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to rank by","default":"sales_amount"},"level":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Level","description":"Region level: region, province, city","default":"region"}},"type":"object","required":["data"],"title":"RegionRankingRequest","description":"Request model for region ranking"},"RegionTrendRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"regionId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Regionid","description":"Region ID or name"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"},"periods":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Periods","description":"Number of periods to analyze","default":12}},"type":"object","required":["data"],"title":"RegionTrendRequest","description":"Request model for region trend"},"RootCauseRequest":{"properties":{"sheet_id":{"type":"string","title":"Sheet Id","description":"Sheet identifier"},"kpi":{"type":"string","title":"Kpi","description":"KPI to analyze"},"threshold":{"type":"number","title":"Threshold","description":"Significance threshold","default":0.1},"data":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Data","description":"Data to analyze"}},"type":"object","required":["sheet_id","kpi"],"title":"RootCauseRequest","description":"Request for root cause analysis"},"RootCauseResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"kpi":{"type":"string","title":"Kpi","default":""},"root_causes":{"items":{"type":"object"},"type":"array","title":"Root Causes","default":[]},"correlations":{"items":{"type":"object"},"type":"array","title":"Correlations","default":[]},"recommendations":{"items":{"type":"string"},"type":"array","title":"Recommendations","default":[]},"processing_time_ms":{"type":"integer","title":"Processing Time Ms","default":0}},"type":"object","required":["success"],"title":"RootCauseResponse","description":"Response for root cause analysis"},"RuleMatchResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"matched_rule":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Matched Rule"},"rule_description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Rule Description"},"confidence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Confidence"},"available_rules":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Available Rules"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"RuleMatchResponse","description":"规则匹配响应"},"SalesKPIsRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"targetData":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Targetdata","description":"Optional target data for completion rate calculation"}},"type":"object","required":["data"],"title":"SalesKPIsRequest","description":"Request model for sales KPIs"},"SalesTrendRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"periodType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Periodtype","description":"Period type: day, week, month, quarter, year","default":"month"},"periods":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Periods","description":"Number of periods to analyze","default":12}},"type":"object","required":["data"],"title":"SalesTrendRequest","description":"Request model for sales trend analysis"},"SaveRequest":{"properties":{"companyId":{"type":"string","title":"Companyid"},"items":{"items":{"$ref":"#/components/schemas/FeedbackItem"},"type":"array","title":"Items"}},"type":"object","required":["companyId","items"],"title":"SaveRequest"},"SheetAnalysisResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"sheets":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Sheets"},"recommended":{"anyOf":[{"items":{"type":"integer"},"type":"array"},{"type":"null"}],"title":"Recommended"},"summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Summary"},"method":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Method"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"SheetAnalysisResponse","description":"Sheet analysis response model"},"SheetAnalysisResultModel":{"properties":{"sheetIndex":{"type":"integer","title":"Sheetindex"},"sheetName":{"type":"string","title":"Sheetname"},"tableType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tabletype"},"rowCount":{"type":"integer","title":"Rowcount","default":0},"columnCount":{"type":"integer","title":"Columncount","default":0},"charts":{"items":{"type":"object"},"type":"array","title":"Charts","default":[]},"metrics":{"items":{"type":"object"},"type":"array","title":"Metrics","default":[]},"insights":{"items":{"type":"object"},"type":"array","title":"Insights","default":[]},"fromCache":{"type":"boolean","title":"Fromcache","default":false},"scenario":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Scenario"},"processingTimeMs":{"type":"integer","title":"Processingtimems","default":0},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["sheetIndex","sheetName"],"title":"SheetAnalysisResultModel","description":"Analysis result for a single sheet"},"SheetInfo":{"properties":{"name":{"type":"string","title":"Name"},"index":{"type":"integer","title":"Index"},"rowCount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rowcount"},"columnCount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Columncount"},"hasData":{"type":"boolean","title":"Hasdata","default":true},"previewHeaders":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Previewheaders"}},"type":"object","required":["name","index"],"title":"SheetInfo","description":"Detailed information about a sheet"},"SheetKPI":{"properties":{"sheetName":{"type":"string","title":"Sheetname"},"kpis":{"additionalProperties":{"type":"number"},"type":"object","title":"Kpis"}},"type":"object","required":["sheetName","kpis"],"title":"SheetKPI","description":"KPI data for a single sheet"},"SheetNamesResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"sheetNames":{"items":{"type":"string"},"type":"array","title":"Sheetnames","default":[]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"SheetNamesResponse","description":"Sheet names response model"},"SmartParseResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"rule_used":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Rule Used"},"rule_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Rule Type"},"sheet_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sheet Name"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"columns":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Columns"},"row_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Row Count"},"column_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Column Count"},"preview_rows":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Preview Rows"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"SmartParseResponse","description":"智能解析响应"},"StructureAnalysisModel":{"properties":{"success":{"type":"boolean","title":"Success"},"sheet_name":{"type":"string","title":"Sheet Name"},"total_rows":{"type":"integer","title":"Total Rows"},"total_cols":{"type":"integer","title":"Total Cols"},"title_rows":{"items":{"type":"integer"},"type":"array","title":"Title Rows"},"header_rows":{"items":{"type":"integer"},"type":"array","title":"Header Rows"},"data_start_row":{"type":"integer","title":"Data Start Row"},"data_end_row":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Data End Row"},"columns":{"items":{"$ref":"#/components/schemas/ColumnInfoModel"},"type":"array","title":"Columns"},"table_type":{"type":"string","title":"Table Type"},"table_type_confidence":{"type":"number","title":"Table Type Confidence"},"merged_cells_meaning":{"additionalProperties":{"type":"string"},"type":"object","title":"Merged Cells Meaning","default":{}},"notes":{"items":{"type":"string"},"type":"array","title":"Notes","default":[]},"method":{"type":"string","title":"Method","default":"llm"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success","sheet_name","total_rows","total_cols","title_rows","header_rows","data_start_row","columns","table_type","table_type_confidence"],"title":"StructureAnalysisModel","description":"结构分析模型"},"UpdateModelRequest":{"properties":{"matrixA":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","title":"Matrixa","description":"Current A matrix"},"vectorB":{"items":{"type":"number"},"type":"array","title":"Vectorb","description":"Current b vector"},"context":{"items":{"type":"number"},"type":"array","title":"Context","description":"Context features x"},"reward":{"type":"number","maximum":2.0,"minimum":0.0,"title":"Reward","description":"Observed reward r (0-2, can exceed 1.0 when exceeding targets)"}},"type":"object","required":["matrixA","vectorB","context","reward"],"title":"UpdateModelRequest","description":"Request model for updating LinUCB model with feedback"},"UpdateModelResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"matrixA":{"anyOf":[{"items":{"items":{"type":"number"},"type":"array"},"type":"array"},{"type":"null"}],"title":"Matrixa","description":"Updated A matrix"},"matrixAInverse":{"anyOf":[{"items":{"items":{"type":"number"},"type":"array"},"type":"array"},{"type":"null"}],"title":"Matrixainverse","description":"Updated A inverse matrix"},"vectorB":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Vectorb","description":"Updated b vector"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"}},"type":"object","required":["success"],"title":"UpdateModelResponse","description":"Response model for model update"},"ValidateRequest":{"properties":{"matrixA":{"items":{"items":{"type":"number"},"type":"array"},"type":"array","title":"Matrixa","description":"A matrix to validate"},"vectorB":{"items":{"type":"number"},"type":"array","title":"Vectorb","description":"b vector to validate"}},"type":"object","required":["matrixA","vectorB"],"title":"ValidateRequest","description":"Request model for validating LinUCB model parameters"},"ValidateResponse":{"properties":{"valid":{"type":"boolean","title":"Valid"},"featureDim":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Featuredim","description":"Feature dimension"},"conditionNumber":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Conditionnumber","description":"Matrix condition number"},"isSymmetric":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Issymmetric","description":"Whether matrix is symmetric"},"isPositiveDefinite":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Ispositivedefinite","description":"Whether matrix is positive definite"},"hasNaN":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Hasnan","description":"Whether matrix contains NaN values"},"hasInf":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Hasinf","description":"Whether matrix contains Inf values"},"isHealthy":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Ishealthy","description":"Overall model health status"},"recommendation":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Recommendation","description":"Recommendation for model state"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if validation failed"}},"type":"object","required":["valid"],"title":"ValidateResponse","description":"Response model for model validation"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"ValidationIssueModel":{"properties":{"level":{"type":"string","title":"Level"},"category":{"type":"string","title":"Category"},"message":{"type":"string","title":"Message"},"details":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Details"}},"type":"object","required":["level","category","message"],"title":"ValidationIssueModel","description":"验证问题模型"},"ValidationResultModel":{"properties":{"success":{"type":"boolean","title":"Success"},"sheet_name":{"type":"string","title":"Sheet Name"},"has_errors":{"type":"boolean","title":"Has Errors"},"issue_count":{"type":"integer","title":"Issue Count"},"issues":{"items":{"$ref":"#/components/schemas/ValidationIssueModel"},"type":"array","title":"Issues"},"summary":{"type":"object","title":"Summary"},"llm_review":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Llm Review"}},"type":"object","required":["success","sheet_name","has_errors","issue_count","issues","summary"],"title":"ValidationResultModel","description":"验证结果模型"},"YoYMoMRequest":{"properties":{"data":{"items":{"type":"object"},"type":"array","title":"Data","description":"Data to analyze"},"fieldMapping":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Fieldmapping","description":"Optional mapping from standard field names to actual column names"},"year1":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Year1","description":"First year for comparison"},"year2":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Year2","description":"Second year for comparison"},"metric":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Metric","description":"Metric to compare","default":"sales_amount"}},"type":"object","required":["data"],"title":"YoYMoMRequest","description":"Request model for Year-over-Year and Month-over-Month analysis"},"YoYRequest":{"properties":{"upload_id":{"type":"integer","title":"Upload Id","description":"Current period upload ID"},"compare_upload_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Compare Upload Id","description":"Previous period upload ID (auto-detect if omitted)"},"factory_id":{"type":"string","title":"Factory Id","description":"Factory ID","default":"F001"}},"type":"object","required":["upload_id"],"title":"YoYRequest","description":"Request for YoY comparison"},"YoYResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"current_upload_id":{"type":"integer","title":"Current Upload Id"},"compare_upload_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Compare Upload Id"},"current_period":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Current Period"},"compare_period":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Compare Period"},"comparison":{"items":{"$ref":"#/components/schemas/ComparisonItem"},"type":"array","title":"Comparison","default":[]},"summary":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Summary"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success","current_upload_id"],"title":"YoYResponse","description":"YoY comparison response"}}}}
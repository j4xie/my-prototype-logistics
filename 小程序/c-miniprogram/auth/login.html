<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>å¾®ä¿¡æˆæƒç™»å½• - æº¯æºå•†åŸ</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../../assets/css/variables.css">
  <link rel="stylesheet" href="../../assets/css/common.css">
  <link rel="stylesheet" href="../../assets/css/mobile.css">

  <style>
    .login-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: var(--primary-gradient);
      padding: var(--spacing-3xl) var(--spacing-2xl);
    }

    .login-logo {
      width: 120px;
      height: 120px;
      background: var(--bg-white);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--font-size-5xl);
      margin-bottom: var(--spacing-2xl);
      box-shadow: var(--shadow-lg);
    }

    .login-title {
      font-size: var(--font-size-3xl);
      font-weight: var(--font-weight-bold);
      color: var(--text-inverse);
      margin-bottom: var(--spacing-md);
      text-align: center;
    }

    .login-subtitle {
      font-size: var(--font-size-base);
      color: var(--text-inverse);
      opacity: 0.9;
      margin-bottom: var(--spacing-5xl);
      text-align: center;
    }

    .login-card {
      width: 100%;
      max-width: 350px;
      background: var(--bg-white);
      border-radius: var(--radius-xl);
      padding: var(--spacing-3xl) var(--spacing-2xl);
      box-shadow: var(--shadow-xl);
    }

    .wechat-btn {
      width: 100%;
      padding: var(--spacing-lg);
      background: #07c160;
      color: var(--text-inverse);
      border: none;
      border-radius: var(--radius-pill);
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-md);
      cursor: pointer;
      transition: all var(--transition-base);
      box-shadow: var(--shadow-md);
    }

    .wechat-btn:active {
      transform: scale(0.98);
      box-shadow: var(--shadow-sm);
    }

    .wechat-btn-icon {
      font-size: var(--font-size-2xl);
    }

    .divider {
      display: flex;
      align-items: center;
      margin: var(--spacing-2xl) 0;
      color: var(--text-tertiary);
      font-size: var(--font-size-sm);
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border-color);
    }

    .divider::before {
      margin-right: var(--spacing-md);
    }

    .divider::after {
      margin-left: var(--spacing-md);
    }

    .phone-login-btn {
      width: 100%;
      padding: var(--spacing-md);
      background: transparent;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
      border-radius: var(--radius-pill);
      font-size: var(--font-size-base);
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .phone-login-btn:active {
      background: var(--bg-hover);
    }

    .agreement {
      margin-top: var(--spacing-2xl);
      font-size: var(--font-size-xs);
      color: var(--text-tertiary);
      text-align: center;
      line-height: 1.6;
    }

    .agreement-link {
      color: var(--primary-color);
      text-decoration: none;
    }

    .features {
      margin-top: var(--spacing-5xl);
      display: flex;
      justify-content: space-around;
      width: 100%;
      max-width: 350px;
    }

    .feature-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-sm);
      color: var(--text-inverse);
    }

    .feature-icon {
      font-size: var(--font-size-3xl);
    }

    .feature-label {
      font-size: var(--font-size-xs);
      opacity: 0.9;
    }

    /* æ¨¡æ€æ¡† */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: var(--z-index-modal);
      justify-content: center;
      align-items: center;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      padding: var(--spacing-3xl) var(--spacing-2xl);
      max-width: 300px;
      width: 90%;
      text-align: center;
    }

    .modal-icon {
      font-size: var(--font-size-5xl);
      margin-bottom: var(--spacing-lg);
    }

    .modal-title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      margin-bottom: var(--spacing-md);
    }

    .modal-message {
      font-size: var(--font-size-base);
      color: var(--text-secondary);
      margin-bottom: var(--spacing-2xl);
      line-height: 1.6;
    }

    .modal-btn {
      width: 100%;
      padding: var(--spacing-md);
      background: var(--primary-color);
      color: var(--text-inverse);
      border: none;
      border-radius: var(--radius-pill);
      font-size: var(--font-size-base);
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="mobile-container">
    <div class="login-container">
      <!-- Logo -->
      <div class="login-logo">ğŸ±</div>

      <!-- æ ‡é¢˜ -->
      <h1 class="login-title">æº¯æºå•†åŸ</h1>
      <p class="login-subtitle">å…¨ç¨‹å¯è¿½æº¯ Â· å“è´¨æœ‰ä¿éšœ</p>

      <!-- ç™»å½•å¡ç‰‡ -->
      <div class="login-card">
        <!-- å¾®ä¿¡ç™»å½•æŒ‰é’® -->
        <button class="wechat-btn" onclick="wechatLogin()">
          <span class="wechat-btn-icon"></span>
          <span>å¾®ä¿¡ä¸€é”®ç™»å½•</span>
        </button>

        <!-- åˆ†éš”çº¿ -->
        <div class="divider">å…¶ä»–ç™»å½•æ–¹å¼</div>

        <!-- æ‰‹æœºå·ç™»å½• -->
        <button class="phone-login-btn" onclick="phoneLogin()">
          æ‰‹æœºå·ç™»å½•
        </button>

        <!-- ç”¨æˆ·åè®® -->
        <div class="agreement">
          ç™»å½•å³è¡¨ç¤ºåŒæ„
          <a href="#" class="agreement-link">ã€Šç”¨æˆ·åè®®ã€‹</a>
          å’Œ
          <a href="#" class="agreement-link">ã€Šéšç§æ”¿ç­–ã€‹</a>
        </div>
      </div>

      <!-- ç‰¹æ€§å±•ç¤º -->
      <div class="features">
        <div class="feature-item">
          <div class="feature-icon"></div>
          <div class="feature-label">æ‰«ç æº¯æº</div>
        </div>
        <div class="feature-item">
          <div class="feature-icon"></div>
          <div class="feature-label">AIæ™ºèƒ½</div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">âœ“</div>
          <div class="feature-label">å“è´¨ä¿è¯</div>
        </div>
      </div>
    </div>
  </div>

  <!-- æˆæƒå¼¹çª— -->
  <div class="modal" id="authModal">
    <div class="modal-content">
      <div class="modal-icon"></div>
      <h3 class="modal-title">å¾®ä¿¡æˆæƒç™»å½•</h3>
      <p class="modal-message">
        æº¯æºå•†åŸå°†è·å–ä½ çš„<br>
        å¾®ä¿¡æ˜µç§°ã€å¤´åƒç­‰å…¬å¼€ä¿¡æ¯
      </p>
      <button class="modal-btn" onclick="confirmAuth()">ç¡®è®¤æˆæƒ</button>
      <div style="margin-top: var(--spacing-md);">
        <button class="phone-login-btn" onclick="cancelAuth()">å–æ¶ˆ</button>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script src="../../assets/js/mockData.js"></script>
  <script src="../../assets/js/stateManager.js"></script>
  <script src="../../assets/js/utils.js"></script>

  <script>
    // ==================== å¾®ä¿¡ç™»å½• ====================
    function wechatLogin() {
      // æ˜¾ç¤ºæˆæƒå¼¹çª—
      const modal = document.getElementById('authModal');
      modal.classList.add('show');
    }

    // ==================== ç¡®è®¤æˆæƒ ====================
    async function confirmAuth() {
      const modal = document.getElementById('authModal');
      modal.classList.remove('show');

      // æ˜¾ç¤ºåŠ è½½æç¤º
      const hideLoading = Utils.showLoading('æˆæƒç™»å½•ä¸­...');

      try {
        // æ¨¡æ‹Ÿæˆæƒå»¶è¿Ÿ
        await Utils.sleep(1500);

        // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®ï¼ˆå®é™…åº”ä»å¾®ä¿¡è·å–ï¼‰
        const userData = {
          id: 1,
          name: 'å¼ ä¸‰',
          phone: '138****1234',
          avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Zhang',
          level: 'VIP'
        };

        // ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°çŠ¶æ€ç®¡ç†
        globalState.set(StateKeys.USER, userData);
        globalState.set(StateKeys.IS_LOGGED_IN, true);
        globalState.set(StateKeys.ACCESS_TOKEN, 'mock_token_' + Date.now());

        hideLoading();
        Utils.showToast('ç™»å½•æˆåŠŸ', 'success');

        // å»¶è¿Ÿè·³è½¬åˆ°é¦–é¡µ
        setTimeout(() => {
          window.location.href = '../home/home.html';
        }, 1000);

      } catch (error) {
        hideLoading();
        Utils.showToast('ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
      }
    }

    // ==================== å–æ¶ˆæˆæƒ ====================
    function cancelAuth() {
      const modal = document.getElementById('authModal');
      modal.classList.remove('show');
    }

    // ==================== æ‰‹æœºå·ç™»å½• ====================
    function phoneLogin() {
      Utils.showToast('æ‰‹æœºå·ç™»å½•åŠŸèƒ½å¼€å‘ä¸­...', 'info');
      // å®é™…åº”è·³è½¬åˆ°æ‰‹æœºå·ç™»å½•é¡µé¢
      // window.location.href = 'phone-login.html';
    }

    // ==================== æ£€æŸ¥ç™»å½•çŠ¶æ€ ====================
    document.addEventListener('DOMContentLoaded', () => {
      const isLoggedIn = globalState.get(StateKeys.IS_LOGGED_IN, false);

      if (isLoggedIn) {
        // å·²ç™»å½•ï¼Œç›´æ¥è·³è½¬åˆ°é¦–é¡µ
        Utils.showToast('æ‚¨å·²ç™»å½•', 'info');
        setTimeout(() => {
          window.location.href = '../home/home.html';
        }, 1000);
      }
    });

    // ==================== ç‚¹å‡»èƒŒæ™¯å…³é—­å¼¹çª— ====================
    document.getElementById('authModal').addEventListener('click', (e) => {
      if (e.target.id === 'authModal') {
        cancelAuth();
      }
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è®¢å•åˆ—è¡¨ - ç™½å©çºªé£Ÿå“æº¯æºç®¡ç†åå°</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../../assets/css/variables.css">
  <link rel="stylesheet" href="../../assets/css/common.css">
  <link rel="stylesheet" href="../../assets/css/desktop.css?v=1765970920">

  <style>
    /* ç­›é€‰æ  */
    .filter-bar {
      background: var(--bg-white);
      padding: var(--spacing-lg);
      border-radius: var(--radius-md);
      margin-bottom: var(--spacing-lg);
      display: flex;
      gap: var(--spacing-md);
      align-items: flex-end;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-xs);
      min-width: 200px;
    }

    .filter-group.search {
      flex: 1;
      min-width: 300px;
    }

    .filter-label {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      font-weight: var(--font-weight-medium);
    }

    .filter-select,
    .filter-input {
      padding: var(--spacing-sm) var(--spacing-md);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      font-size: var(--font-size-base);
      outline: none;
      transition: border-color var(--transition-base);
    }

    .filter-select:focus,
    .filter-input:focus {
      border-color: var(--primary-color);
    }

    .filter-actions {
      display: flex;
      gap: var(--spacing-sm);
      margin-left: auto;
    }

    /* è¡¨æ ¼åŒºåŸŸ */
    .table-section {
      background: var(--bg-white);
      border-radius: var(--radius-md);
      overflow: hidden;
    }

    .table-header {
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      color: var(--text-primary);
    }

    .table-count {
      font-size: var(--font-size-sm);
      color: var(--text-tertiary);
      margin-left: var(--spacing-sm);
    }

    /* è¡¨æ ¼æ ·å¼ */
    .table-wrapper {
      overflow-x: auto;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
    }

    .table thead {
      background: var(--bg-gray);
    }

    .table th {
      padding: var(--spacing-md) var(--spacing-lg);
      text-align: left;
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-semibold);
      color: var(--text-secondary);
      border-bottom: 1px solid var(--border-color);
      white-space: nowrap;
    }

    .table td {
      padding: var(--spacing-md) var(--spacing-lg);
      border-bottom: 1px solid var(--border-color);
      font-size: var(--font-size-sm);
      color: var(--text-primary);
    }

    .table tbody tr:hover {
      background: var(--bg-gray);
    }

    /* çŠ¶æ€å¾½ç«  */
    .status-badge {
      display: inline-block;
      padding: 4px var(--spacing-sm);
      border-radius: var(--radius-pill);
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-medium);
    }

    .status-pending { background: rgba(250, 173, 20, 0.1); color: var(--warning-color); }
    .status-shipping { background: rgba(24, 144, 255, 0.1); color: var(--info-color); }
    .status-completed { background: rgba(82, 196, 26, 0.1); color: var(--success-color); }
    .status-cancelled { background: rgba(0, 0, 0, 0.06); color: var(--text-tertiary); }

    /* æ“ä½œæŒ‰é’® */
    .action-btn {
      padding: 4px var(--spacing-sm);
      border: none;
      background: none;
      color: var(--primary-color);
      font-size: var(--font-size-sm);
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .action-btn:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="desktop-container">
    <!-- ä¾§è¾¹æ  (å°†åœ¨æœ€åç»Ÿä¸€æ›´æ–°) -->
            <div class="desktop-sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">ğŸ¢ ç™½å©çºªç®¡ç†åå°</div>
      </div>
      <nav class="sidebar-nav">
        <a href="../dashboard/overview.html" class="nav-item">
          <span class="icon">ğŸ“Š</span>
          <span class="text">æ§åˆ¶å°</span>
        </a>
        
        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸ“¦</span>
                <span class="text">å•†å“ä¸è®¢å•</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../product-management/list.html" class="nav-sub-item">å•†å“ç®¡ç†</a>
            <a href="../orders/list.html" class="nav-sub-item">è®¢å•ç®¡ç†</a>
            <a href="../traceability/batch-list.html" class="nav-sub-item">æº¯æºç®¡ç†</a>
          </div>
        </div>

        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸª</span>
                <span class="text">è¿è¥ä¸å†…å®¹</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../merchant/list.html" class="nav-sub-item">å•†æˆ·ç®¡ç†</a>
            <a href="../user-management/list.html" class="nav-sub-item">ç”¨æˆ·ç®¡ç†</a>
            <a href="../content-control/review-queue.html" class="nav-sub-item">å†…å®¹å®¡æ ¸</a>
            <a href="../traffic-ad/ad-slots.html" class="nav-sub-item">å¹¿å‘ŠæŠ•æ”¾</a>
          </div>
        </div>

        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸ¤–</span>
                <span class="text">AIä¸è®¾ç½®</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../ai-knowledge/knowledge-base.html" class="nav-sub-item">AIçŸ¥è¯†åº“</a>
            <a href="../analytics/traffic-stats.html" class="nav-sub-item">æ•°æ®åˆ†æ</a>
          </div>
        </div>
      </nav>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="desktop-main">
      <div class="desktop-header">
        <div class="header-title">è®¢å•åˆ—è¡¨</div>
        <div class="header-actions">
           <button class="btn btn-default" onclick="Utils.showToast('è®¾ç½®', 'info')">è®¾ç½®</button>
        </div>
      </div>

      <div class="breadcrumb">
        <a href="../dashboard/overview.html">é¦–é¡µ</a>
        <span class="breadcrumb-separator">/</span>
        <span>è®¢å•ç®¡ç†</span>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">è®¢å•åˆ—è¡¨</span>
      </div>

      <div class="desktop-content">
        <!-- ç­›é€‰æ  -->
        <div class="filter-bar">
          <div class="filter-group">
            <label class="filter-label">è®¢å•çŠ¶æ€</label>
            <select class="filter-select" id="statusFilter" onchange="renderTable()">
              <option value="">å…¨éƒ¨çŠ¶æ€</option>
              <option value="pending">å¾…ä»˜æ¬¾/å¾…å‘è´§</option>
              <option value="shipping">è¿è¾“ä¸­</option>
              <option value="completed">å·²å®Œæˆ</option>
              <option value="cancelled">å·²å–æ¶ˆ</option>
            </select>
          </div>
          <div class="filter-group search">
            <label class="filter-label">æœç´¢</label>
            <input type="text" class="filter-input" id="searchInput" placeholder="æœç´¢è®¢å•å·ã€æ”¶è´§äºº..." oninput="renderTable()">
          </div>
          <div class="filter-actions">
            <button class="btn btn-default" onclick="resetFilters()">é‡ç½®</button>
          </div>
        </div>

        <!-- è¡¨æ ¼ -->
        <div class="table-section">
          <div class="table-header">
            <div>
              <span class="table-title">è®¢å•æ•°æ®</span>
              <span class="table-count" id="totalCount">(å…± 0 æ¡)</span>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="table">
              <thead>
                <tr>
                  <th>è®¢å•å·</th>
                  <th>ä¸‹å•ç”¨æˆ·</th>
                  <th>å•†å“æ¦‚å†µ</th>
                  <th>æ€»é‡‘é¢</th>
                  <th>æ”¯ä»˜æ–¹å¼</th>
                  <th>çŠ¶æ€</th>
                  <th>ä¸‹å•æ—¶é—´</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="tableBody">
                <!-- Data injected by JS -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../../assets/js/mockData.js?v=1765970807"></script>
  <script src="../../assets/js/utils.js?v=1765970711"></script>
  <script>
    // Ensure MockDB.orders exists (if empty in mockData.js, we simulate some)
    if (!MockDB.orders || MockDB.orders.length === 0) {
        // Generate some mock orders if none exist
        MockDB.orders = [
            {
                id: 1001,
                user: { name: 'å¼ ä¸‰', phone: '138****1234' },
                items: [
                    { name: 'æµæ²™é»„é‡‘éº»çƒå’¸è›‹é»„', quantity: 2, price: 294.00 }
                ],
                totalAmount: 588.00,
                status: 'completed',
                createTime: '2025-01-10 10:30:00',
                paymentMethod: 'wx_pay',
                isMerged: false
            },
            {
                id: 1002,
                user: { name: 'æå››', phone: '139****5678' },
                items: [
                    { name: 'é²œæ´»å¤§é—¸èŸ¹', quantity: 10, price: 58.00 }
                ],
                totalAmount: 580.00,
                status: 'pending',
                createTime: '2025-01-12 14:20:00',
                paymentMethod: 'wx_pay',
                isMerged: true // Merged payment
            }
        ];
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderTable();
    });

    function renderTable() {
      const statusFilter = document.getElementById('statusFilter').value;
      const searchInput = document.getElementById('searchInput').value.toLowerCase();

      const filtered = MockDB.orders.filter(order => {
        if (statusFilter && order.status !== statusFilter) return false;
        if (searchInput) {
            const matchId = String(order.id).toLowerCase().includes(searchInput);
            const matchUser = order.user.name.toLowerCase().includes(searchInput);
            return matchId || matchUser;
        }
        return true;
      });

      document.getElementById('totalCount').textContent = `(å…± ${filtered.length} æ¡)`;
      const tbody = document.getElementById('tableBody');
      
      if (filtered.length === 0) {
          tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;padding:20px;color:#999;">æš‚æ— æ•°æ®</td></tr>';
          return;
      }

      tbody.innerHTML = filtered.map(order => {
        const statusMap = {
            'pending': 'å¾…å¤„ç†',
            'shipping': 'è¿è¾“ä¸­',
            'completed': 'å·²å®Œæˆ',
            'cancelled': 'å·²å–æ¶ˆ'
        };
        const statusClass = `status-${order.status}`;
        
        const firstItem = order.items[0] || { name: 'æœªçŸ¥å•†å“', quantity: 0 };
        const itemSummary = order.items.length > 1 
            ? `${firstItem.name} ç­‰${order.items.length}ä»¶` 
            : `${firstItem.name} x${firstItem.quantity}`;

        return `
          <tr>
            <td>${order.id}</td>
            <td>${order.user.name}<br><span style="color:#999;font-size:12px">${order.user.phone}</span></td>
            <td>${itemSummary}</td>
            <td style="font-weight:bold;color:var(--error-color)">Â¥${order.totalAmount.toFixed(2)}</td>
            <td>
                ${order.isMerged ? '<span class="status-badge" style="background:#f0f5ff;color:#2f54eb">åˆå¹¶æ”¯ä»˜</span>' : 'æ™®é€šæ”¯ä»˜'}
            </td>
            <td><span class="status-badge ${statusClass}">${statusMap[order.status] || order.status}</span></td>
            <td>${order.createTime}</td>
            <td>
              <button class="action-btn" onclick="viewDetail(${order.id})">æŸ¥çœ‹è¯¦æƒ…</button>
              ${order.status === 'pending' ? `<button class="action-btn" onclick="shipOrder(${order.id})">å‘è´§</button>` : ''}
            </td>
          </tr>
        `;
      }).join('');
    }

    function resetFilters() {
        document.getElementById('statusFilter').value = '';
        document.getElementById('searchInput').value = '';
        renderTable();
    }

    function viewDetail(id) {
        window.location.href = `detail.html?id=${id}`;
    }

    function shipOrder(id) {
        if(confirm('ç¡®è®¤å‘è´§è®¢å• ' + id + '?')) {
            const order = MockDB.orders.find(o => o.id === id);
            if(order) {
                order.status = 'shipping';
                renderTable();
                Utils.showToast('å‘è´§æˆåŠŸ', 'success');
            }
        }
    }
  </script>
</body>
</html>




































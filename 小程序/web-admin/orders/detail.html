<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è®¢å•è¯¦æƒ… - ç™½å©çºªé£Ÿå“æº¯æºç®¡ç†åå°</title>
  <link rel="stylesheet" href="../../assets/css/variables.css">
  <link rel="stylesheet" href="../../assets/css/common.css">
  <link rel="stylesheet" href="../../assets/css/desktop.css?v=1765970920">
  <style>
      .detail-card {
          background: var(--bg-white);
          border-radius: var(--radius-md);
          padding: var(--spacing-xl);
          margin-bottom: var(--spacing-lg);
      }
      .section-title {
          font-size: var(--font-size-lg);
          font-weight: bold;
          margin-bottom: var(--spacing-md);
          border-bottom: 1px solid var(--border-color);
          padding-bottom: var(--spacing-sm);
      }
      .info-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: var(--spacing-lg);
      }
      .info-item label {
          color: var(--text-tertiary);
          font-size: var(--font-size-sm);
          display: block;
          margin-bottom: 4px;
      }
      .info-item div {
          color: var(--text-primary);
          font-weight: 500;
      }
      .product-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: var(--spacing-md);
      }
      .product-table th, .product-table td {
          padding: var(--spacing-md);
          border-bottom: 1px solid var(--border-color);
          text-align: left;
      }
      .product-table th {
          background: var(--bg-gray);
          color: var(--text-secondary);
      }
      .total-bar {
          text-align: right;
          margin-top: var(--spacing-lg);
          font-size: var(--font-size-lg);
      }
      .total-price {
          color: var(--error-color);
          font-size: var(--font-size-2xl);
          font-weight: bold;
      }
  </style>
</head>
<body>
  <div class="desktop-container">
            <div class="desktop-sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">ğŸ¢ ç™½å©çºªç®¡ç†åå°</div>
      </div>
      <nav class="sidebar-nav">
        <a href="../dashboard/overview.html" class="nav-item">
          <span class="icon">ğŸ“Š</span>
          <span class="text">æ§åˆ¶å°</span>
        </a>
        
        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸ“¦</span>
                <span class="text">å•†å“ä¸è®¢å•</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../product-management/list.html" class="nav-sub-item">å•†å“ç®¡ç†</a>
            <a href="../orders/list.html" class="nav-sub-item">è®¢å•ç®¡ç†</a>
            <a href="../traceability/batch-list.html" class="nav-sub-item">æº¯æºç®¡ç†</a>
          </div>
        </div>

        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸª</span>
                <span class="text">è¿è¥ä¸å†…å®¹</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../merchant/list.html" class="nav-sub-item">å•†æˆ·ç®¡ç†</a>
            <a href="../user-management/list.html" class="nav-sub-item">ç”¨æˆ·ç®¡ç†</a>
            <a href="../content-control/review-queue.html" class="nav-sub-item">å†…å®¹å®¡æ ¸</a>
            <a href="../traffic-ad/ad-slots.html" class="nav-sub-item">å¹¿å‘ŠæŠ•æ”¾</a>
          </div>
        </div>

        <div class="nav-group">
          <div class="nav-group-title" onclick="toggleSidebarGroup(this)">
            <div class="title-wrap">
                <span class="icon">ğŸ¤–</span>
                <span class="text">AIä¸è®¾ç½®</span>
            </div>
            <span class="arrow">â–¼</span>
          </div>
          <div class="nav-sub-menu">
            <a href="../ai-knowledge/knowledge-base.html" class="nav-sub-item">AIçŸ¥è¯†åº“</a>
            <a href="../analytics/traffic-stats.html" class="nav-sub-item">æ•°æ®åˆ†æ</a>
          </div>
        </div>
      </nav>
    </div>
    </div>

    <div class="desktop-main">
      <div class="desktop-header">
        <div class="header-title">è®¢å•è¯¦æƒ…</div>
        <div class="header-actions">
           <button class="btn btn-default" onclick="history.back()">è¿”å›åˆ—è¡¨</button>
        </div>
      </div>

      <div class="breadcrumb">
        <a href="../dashboard/overview.html">é¦–é¡µ</a>
        <span class="breadcrumb-separator">/</span>
        <a href="list.html">è®¢å•ç®¡ç†</a>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">è®¢å•è¯¦æƒ…</span>
      </div>

      <div class="desktop-content">
        <div id="loading">åŠ è½½ä¸­...</div>
        <div id="orderContent" style="display:none;">
            
            <!-- Basic Info -->
            <div class="detail-card">
                <div class="section-title">åŸºæœ¬ä¿¡æ¯</div>
                <div class="info-grid">
                    <div class="info-item"><label>è®¢å•ç¼–å·</label><div id="orderId"></div></div>
                    <div class="info-item"><label>ä¸‹å•æ—¶é—´</label><div id="createTime"></div></div>
                    <div class="info-item"><label>å½“å‰çŠ¶æ€</label><div id="status"></div></div>
                    <div class="info-item"><label>æ”¯ä»˜æ–¹å¼</label><div id="payMethod"></div></div>
                    <div class="info-item"><label>åˆå¹¶æ”¯ä»˜</label><div id="isMerged"></div></div>
                </div>
            </div>

            <!-- User Info -->
            <div class="detail-card">
                <div class="section-title">ä¹°å®¶ä¿¡æ¯</div>
                <div class="info-grid">
                    <div class="info-item"><label>ä¹°å®¶æ˜µç§°</label><div id="userName"></div></div>
                    <div class="info-item"><label>è”ç³»ç”µè¯</label><div id="userPhone"></div></div>
                    <div class="info-item"><label>æ”¶è´§åœ°å€</label><div id="userAddress">ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒºå¼ æ±Ÿé«˜ç§‘å›­åŒº (Mock)</div></div>
                </div>
            </div>

            <!-- Product List -->
            <div class="detail-card">
                <div class="section-title">å•†å“æ¸…å•</div>
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>å•†å“åç§°</th>
                            <th>å•ä»·</th>
                            <th>æ•°é‡</th>
                            <th>å°è®¡</th>
                        </tr>
                    </thead>
                    <tbody id="productBody">
                        <!-- JS injected -->
                    </tbody>
                </table>
                <div class="total-bar">
                    è®¢å•æ€»é¢: <span class="total-price" id="totalAmount"></span>
                </div>
            </div>

            <!-- Actions -->
            <div class="detail-card" style="text-align: right;">
                <button class="btn btn-default" onclick="history.back()">è¿”å›</button>
                <button class="btn btn-primary" id="shipBtn" onclick="doShip()" style="display:none;">ç¡®è®¤å‘è´§</button>
            </div>

        </div>
      </div>
    </div>
  </div>

  <script src="../../assets/js/mockData.js?v=1765970807"></script>
  <script src="../../assets/js/utils.js?v=1765970711"></script>
  <script>
    let currentOrder = null;
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        
        // Mock data load if MockDB empty
        if (!MockDB.orders || MockDB.orders.length === 0) {
             MockDB.orders = [
                {
                    id: 1001,
                    user: { name: 'å¼ ä¸‰', phone: '138****1234' },
                    items: [ { name: 'æµæ²™é»„é‡‘éº»çƒå’¸è›‹é»„', quantity: 2, price: 294.00 } ],
                    totalAmount: 588.00,
                    status: 'completed',
                    createTime: '2025-01-10 10:30:00',
                    paymentMethod: 'wx_pay',
                    isMerged: false
                }
            ];
        }

        currentOrder = MockDB.orders.find(o => o.id == id);
        
        if (!currentOrder) {
            document.getElementById('loading').textContent = 'è®¢å•ä¸å­˜åœ¨';
            return;
        }

        document.getElementById('loading').style.display = 'none';
        document.getElementById('orderContent').style.display = 'block';
        
        // Fill Data
        document.getElementById('orderId').textContent = currentOrder.id;
        document.getElementById('createTime').textContent = currentOrder.createTime;
        document.getElementById('status').textContent = currentOrder.status;
        document.getElementById('payMethod').textContent = currentOrder.paymentMethod === 'wx_pay' ? 'å¾®ä¿¡æ”¯ä»˜' : 'å…¶ä»–';
        document.getElementById('isMerged').textContent = currentOrder.isMerged ? 'æ˜¯' : 'å¦';
        
        document.getElementById('userName').textContent = currentOrder.user.name;
        document.getElementById('userPhone').textContent = currentOrder.user.phone;
        
        const tbody = document.getElementById('productBody');
        tbody.innerHTML = currentOrder.items.map(item => `
            <tr>
                <td>${item.name}</td>
                <td>Â¥${item.price.toFixed(2)}</td>
                <td>${item.quantity}</td>
                <td>Â¥${(item.price * item.quantity).toFixed(2)}</td>
            </tr>
        `).join('');
        
        document.getElementById('totalAmount').textContent = 'Â¥' + currentOrder.totalAmount.toFixed(2);

        if (currentOrder.status === 'pending') {
            document.getElementById('shipBtn').style.display = 'inline-block';
        }
    });

    function doShip() {
        if(confirm('ç¡®è®¤å‘è´§?')) {
            currentOrder.status = 'shipping';
            document.getElementById('status').textContent = 'shipping';
            document.getElementById('shipBtn').style.display = 'none';
            Utils.showToast('å‘è´§æˆåŠŸ', 'success');
        }
    }
  </script>
</body>
</html>



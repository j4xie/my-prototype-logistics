asyncapi: 2.6.0
info:
  title: é£Ÿå“æº¯æºç³»ç»Ÿå¼‚æ­¥API
  version: 1.0.0-baseline
  description: |-
    é£Ÿå“æº¯æºç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—å’Œäº‹ä»¶é©±åŠ¨æ¶æ„è§„èŒƒæ–‡æ¡£

    **ç‰ˆæœ¬çŠ¶æ€**: 1.0.0-baseline - [å·²å†»ç»“] 2025-06-04T02:09:10.288Z
    **åˆ›å»ºæ—¥æœŸ**: 2025-06-03
    **é€‚ç”¨åœºæ™¯**: äº‹ä»¶é©±åŠ¨æ¶æ„ã€æ¶ˆæ¯é˜Ÿåˆ—é›†æˆã€å®æ—¶æ•°æ®åŒæ­¥

    ## æ¶ˆæ¯é˜Ÿåˆ—æ¶æ„
    - **æ¶ˆæ¯ä»£ç†**: Redis Streams / RabbitMQ
    - **äº‹ä»¶å­˜å‚¨**: PostgreSQLäº‹ä»¶è¡¨
    - **å®æ—¶é€šçŸ¥**: WebSocket + Server-Sent Events

    ## äº‹ä»¶åˆ†ç±»
    - **å†œä¸šäº‹ä»¶**: ç§æ¤ã€æ–½è‚¥ã€é‡‡æ‘˜ç­‰å†œä¸šç”Ÿäº§äº‹ä»¶
    - **åŠ å·¥äº‹ä»¶**: æ¸…æ´—ã€åŒ…è£…ã€è´¨æ£€ç­‰åŠ å·¥å¤„ç†äº‹ä»¶
    - **ç‰©æµäº‹ä»¶**: è¿è¾“ã€é…é€ã€ä»“å‚¨ç­‰ç‰©æµäº‹ä»¶
    - **ç³»ç»Ÿäº‹ä»¶**: ç”¨æˆ·æ“ä½œã€æ•°æ®å˜æ›´ç­‰ç³»ç»Ÿäº‹ä»¶

    ## æ¶ˆæ¯æ ¼å¼
    æ‰€æœ‰æ¶ˆæ¯éµå¾ªCloudEventsè§„èŒƒ:
    ```json
    {
      "specversion": "1.0",
      "type": "com.farm-trace.event.type",
      "source": "farm-trace-system",
      "id": "unique-event-id",
      "time": "2025-06-03T10:00:00Z",
      "datacontenttype": "application/json",
      "data": {}
    }
    ```


    ğŸ”’ **ç‰ˆæœ¬å·²å†»ç»“**: 2025-06-04T02:09:10.288Z
    âš ï¸ æ­¤ç‰ˆæœ¬ä¸ºPhase-3é‡æ„åŸºçº¿ï¼Œç¦æ­¢ä¿®æ”¹ã€‚åç»­å˜æ›´è¯·ä½¿ç”¨æ–°ç‰ˆæœ¬ã€‚
  contact:
    name: Phase-3æŠ€æœ¯å›¢é˜Ÿ
    email: tech-team@farm-trace.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  development:
    url: redis://localhost:6379
    protocol: redis
    description: å¼€å‘ç¯å¢ƒRedisæœåŠ¡å™¨
    variables:
      database:
        default: '0'
        description: Redisæ•°æ®åº“ç¼–å·
  production:
    url: redis://redis.farm-trace.com:6379
    protocol: redis
    description: ç”Ÿäº§ç¯å¢ƒRedisæœåŠ¡å™¨
    variables:
      database:
        default: '1'
        description: Redisæ•°æ®åº“ç¼–å·
  websocket-dev:
    url: ws://localhost:3000
    protocol: ws
    description: å¼€å‘ç¯å¢ƒWebSocketæœåŠ¡å™¨
  websocket-prod:
    url: wss://api.farm-trace.com
    protocol: wss
    description: ç”Ÿäº§ç¯å¢ƒWebSocketæœåŠ¡å™¨
defaultContentType: application/json
channels:
  farming/events:
    description: å†œä¸šç”Ÿäº§ç›¸å…³äº‹ä»¶é¢‘é“
    parameters:
      farmId:
        description: å†œåœºID
        schema:
          type: string
    subscribe:
      summary: è®¢é˜…å†œä¸šäº‹ä»¶
      description: è®¢é˜…ç‰¹å®šå†œåœºçš„å†œä¸šç”Ÿäº§äº‹ä»¶
      operationId: subscribeFarmingEvents
      message:
        oneOf:
          - $ref: '#/components/messages/PlantingEvent'
          - $ref: '#/components/messages/FertilizingEvent'
          - $ref: '#/components/messages/HarvestEvent'
          - $ref: '#/components/messages/QualityCheckEvent'
  processing/events:
    description: åŠ å·¥å¤„ç†ç›¸å…³äº‹ä»¶é¢‘é“
    parameters:
      facilityId:
        description: åŠ å·¥å‚ID
        schema:
          type: string
    subscribe:
      summary: è®¢é˜…åŠ å·¥äº‹ä»¶
      description: è®¢é˜…ç‰¹å®šåŠ å·¥è®¾æ–½çš„å¤„ç†äº‹ä»¶
      operationId: subscribeProcessingEvents
      message:
        oneOf:
          - $ref: '#/components/messages/CleaningEvent'
          - $ref: '#/components/messages/PackagingEvent'
          - $ref: '#/components/messages/QualityTestEvent'
          - $ref: '#/components/messages/StorageEvent'
  logistics/events:
    description: ç‰©æµè¿è¾“ç›¸å…³äº‹ä»¶é¢‘é“
    parameters:
      routeId:
        description: è¿è¾“è·¯çº¿ID
        schema:
          type: string
    subscribe:
      summary: è®¢é˜…ç‰©æµäº‹ä»¶
      description: è®¢é˜…ç‰¹å®šè¿è¾“è·¯çº¿çš„ç‰©æµäº‹ä»¶
      operationId: subscribeLogisticsEvents
      message:
        oneOf:
          - $ref: '#/components/messages/ShipmentEvent'
          - $ref: '#/components/messages/DeliveryEvent'
          - $ref: '#/components/messages/InventoryEvent'
          - $ref: '#/components/messages/TemperatureEvent'
  system/events:
    description: ç³»ç»Ÿçº§äº‹ä»¶é¢‘é“
    subscribe:
      summary: è®¢é˜…ç³»ç»Ÿäº‹ä»¶
      description: è®¢é˜…ç”¨æˆ·æ“ä½œå’Œç³»ç»ŸçŠ¶æ€å˜æ›´äº‹ä»¶
      operationId: subscribeSystemEvents
      message:
        oneOf:
          - $ref: '#/components/messages/UserActionEvent'
          - $ref: '#/components/messages/DataChangeEvent'
          - $ref: '#/components/messages/SystemAlertEvent'
  trace/aggregated:
    description: æº¯æºäº‹ä»¶èšåˆé¢‘é“
    parameters:
      productId:
        description: äº§å“IDæˆ–æ‰¹æ¬¡å·
        schema:
          type: string
    subscribe:
      summary: è®¢é˜…äº§å“æº¯æºäº‹ä»¶
      description: è®¢é˜…ç‰¹å®šäº§å“çš„å®Œæ•´æº¯æºäº‹ä»¶é“¾
      operationId: subscribeTraceEvents
      message:
        $ref: '#/components/messages/TraceAggregatedEvent'
  notifications/realtime:
    description: å®æ—¶é€šçŸ¥é¢‘é“ (WebSocket)
    parameters:
      userId:
        description: ç”¨æˆ·ID
        schema:
          type: string
    subscribe:
      summary: è®¢é˜…å®æ—¶é€šçŸ¥
      description: ç”¨æˆ·è®¢é˜…ä¸ªäººå®æ—¶é€šçŸ¥
      operationId: subscribeNotifications
      message:
        $ref: '#/components/messages/RealtimeNotification'
components:
  messages:
    PlantingEvent:
      name: ç§æ¤äº‹ä»¶
      title: å†œä½œç‰©ç§æ¤äº‹ä»¶
      summary: è®°å½•å†œä½œç‰©ç§æ¤æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/PlantingEventPayload'
    FertilizingEvent:
      name: æ–½è‚¥äº‹ä»¶
      title: å†œä½œç‰©æ–½è‚¥äº‹ä»¶
      summary: è®°å½•å†œä½œç‰©æ–½è‚¥æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/FertilizingEventPayload'
    HarvestEvent:
      name: é‡‡æ‘˜äº‹ä»¶
      title: å†œä½œç‰©é‡‡æ‘˜äº‹ä»¶
      summary: è®°å½•å†œä½œç‰©é‡‡æ‘˜æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/HarvestEventPayload'
    QualityCheckEvent:
      name: è´¨é‡æ£€æµ‹äº‹ä»¶
      title: äº§å“è´¨é‡æ£€æµ‹äº‹ä»¶
      summary: è®°å½•äº§å“è´¨é‡æ£€æµ‹æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/QualityCheckEventPayload'
    CleaningEvent:
      name: æ¸…æ´—äº‹ä»¶
      title: äº§å“æ¸…æ´—äº‹ä»¶
      summary: è®°å½•äº§å“æ¸…æ´—å¤„ç†æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/CleaningEventPayload'
    PackagingEvent:
      name: åŒ…è£…äº‹ä»¶
      title: äº§å“åŒ…è£…äº‹ä»¶
      summary: è®°å½•äº§å“åŒ…è£…å¤„ç†æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/PackagingEventPayload'
    QualityTestEvent:
      name: è´¨é‡æµ‹è¯•äº‹ä»¶
      title: äº§å“è´¨é‡æµ‹è¯•äº‹ä»¶
      summary: è®°å½•äº§å“è´¨é‡æµ‹è¯•æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/QualityTestEventPayload'
    StorageEvent:
      name: å­˜å‚¨äº‹ä»¶
      title: äº§å“å­˜å‚¨äº‹ä»¶
      summary: è®°å½•äº§å“å…¥åº“å­˜å‚¨æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/StorageEventPayload'
    ShipmentEvent:
      name: å‘è´§äº‹ä»¶
      title: äº§å“å‘è´§äº‹ä»¶
      summary: è®°å½•äº§å“å‘è´§ç‰©æµæ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/ShipmentEventPayload'
    DeliveryEvent:
      name: é…é€äº‹ä»¶
      title: äº§å“é…é€äº‹ä»¶
      summary: è®°å½•äº§å“é…é€æ´»åŠ¨
      contentType: application/json
      payload:
        $ref: '#/components/schemas/DeliveryEventPayload'
    InventoryEvent:
      name: åº“å­˜äº‹ä»¶
      title: åº“å­˜å˜æ›´äº‹ä»¶
      summary: è®°å½•åº“å­˜æ•°é‡å˜æ›´
      contentType: application/json
      payload:
        $ref: '#/components/schemas/InventoryEventPayload'
    TemperatureEvent:
      name: æ¸©åº¦ç›‘æ§äº‹ä»¶
      title: è¿è¾“æ¸©åº¦ç›‘æ§äº‹ä»¶
      summary: è®°å½•è¿è¾“è¿‡ç¨‹ä¸­çš„æ¸©åº¦æ•°æ®
      contentType: application/json
      payload:
        $ref: '#/components/schemas/TemperatureEventPayload'
    UserActionEvent:
      name: ç”¨æˆ·æ“ä½œäº‹ä»¶
      title: ç”¨æˆ·è¡Œä¸ºäº‹ä»¶
      summary: è®°å½•ç”¨æˆ·æ“ä½œè¡Œä¸º
      contentType: application/json
      payload:
        $ref: '#/components/schemas/UserActionEventPayload'
    DataChangeEvent:
      name: æ•°æ®å˜æ›´äº‹ä»¶
      title: æ•°æ®å˜æ›´äº‹ä»¶
      summary: è®°å½•å…³é”®æ•°æ®å˜æ›´
      contentType: application/json
      payload:
        $ref: '#/components/schemas/DataChangeEventPayload'
    SystemAlertEvent:
      name: ç³»ç»Ÿå‘Šè­¦äº‹ä»¶
      title: ç³»ç»Ÿå‘Šè­¦äº‹ä»¶
      summary: ç³»ç»Ÿå¼‚å¸¸æˆ–å‘Šè­¦é€šçŸ¥
      contentType: application/json
      payload:
        $ref: '#/components/schemas/SystemAlertEventPayload'
    TraceAggregatedEvent:
      name: æº¯æºèšåˆäº‹ä»¶
      title: äº§å“æº¯æºèšåˆäº‹ä»¶
      summary: äº§å“å®Œæ•´æº¯æºé“¾äº‹ä»¶èšåˆ
      contentType: application/json
      payload:
        $ref: '#/components/schemas/TraceAggregatedEventPayload'
    RealtimeNotification:
      name: å®æ—¶é€šçŸ¥
      title: ç”¨æˆ·å®æ—¶é€šçŸ¥
      summary: æ¨é€ç»™ç”¨æˆ·çš„å®æ—¶é€šçŸ¥æ¶ˆæ¯
      contentType: application/json
      payload:
        $ref: '#/components/schemas/RealtimeNotificationPayload'
  schemas:
    BaseEvent:
      type: object
      required:
        - specversion
        - type
        - source
        - id
        - time
        - datacontenttype
        - data
      properties:
        specversion:
          type: string
          const: '1.0'
          description: CloudEventsè§„èŒƒç‰ˆæœ¬
        type:
          type: string
          description: äº‹ä»¶ç±»å‹
        source:
          type: string
          description: äº‹ä»¶æº
        id:
          type: string
          description: äº‹ä»¶å”¯ä¸€æ ‡è¯†ç¬¦
        time:
          type: string
          format: date-time
          description: äº‹ä»¶å‘ç”Ÿæ—¶é—´
        datacontenttype:
          type: string
          const: application/json
          description: æ•°æ®å†…å®¹ç±»å‹
        subject:
          type: string
          description: äº‹ä»¶ä¸»é¢˜
        data:
          type: object
          description: äº‹ä»¶æ•°æ®è½½è·
    PlantingEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.farming.planting
            data:
              type: object
              required:
                - farmId
                - fieldId
                - cropType
                - plantingDate
                - seedVariety
                - area
              properties:
                farmId:
                  type: string
                  description: å†œåœºID
                fieldId:
                  type: string
                  description: ç”°åœ°ID
                cropType:
                  type: string
                  description: ä½œç‰©ç±»å‹
                plantingDate:
                  type: string
                  format: date
                  description: ç§æ¤æ—¥æœŸ
                seedVariety:
                  type: string
                  description: ç§å­å“ç§
                area:
                  type: number
                  description: ç§æ¤é¢ç§¯(å…¬é¡·)
                soilCondition:
                  type: object
                  description: åœŸå£¤æ¡ä»¶
                weather:
                  type: object
                  description: å¤©æ°”æ¡ä»¶
                operator:
                  type: string
                  description: æ“ä½œäººå‘˜
    FertilizingEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.farming.fertilizing
            data:
              type: object
              required:
                - farmId
                - fieldId
                - fertilizerType
                - quantity
                - applicationDate
              properties:
                farmId:
                  type: string
                fieldId:
                  type: string
                fertilizerType:
                  type: string
                  description: è‚¥æ–™ç±»å‹
                quantity:
                  type: number
                  description: æ–½è‚¥é‡(kg)
                applicationDate:
                  type: string
                  format: date
                applicationMethod:
                  type: string
                  description: æ–½è‚¥æ–¹å¼
                operator:
                  type: string
    HarvestEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.farming.harvest
            data:
              type: object
              required:
                - farmId
                - fieldId
                - cropType
                - harvestDate
                - quantity
                - quality
              properties:
                farmId:
                  type: string
                fieldId:
                  type: string
                cropType:
                  type: string
                harvestDate:
                  type: string
                  format: date
                quantity:
                  type: number
                  description: æ”¶è·é‡(kg)
                quality:
                  type: string
                  enum:
                    - ä¼˜ç­‰
                    - ä¸€ç­‰
                    - äºŒç­‰
                    - æ¬¡ç­‰
                batchCode:
                  type: string
                  description: æ‰¹æ¬¡å·
                operator:
                  type: string
    QualityCheckEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.quality.check
            data:
              type: object
              required:
                - productId
                - checkDate
                - checkType
                - result
                - inspector
              properties:
                productId:
                  type: string
                batchCode:
                  type: string
                checkDate:
                  type: string
                  format: date-time
                checkType:
                  type: string
                  enum:
                    - å†œæ®‹æ£€æµ‹
                    - é‡é‡‘å±æ£€æµ‹
                    - å¾®ç”Ÿç‰©æ£€æµ‹
                    - è¥å…»æˆåˆ†æ£€æµ‹
                result:
                  type: string
                  enum:
                    - åˆæ ¼
                    - ä¸åˆæ ¼
                    - å¾…å¤æ£€
                details:
                  type: object
                  description: æ£€æµ‹è¯¦æƒ…
                inspector:
                  type: string
                  description: æ£€æµ‹å‘˜
                certificate:
                  type: string
                  description: æ£€æµ‹è¯ä¹¦ç¼–å·
    CleaningEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.processing.cleaning
            data:
              type: object
              required:
                - batchCode
                - facilityId
                - cleaningDate
                - method
                - operator
              properties:
                batchCode:
                  type: string
                facilityId:
                  type: string
                cleaningDate:
                  type: string
                  format: date-time
                method:
                  type: string
                  description: æ¸…æ´—æ–¹å¼
                temperature:
                  type: number
                  description: æ¸…æ´—æ¸©åº¦
                duration:
                  type: number
                  description: æ¸…æ´—æ—¶é•¿(åˆ†é’Ÿ)
                operator:
                  type: string
    PackagingEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.processing.packaging
            data:
              type: object
              required:
                - batchCode
                - facilityId
                - packagingDate
                - packageType
                - quantity
              properties:
                batchCode:
                  type: string
                facilityId:
                  type: string
                packagingDate:
                  type: string
                  format: date-time
                packageType:
                  type: string
                  description: åŒ…è£…ç±»å‹
                quantity:
                  type: number
                  description: åŒ…è£…æ•°é‡
                weight:
                  type: number
                  description: åŒ…è£…é‡é‡(kg)
                expirationDate:
                  type: string
                  format: date
                operator:
                  type: string
    QualityTestEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.processing.quality-test
            data:
              type: object
              required:
                - batchCode
                - facilityId
                - testDate
                - testType
                - result
              properties:
                batchCode:
                  type: string
                facilityId:
                  type: string
                testDate:
                  type: string
                  format: date-time
                testType:
                  type: string
                result:
                  type: object
                  description: æµ‹è¯•ç»“æœ
                standards:
                  type: array
                  items:
                    type: string
                  description: ç¬¦åˆæ ‡å‡†
                tester:
                  type: string
    StorageEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.processing.storage
            data:
              type: object
              required:
                - batchCode
                - warehouseId
                - storageDate
                - storageConditions
              properties:
                batchCode:
                  type: string
                warehouseId:
                  type: string
                storageDate:
                  type: string
                  format: date-time
                storageConditions:
                  type: object
                  properties:
                    temperature:
                      type: number
                    humidity:
                      type: number
                    ventilation:
                      type: string
                expectedShelfLife:
                  type: number
                  description: é¢„æœŸä¿è´¨æœŸ(å¤©)
                operator:
                  type: string
    ShipmentEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.logistics.shipment
            data:
              type: object
              required:
                - batchCode
                - shipmentId
                - origin
                - destination
                - shipmentDate
              properties:
                batchCode:
                  type: string
                shipmentId:
                  type: string
                origin:
                  type: string
                  description: å‘è´§åœ°ç‚¹
                destination:
                  type: string
                  description: ç›®çš„åœ°
                shipmentDate:
                  type: string
                  format: date-time
                carrier:
                  type: string
                  description: æ‰¿è¿å•†
                vehicle:
                  type: string
                  description: è¿è¾“è½¦è¾†
                driver:
                  type: string
                  description: é©¾é©¶å‘˜
                expectedArrival:
                  type: string
                  format: date-time
    DeliveryEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.logistics.delivery
            data:
              type: object
              required:
                - shipmentId
                - deliveryDate
                - recipient
                - status
              properties:
                shipmentId:
                  type: string
                deliveryDate:
                  type: string
                  format: date-time
                recipient:
                  type: string
                  description: æ”¶è´§äºº
                location:
                  type: string
                  description: æ”¶è´§åœ°ç‚¹
                status:
                  type: string
                  enum:
                    - å·²é€è¾¾
                    - éƒ¨åˆ†é€è¾¾
                    - æ‹’æ”¶
                    - å»¶è¿Ÿ
                signature:
                  type: string
                  description: ç­¾æ”¶äºº
                notes:
                  type: string
                  description: é…é€å¤‡æ³¨
    InventoryEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.logistics.inventory
            data:
              type: object
              required:
                - productId
                - warehouseId
                - changeType
                - quantity
                - timestamp
              properties:
                productId:
                  type: string
                batchCode:
                  type: string
                warehouseId:
                  type: string
                changeType:
                  type: string
                  enum:
                    - å…¥åº“
                    - å‡ºåº“
                    - ç›˜ç‚¹
                    - æŸè€—
                quantity:
                  type: number
                  description: å˜æ›´æ•°é‡
                remainingStock:
                  type: number
                  description: å‰©ä½™åº“å­˜
                timestamp:
                  type: string
                  format: date-time
                operator:
                  type: string
                reason:
                  type: string
                  description: å˜æ›´åŸå› 
    TemperatureEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.logistics.temperature
            data:
              type: object
              required:
                - shipmentId
                - sensorId
                - temperature
                - humidity
                - timestamp
              properties:
                shipmentId:
                  type: string
                sensorId:
                  type: string
                  description: ä¼ æ„Ÿå™¨ID
                temperature:
                  type: number
                  description: æ¸©åº¦(Â°C)
                humidity:
                  type: number
                  description: æ¹¿åº¦(%)
                location:
                  type: object
                  properties:
                    latitude:
                      type: number
                    longitude:
                      type: number
                timestamp:
                  type: string
                  format: date-time
                alert:
                  type: boolean
                  description: æ˜¯å¦è¶…å‡ºé˜ˆå€¼
    UserActionEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.system.user-action
            data:
              type: object
              required:
                - userId
                - action
                - resource
                - timestamp
              properties:
                userId:
                  type: string
                action:
                  type: string
                  enum:
                    - åˆ›å»º
                    - æ›´æ–°
                    - åˆ é™¤
                    - æŸ¥çœ‹
                    - å¯¼å‡º
                resource:
                  type: string
                  description: æ“ä½œèµ„æº
                resourceId:
                  type: string
                  description: èµ„æºID
                details:
                  type: object
                  description: æ“ä½œè¯¦æƒ…
                ipAddress:
                  type: string
                userAgent:
                  type: string
                timestamp:
                  type: string
                  format: date-time
    DataChangeEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.system.data-change
            data:
              type: object
              required:
                - entityType
                - entityId
                - changeType
                - timestamp
              properties:
                entityType:
                  type: string
                  description: å®ä½“ç±»å‹
                entityId:
                  type: string
                  description: å®ä½“ID
                changeType:
                  type: string
                  enum:
                    - åˆ›å»º
                    - æ›´æ–°
                    - åˆ é™¤
                oldValue:
                  type: object
                  description: å˜æ›´å‰æ•°æ®
                newValue:
                  type: object
                  description: å˜æ›´åæ•°æ®
                userId:
                  type: string
                  description: æ“ä½œç”¨æˆ·
                timestamp:
                  type: string
                  format: date-time
    SystemAlertEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.system.alert
            data:
              type: object
              required:
                - alertType
                - severity
                - message
                - timestamp
              properties:
                alertType:
                  type: string
                  enum:
                    - ç³»ç»Ÿå¼‚å¸¸
                    - æ€§èƒ½å‘Šè­¦
                    - å®‰å…¨å‘Šè­¦
                    - ä¸šåŠ¡å‘Šè­¦
                severity:
                  type: string
                  enum:
                    - ä½
                    - ä¸­
                    - é«˜
                    - ä¸¥é‡
                message:
                  type: string
                  description: å‘Šè­¦æ¶ˆæ¯
                source:
                  type: string
                  description: å‘Šè­¦æ¥æº
                details:
                  type: object
                  description: å‘Šè­¦è¯¦æƒ…
                timestamp:
                  type: string
                  format: date-time
                resolved:
                  type: boolean
                  default: false
    TraceAggregatedEventPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.trace.aggregated
            data:
              type: object
              required:
                - productId
                - batchCode
                - events
                - aggregationTime
              properties:
                productId:
                  type: string
                batchCode:
                  type: string
                events:
                  type: array
                  items:
                    type: object
                    properties:
                      eventId:
                        type: string
                      eventType:
                        type: string
                      timestamp:
                        type: string
                        format: date-time
                      data:
                        type: object
                completeness:
                  type: number
                  description: æº¯æºå®Œæ•´åº¦(%)
                verificationStatus:
                  type: string
                  enum:
                    - å·²éªŒè¯
                    - éƒ¨åˆ†éªŒè¯
                    - æœªéªŒè¯
                aggregationTime:
                  type: string
                  format: date-time
    RealtimeNotificationPayload:
      allOf:
        - $ref: '#/components/schemas/BaseEvent'
        - type: object
          properties:
            type:
              const: com.farm-trace.notification.realtime
            data:
              type: object
              required:
                - notificationType
                - title
                - message
                - timestamp
              properties:
                notificationType:
                  type: string
                  enum:
                    - ä¿¡æ¯
                    - è­¦å‘Š
                    - é”™è¯¯
                    - æˆåŠŸ
                title:
                  type: string
                  description: é€šçŸ¥æ ‡é¢˜
                message:
                  type: string
                  description: é€šçŸ¥å†…å®¹
                actionUrl:
                  type: string
                  description: æ“ä½œé“¾æ¥
                priority:
                  type: string
                  enum:
                    - ä½
                    - ä¸­
                    - é«˜
                  default: ä¸­
                expiresAt:
                  type: string
                  format: date-time
                  description: é€šçŸ¥è¿‡æœŸæ—¶é—´
                timestamp:
                  type: string
                  format: date-time
    UserInfo:
      type: object
      required:
        - id
        - username
        - email
        - role
        - isActive
      properties:
        id:
          type: integer
          description: ç”¨æˆ·ID
        username:
          type: string
          description: ç”¨æˆ·å
        email:
          type: string
          format: email
          description: é‚®ç®±åœ°å€
        role:
          type: string
          enum:
            - admin
            - manager
            - operator
            - viewer
          description: ç”¨æˆ·è§’è‰²
        permissions:
          type: array
          items:
            type: string
          description: ç”¨æˆ·æƒé™åˆ—è¡¨
        lastLogin:
          type: string
          format: date-time
          description: æœ€åç™»å½•æ—¶é—´
        isActive:
          type: boolean
          description: è´¦æˆ·æ˜¯å¦æ¿€æ´»
        profile:
          type: object
          properties:
            displayName:
              type: string
              description: æ˜¾ç¤ºåç§°
            phone:
              type: string
              description: ç”µè¯å·ç 
            department:
              type: string
              description: éƒ¨é—¨
            position:
              type: string
              description: èŒä½
    Product:
      type: object
      required:
        - id
        - name
        - category
        - brand
        - sku
        - price
        - description
        - isActive
        - stockQuantity
        - unit
        - traceability
      properties:
        id:
          type: integer
          description: äº§å“ID
        name:
          type: string
          description: äº§å“åç§°
        category:
          type: string
          description: äº§å“åˆ†ç±»
        brand:
          type: string
          description: å“ç‰Œ
        sku:
          type: string
          description: å•†å“ç¼–ç 
        price:
          type: number
          format: float
          minimum: 0
          description: ä»·æ ¼
        description:
          type: string
          description: äº§å“æè¿°
        imageUrl:
          type: string
          format: uri
          description: äº§å“å›¾ç‰‡URL
        isActive:
          type: boolean
          description: æ˜¯å¦å¯ç”¨
        stockQuantity:
          type: integer
          minimum: 0
          description: åº“å­˜æ•°é‡
        unit:
          type: string
          description: è®¡é‡å•ä½
        tags:
          type: array
          items:
            type: string
          description: äº§å“æ ‡ç­¾
        createdAt:
          type: string
          format: date-time
          description: åˆ›å»ºæ—¶é—´
        updatedAt:
          type: string
          format: date-time
          description: æ›´æ–°æ—¶é—´
        traceability:
          $ref: '#/components/schemas/TraceabilityInfo'
    TraceabilityInfo:
      type: object
      required:
        - origin
        - farmLocation
        - harvestDate
        - certifications
      properties:
        origin:
          type: string
          description: äº§åœ°
        farmLocation:
          type: string
          description: å†œåœºä½ç½®
        harvestDate:
          type: string
          format: date
          description: é‡‡æ‘˜æ—¥æœŸ
        certifications:
          type: array
          items:
            type: string
          description: è®¤è¯åˆ—è¡¨
        farmerId:
          type: string
          description: å†œæˆ·ID
        farmingMethods:
          type: array
          items:
            type: string
          description: ç§æ¤æ–¹å¼
        qualityGrade:
          type: string
          description: è´¨é‡ç­‰çº§
    TraceEvent:
      type: object
      required:
        - id
        - type
        - title
        - description
        - timestamp
        - location
        - operator
        - details
      properties:
        id:
          type: string
          description: äº‹ä»¶ID
        type:
          type: string
          enum:
            - farming
            - processing
            - logistics
            - quality_check
            - packaging
          description: äº‹ä»¶ç±»å‹
        title:
          type: string
          description: äº‹ä»¶æ ‡é¢˜
        description:
          type: string
          description: äº‹ä»¶æè¿°
        timestamp:
          type: string
          format: date-time
          description: äº‹ä»¶æ—¶é—´
        location:
          type: string
          description: äº‹ä»¶åœ°ç‚¹
        operator:
          type: string
          description: æ“ä½œäººå‘˜
        details:
          type: object
          description: äº‹ä»¶è¯¦æƒ…
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/Attachment'
          description: é™„ä»¶åˆ—è¡¨
        verificationStatus:
          type: string
          enum:
            - pending
            - verified
            - rejected
          description: éªŒè¯çŠ¶æ€
    Attachment:
      type: object
      required:
        - type
        - url
        - title
      properties:
        type:
          type: string
          enum:
            - image
            - document
            - certificate
          description: é™„ä»¶ç±»å‹
        url:
          type: string
          format: uri
          description: é™„ä»¶URL
        title:
          type: string
          description: é™„ä»¶æ ‡é¢˜
        fileSize:
          type: integer
          description: æ–‡ä»¶å¤§å°(å­—èŠ‚)
        uploadedAt:
          type: string
          format: date-time
          description: ä¸Šä¼ æ—¶é—´
    BatchInfo:
      type: object
      required:
        - batchCode
        - productId
        - quantity
        - productionDate
        - expirationDate
        - status
      properties:
        batchCode:
          type: string
          description: æ‰¹æ¬¡ç¼–ç 
        productId:
          type: string
          description: äº§å“ID
        quantity:
          type: number
          description: æ‰¹æ¬¡æ•°é‡
        productionDate:
          type: string
          format: date
          description: ç”Ÿäº§æ—¥æœŸ
        expirationDate:
          type: string
          format: date
          description: åˆ°æœŸæ—¥æœŸ
        status:
          type: string
          enum:
            - active
            - recalled
            - expired
          description: æ‰¹æ¬¡çŠ¶æ€
        qualityInfo:
          type: object
          properties:
            grade:
              type: string
              description: è´¨é‡ç­‰çº§
            certifications:
              type: array
              items:
                type: string
              description: è®¤è¯ä¿¡æ¯
            inspectionDate:
              type: string
              format: date
              description: æ£€éªŒæ—¥æœŸ
            inspectorId:
              type: string
              description: æ£€éªŒå‘˜ID
    LogisticsInfo:
      type: object
      required:
        - shipmentId
        - carrierName
        - status
        - estimatedDelivery
      properties:
        shipmentId:
          type: string
          description: è¿è¾“å•å·
        carrierName:
          type: string
          description: æ‰¿è¿å•†åç§°
        status:
          type: string
          enum:
            - å‡†å¤‡ä¸­
            - è¿è¾“ä¸­
            - å·²åˆ°è¾¾
            - å·²ç­¾æ”¶
          description: ç‰©æµçŠ¶æ€
        estimatedDelivery:
          type: string
          format: date-time
          description: é¢„è®¡é€è¾¾æ—¶é—´
        actualDelivery:
          type: string
          format: date-time
          description: å®é™…é€è¾¾æ—¶é—´
        route:
          type: array
          items:
            type: object
            properties:
              location:
                type: string
                description: åœ°ç‚¹
              timestamp:
                type: string
                format: date-time
                description: æ—¶é—´
              status:
                type: string
                description: çŠ¶æ€
          description: è¿è¾“è·¯çº¿
        conditions:
          type: object
          properties:
            temperature:
              type: object
              properties:
                min:
                  type: number
                max:
                  type: number
                current:
                  type: number
            humidity:
              type: object
              properties:
                min:
                  type: number
                max:
                  type: number
                current:
                  type: number

# 进销存管理模块企业级评估报告

**日期**: 2026-02-19
**评估方式**: Agent Team (Full Mode, 3 Researchers + Analyst + Critic + Integrator)

---

## 一、执行摘要

白垩纪食品溯源系统的进销存模块已构建了较完整的后端API骨架（76+端点覆盖采购、销售、调拨、物料批次、应收应付、价格表），Web管理端（Vue）具备基本可用的CRUD界面。但RN移动端存在路径Bug导致关键功能不可用，库存盘点页面仍为空壳（"功能开发中"），且缺乏食品行业法规要求的FEFO出库策略、批次召回机制和冷链温控记录。系统处于"基本骨架已成型、深度企业级功能待补齐"的阶段，距离满足企业级用户生产使用尚有明确差距。

---

## 二、共识与分歧调和

### 2.1 各方共识

| 维度 | 共识结论 |
|------|----------|
| 后端API覆盖面 | 76+端点，采购/销售/调拨/批次/AR-AP/价格表六大模块均有实现，基本完整 |
| RN移动端缺陷 | `receiveOrder`/`deliverOrder`路径指向不存在端点，AR/AP和价格表UI缺失，属P0级Bug |
| 法规合规缺口 | 缺少FEFO出库策略、72小时召回机制、冷链温度记录、临期三级预警等食品安全法要求 |
| 并发安全风险 | 库存操作无乐观锁机制，高并发下存在数据一致性风险 |

### 2.2 关键分歧与修正（采纳评审方修正）

| 分歧点 | 分析师原判 | 评审方修正 | 本报告采纳 |
|--------|-----------|-----------|-----------|
| **Web-admin前端覆盖** | 未纳入评估，仅评RN | Vue前端已有采购/销售/调拨/AR-AP/价格表完整页面 | **采纳修正** |
| **系统可用度评分** | 30%（仅RN） | 50%（含Vue） | **采纳50%** |
| **Phase1修复效果** | +15% | +3~5%（RN路径修复不创造新页面） | **采纳保守估计** |
| **FEFO实现难度** | 需从零开发 | 已有FIFO+批次到期日，可组合实现 | **采纳** |
| **AR/AP端点数量** | 9个 | 实际11个 | **采纳11个** |

### 2.3 独立验证发现

- `warehouse/inventory/list.vue` **是空壳页面**（`<el-empty description="功能开发中..." />`）
- Vue端AR/AP页面功能完整（概览、交易记录分页、账龄分析、按类型筛选）
- 采购订单7个状态流转，销售订单6个状态，调拨8个状态3种类型

---

## 三、最终评分与置信度

| 模块 | 后端API | Vue前端 | RN前端 | 综合评分 | 置信度 |
|------|:---:|:---:|:---:|:---:|:---:|
| **采购管理** | 70% | 55% | 25% | **50%** | 高 |
| **销售管理** | 65% | 52% | 22% | **48%** | 高 |
| **库存管理** | 45% | 15%* | 20% | **28%** | 高 |
| **调拨管理** | 60% | 50% | 15% | **42%** | 中高 |
| **应收应付** | 55% | 48% | 5% | **38%** | 中高 |
| **价格表** | 40% | 35% | 0% | **25%** | 中 |
| **法规合规** | 15% | 0% | 0% | **8%** | 高 |
| **系统综合** | — | — | — | **50%** | **中高** |

> *库存管理Vue端15%：盘点页面为空壳

---

## 四、P0缺陷清单

### 法规合规类
1. **批次召回锁定机制** — 《食品召回管理办法》要求72小时内按批次锁定+流向清单
2. **FEFO出库策略** — 市场监管总局令第60号要求临期预警，FEFO优于FIFO
3. **正向/反向批次追溯** — 《食品安全法》第50条+GB/T 38155-2019
4. **保质期三级预警** — 30/60/90天自动预警，距保质期1/3需单独存放

### 系统可用性类
5. **RN路径Bug修复** — `purchaseApiClient.receiveOrder`和`salesApiClient.deliverOrder`路径不匹配
6. **库存盘点页面实现** — Vue端`inventory/list.vue`为空壳
7. **业务模块联动** — 采购→库存→应付，销售→库存→应收自动关联
8. **乐观锁机制** — 库存变更操作需`@Version`字段

---

## 五、可执行建议

### Phase 1: 立即行动（1-2周）

| # | 行动项 | 工时 | 影响 |
|---|--------|------|------|
| 1 | 修复RN路径Bug（receiveOrder/deliverOrder） | 2天 | 解除移动端核心流程阻塞 |
| 2 | 实现库存盘点页面（替换空壳） | 3-5天 | 补齐"存"的核心缺失 |
| 3 | 添加乐观锁（@Version） | 2天 | 消除并发风险 |

### Phase 2: 短期补齐（2-6周）

| # | 行动项 | 工时 | 影响 |
|---|--------|------|------|
| 4 | RN端AR/AP和价格表UI | 1-2周 | 移动端完整性 |
| 5 | 业务联动（采购→库存→应付等） | 2周 | 进销存业务闭环 |
| 6 | FEFO出库策略 | 3-5天 | 食品行业基本合规 |
| 7 | 临期预警三级机制 | 3-5天 | 减少过期损失 |
| 8 | PriceList分层重构 | 2天 | 代码质量 |

### Phase 3: 有条件推进（6-12周）

| # | 行动项 | 前置条件 | 工时 |
|---|--------|---------|------|
| 9 | 批次召回机制 | 业务流程确认 | 3-4周 |
| 10 | 冷链温控记录 | IoT设备对接 | 4-6周 |
| 11 | 完整ERP级审批流 | 组织架构确认 | 2-3周 |
| 12 | FDA FSMA 204合规 | 出口业务确认 | 4-6周 |

---

## 六、风险矩阵

| 风险 | 级别 | 说明 |
|------|------|------|
| 法规合规 | **高** | 缺少追溯链路验证和召回机制 |
| 数据一致性 | **高** | 无乐观锁+无业务联动 |
| 运营可用性 | **中高** | 库存盘点为空壳 |
| 移动端体验 | **中** | RN端路径Bug，Vue端可替代 |
| 技术债务 | **中** | 309处as any、分层违规 |

---

## 七、开放问题

1. 库存盘点的业务流程定义（全盘/循环盘/抽盘）？
2. 业务联动的事务边界（强一致/最终一致）？
3. FEFO与FIFO是否需按物料类别配置？
4. 多工厂库存统一调度是否为近期需求？
5. RN移动端战略定位（轻量扫码 vs Vue端完全对等）？
6. FDA FSMA 204条合规优先级（2026年生效）？

---

## 八、结论

系统进销存模块后端API骨架搭建完整（76+端点），Vue Web管理端基本可用，但存在三个核心短板：
1. **库存盘点页面为空壳** — 进销存的"存"实质缺失
2. **RN移动端路径Bug** — 核心流程阻塞
3. **食品法规合规功能近乎为零** — FEFO/召回/冷链/临期预警

P0阶段（1-2周）修复后可将综合可用度从50%提升至58-62%。

---

### Process Note
- Mode: Full
- Researchers deployed: 3 (ERP基线 + 食品法规 + 代码验证)
- Total sources found: 41 findings from 20+ sources
- Key disagreements: 1 major resolved (web-admin覆盖度), 1 minor resolved (ArAp端点数)
- Phases completed: Research → Analysis → Critique → Integration

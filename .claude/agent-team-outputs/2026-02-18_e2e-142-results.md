# E2E Intent Routing Test Results (142 Cases)

**Date**: 2026-02-18
**Version**: v21.2

## Summary

| Metric | Core (102) | New Hard (40) | Total (142) |
|--------|-----------|--------------|-------------|
| Intent accuracy | 100/102 (98%) | 28/40 (70%) | 128/142 (90%) |
| Type accuracy | 102/102 (100%) | 27/40 (68%) | 129/142 (91%) |
| Cross-contamination | 0 | 9 | 9 |

## Category Breakdown

| Cat | Name | Score | Issues |
|-----|------|-------|--------|
| A1 | 咨询-食品安全基础 | 8/8 | - |
| A2 | 咨询-食品安全/检测 | 8/8 | - |
| A3 | 咨询-生产工艺知识 | 8/8 | - |
| B1 | 查询-仓库/库存 | 8/8 | - |
| B2 | 查询-生产 | 8/8 | - |
| B3 | 查询-订单 | 8/8 | - |
| B4 | 查询-质检 | 7/7 | - |
| B5 | 查询-考勤/HR | 7/8 | ATTENDANCE_HISTORY vs ATTENDANCE_STATS |
| B6 | 查询-设备 | 6/6 | - |
| B7 | 查询-销售/财务/统计 | 7/7 | - |
| **B8** | **查询-跨域复合** | **3/6** | UNMATCHED, wrong intent |
| C1 | 写入-创建操作 | 8/8 | - |
| C2 | 写入-状态更新/打卡 | 4/4 | - |
| **C3** | **写入-更多动词模式** | **2/6** | Write verbs not detected |
| D1 | 边界-咨询vs查询 | 6/6 | - |
| D2 | 边界-查询vs写入 | 7/8 | - |
| **D3** | **边界-极短输入** | **6/8** | 2-char UNMATCHED |
| **D4** | **边界-深层咨询vs查询** | **6/8** | FOOD vs EQUIPMENT ambiguity |
| D5 | 边界-深层查询vs写入 | 6/6 | (intent codes not in WRITE_INTENTS set) |
| D6 | 边界-长句/多意图 | 5/6 | REPORT_DASHBOARD_OVERVIEW |

## 9 Type Confusions (Cross-contamination)

### C3: Write verb patterns not detected (3 cases)
- "建一个新批次" → PROCESSING_BATCH_LIST (QUERY), expected WRITE
- "下一个采购单" → ORDER_LIST (QUERY), expected WRITE
- "更新订单发货地址" → SHIPMENT_QUERY (QUERY), expected WRITE

### D4: Food entity overrides data context (2 cases)
- "猪肉冷库温度异常" → FOOD_KNOWLEDGE_QUERY (CONSULT), expected QUERY
- "添加剂检测结果" → FOOD_KNOWLEDGE_QUERY (CONSULT), expected QUERY

### D5: Lifecycle intents not classified (3 cases)
- "订单取消" → ORDER_DELETE (UNKNOWN)
- "暂停生产线" → PROCESSING_BATCH_PAUSE (UNKNOWN)
- "恢复生产" → PROCESSING_BATCH_RESUME (UNKNOWN)

### D6: Dashboard intent not classified (1 case)
- "跟我说说最近的销售情况" → REPORT_DASHBOARD_OVERVIEW (UNKNOWN)

## Architectural Patterns Observed

### P1: Noun-dominated phrase matching
Phrase matching catches nouns ("批次", "订单", "发货") but ignores verb prefixes ("建", "下", "更新", "开始"). This causes write operations to be misrouted to query intents.

### P2: No systematic write-verb detection
Write verbs (创建/新建/添加/录入/修改/更新/删除/取消/暂停/恢复/开始/下单) are not systematically detected. Each one needs manual phrase mapping.

### P3: Ultra-short input minimum threshold
2-char inputs ("订单", "打卡") fail because matchPhrase requires coverage >= 40% or length >= 4. "订单" is only 2 chars.

### P4: Food entity priority too aggressive
"猪肉冷库温度异常" contains food entity "猪肉" AND alert indicator "异常", but food entity wins. The system lacks a way to distinguish "food as subject of knowledge query" vs "food as parameter in data query".

### P5: Intent code coverage gaps
WRITE_INTENTS test set was missing: ORDER_DELETE, PROCESSING_BATCH_PAUSE, PROCESSING_BATCH_RESUME, REPORT_DASHBOARD_OVERVIEW. These are valid intents in the DB but not classified in the test.

### P6: Preprocessor loses write verb context
"帮我创建一个订单" gets preprocessed to "创建订单" — this helped. But "下一个采购单" might get preprocessed differently, losing the write intent signal.

---
description: 
globs: 
alwaysApply: false
---
# Phase-3 技术栈现代化任务管理代理规?
## 🎯 **Phase-3规则使用指南**

### **规则选择?*
| 工作内容 | 使用规则 | 关键标识?|
|----------|----------|-----------|
| 开始Phase-3、任务规划、进度跟?| `refactor-phase3-agent` | 规划、启动、协调、进?|
| 架构重构、技术栈升级、债务清理 | `refactor-phase3-core-agent` | 重构、迁移、技术栈、债务 |
| 任务验证、功能测试、质疑响?| `refactor-phase3-validation-agent` | 测试、验证、质疑、功?|

### **典型工作流程**
```bash
1. 任务启动 ?使用 refactor-phase3-agent (当前规则)
   "开始TASK-P3-016A" / "Phase-3进展如何"

2. 执行变更 ?使用 refactor-phase3-core-agent  
   "修复useApi Hook" / "迁移到Zustand"

3. 验证结果 ?使用 refactor-phase3-validation-agent
   "验证任务完成" / "用户质疑功能"
```

### **快速判断方?*
- **我要做什么？** ?`refactor-phase3-agent` (任务管理) ?**当前规则**
- **我在改代?* ?`refactor-phase3-core-agent` (架构变更)  
- **我要测试验证** ?`refactor-phase3-validation-agent` (验证流程)

---

## 🎯 **Phase-3状态文档结?*

### **🏆 单一权威来源** (必须首先阅读)
**主文?*: `refactor/phase-3/PHASE-3-MASTER-STATUS.md`
- ?核心状态概?(整体完成度、关键任务状?
- ?重要状态变更记?(P0问题修复突破)  
- ?快速状态查?(当前可做/不可做事?
- ?AI上下文优?(单点信息源，减少文档负担)

### **📋 详细信息文档** (按需要引?
当需要深入了解特定方面时，从主文档引用以下详细文档：

**技术细?*:
- `PHASE-3-COMPREHENSIVE-PLAN.md` - 问题分析和技术细?- `TASK-P3-016A-真实状态追?md` - 具体任务实时状?- `TASK-P3-016A-标准化工作清?md` - 任务执行清单

**规划和工作计?*:
- `PHASE-3-COMPREHENSIVE-PLAN.md` - 完整任务列表和规?- `PHASE-3-COMPREHENSIVE-PLAN.md` - 工作执行计划
- `PHASE-3-COMPREHENSIVE-PLAN.md` - 架构恢复计划

**变更和历?*:
- `REFACTOR-PHASE3-CHANGELOG.md` - 技术变更日?- `PHASE-3-STATUS-UPDATE.md` - 历史状态更?
### **🤖 AI使用指导**
```bash
# 标准工作流程
1. **首先阅读**: refactor/phase-3/PHASE-3-MASTER-STATUS.md
   - 获取核心状态和当前可做的事?   - 查看最新的重要状态变?   - 确认整体完成度和关键任务状?
2. **按需深入**: 根据master文档中的引用链接
   - 技术问??查看EMERGENCY-ASSESSMENT  
   - 任务详情 ?查看具体TASK文档
   - 规划问题 ?查看PLANNING和WORK-PLAN

3. **避免多文档扫?*: 不要同时读取多个Phase-3文档
   - 减少AI上下文负?   - 避免文档间的不一致?   - 提高信息获取效率
```

## 使用场景
- Phase-3技术栈现代化阶段的任务管理和协?- 按照项目重构方案执行技术栈现代?- 避免重复工作并确保使用现有任务架?- 协调核心架构变更和验证流?
## 🎯 **Phase-3总体目标与策?*

### **核心目标**
- **技术栈现代?*: 从传统架构迁移到 Next.js 14 + TypeScript + 现代状态管?- **架构简?*: 移除冗余模块，建立清晰的架构层次
- **质量提升**: 建立完善的类型安全和错误处理机制
- **性能优化**: 利用现代框架特性提升应用性能

### **实施策略**
- **渐进式迁?*: 按模块逐步进行现代化，避免大规模破坏性变?- **质量优先**: 每个变更都必须通过完整的验证流?- **向后兼容**: 确保现有功能在迁移过程中保持可用
- **文档同步**: 及时更新架构文档和API文档

## 📋 **Phase-3任务架构**

### **任务分类体系**
```bash
TASK-P3-0XX: 基础架构现代?- P3-001: Next.js 14基础架构搭建
- P3-002: TypeScript严格模式配置
- P3-003: 现代化构建系统配?
TASK-P3-1XX: 核心模块现代?- P3-101: 状态管理现代化 (Zustand + React Query)
- P3-102: API客户端现代化
- P3-103: 认证系统现代?- P3-104: 路由系统现代?
TASK-P3-2XX: 业务模块现代?- P3-201: 农业模块现代?- P3-202: 加工模块现代?- P3-203: 物流模块现代?- P3-204: 溯源模块现代?
TASK-P3-3XX: 质量保障与优?- P3-301: 测试体系建立
- P3-302: 性能优化
- P3-303: 错误处理完善
- P3-304: 文档更新
```

## 🔄 **任务执行流程**

### **标准任务执行步骤**
```bash
步骤1: 任务分析与规?- [ ] 分析任务需求和依赖关系
- [ ] 制定详细实施计划
- [ ] 识别潜在风险和缓解措?- [ ] 准备验证标准和测试用?
步骤2: 实施前准?- [ ] 检查前置任务完成状?- [ ] 备份当前代码状?- [ ] 准备开发环?- [ ] 通知相关团队成员

步骤3: 渐进式实?- [ ] 按计划逐步实施变更
- [ ] 每个阶段完成后进行验?- [ ] 及时修复发现的问?- [ ] 更新相关文档

步骤4: 质量验证
- [ ] 执行完整的验证流?(参? refactor-phase3-validation-agent)
- [ ] 通过所有质量门?- [ ] 进行回归测试
- [ ] 验证性能基准

步骤5: 集成与交?- [ ] 与其他模块进行集成测?- [ ] 更新架构文档
- [ ] 提交代码变更
- [ ] 标记任务完成
```

## 🔗 **相关规则引用**

### **核心架构变更**
- 使用 `refactor-phase3-core-agent` 规则处理架构变更和质量控?- 严格遵循架构简化和重构的完整执行原?- 执行技术债务管理和架构决策记?
### **验证流程**
- 使用 `refactor-phase3-validation-agent` 规则执行验证流程
- 按照5层验证标准进行系统性验?- 特别关注核心组件的功能验?
### **项目管理**
- 使用 `project-management-auto` 规则进行项目状态管?- 执行架构决策影响跟踪机制
- 防止过度乐观的项目状态管?
## 关键规则
- 严格按照任务依赖关系执行，不允许跳过前置任务
- 每个任务完成前必须通过完整的验证流?- 及时识别和处理风险，建立应急处理机?- 保持项目状态的真实性和透明?- 协调核心架构变更和验证流程的执行

## 示例

<example>
**正确的任务执行流?*?
1. **任务启动**?   - 检查前置任务P3-015已完?   - 分析TASK-P3-016A的具体需?   - 制定详细实施计划

2. **渐进式实?*?   - 先修复useApi Hook的无限循环问?   - 每个修复完成后立即验?   - 及时更新任务状?
3. **质量验证**?   - 执行5层验证流?   - 通过所有质量门?   - 记录验证结果

4. **任务完成**?   - 更新任务状态为已完?   - 启动下一个任务P3-016B
   - 更新项目进度报告
</example>

<example type="invalid">
**错误的任务执行方?*?
1. **跳过依赖检?*?   - 在P3-015未完成时启动P3-016
   - 忽视任务间的依赖关系
   - 导致集成问题

2. **不完整的验证**?   - 只检查代码变更不验证功能
   - 跳过质量门禁检?   - 基于假设声称任务完成

3. **状态管理混?*?   - 不及时更新任务状?   - 隐瞒技术债务和问?   - 过度乐观的进度报?</example>





<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>个人中心 - 食品溯源系统</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../assets/styles.css">
    <style>
        :root {
            --bottom-tab-height: 60px;
            --safe-area-bottom: env(safe-area-inset-bottom, 0);
        }
    </style>
    <script src="../../components/trace-auth.js"></script>
    <script src="../../components/trace-common.js"></script>
    <script src="../../components/trace-nav.js"></script>
</head>

<body class="bg-gray-100">
    <div class="pb-16">
        <!-- 用户信息卡片 -->
        <div class="user-card bg-[#1677FF] text-white p-6 pb-16 rounded-b-[30px] relative overflow-hidden">
            <div class="absolute top-0 right-0 w-32 h-32 bg-white opacity-5 rounded-full -mr-10 -mt-10"></div>
            <div class="absolute bottom-0 left-0 w-24 h-24 bg-white opacity-5 rounded-full -ml-10 -mb-10"></div>
            
            <div class="flex items-center mb-4">
                <img src="../../assets/images/avatar.jpg" alt="用户头像" class="w-16 h-16 rounded-full border-2 border-white mr-4 object-cover">
                <div>
                    <h2 class="text-xl font-bold" id="userName">张三</h2>
                    <div class="flex items-center mt-1">
                        <span class="text-sm bg-white/20 rounded-full px-2 py-0.5 mr-2" id="userRole">系统管理员</span>
                        <span class="text-xs bg-white/10 rounded-full px-2 py-0.5" id="userShift">早班</span>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-3 gap-4 mt-6">
                <div class="text-center">
                    <p class="text-xl font-bold">127</p>
                    <p class="text-xs opacity-80">溯源记录</p>
                </div>
                <div class="text-center">
                    <p class="text-xl font-bold">23</p>
                    <p class="text-xs opacity-80">今日上传</p>
                </div>
                <div class="text-center">
                    <p class="text-xl font-bold">98%</p>
                    <p class="text-xs opacity-80">审核通过率</p>
                </div>
            </div>
        </div>
        
        <!-- 快捷功能卡片 -->
        <div class="bg-white rounded-xl shadow-sm mx-4 p-4 -mt-10 mb-4">
            <h3 class="text-base font-medium mb-3">快捷功能</h3>
            <div class="grid grid-cols-4 gap-2">
                <a href="../trace/trace-list.html" class="flex flex-col items-center">
                    <div class="w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center mb-1">
                        <i class="fas fa-qrcode text-[#1677FF]"></i>
                    </div>
                    <span class="text-xs">溯源记录</span>
                </a>
                <a href="#" class="flex flex-col items-center">
                    <div class="w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center mb-1">
                        <i class="fas fa-clock text-[#1677FF]"></i>
                    </div>
                    <span class="text-xs">工作日志</span>
                </a>
                <a href="#" class="flex flex-col items-center">
                    <div class="w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center mb-1">
                        <i class="fas fa-clipboard-list text-[#1677FF]"></i>
                    </div>
                    <span class="text-xs">任务列表</span>
                </a>
                <a href="#" class="flex flex-col items-center">
                    <div class="w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center mb-1">
                        <i class="fas fa-user-shield text-[#1677FF]"></i>
                    </div>
                    <span class="text-xs">权限管理</span>
                </a>
            </div>
        </div>
        
        <!-- 菜单列表 -->
        <div class="bg-white rounded-xl shadow-sm mx-4 overflow-hidden">
            <a href="#" class="flex items-center justify-between p-4 border-b border-gray-100">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center mr-3">
                        <i class="fas fa-user-edit text-[#1890FF]"></i>
                    </div>
                    <span class="font-medium">个人资料</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
            
            <a href="#" class="flex items-center justify-between p-4 border-b border-gray-100">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center mr-3">
                        <i class="fas fa-shield-alt text-[#1890FF]"></i>
                    </div>
                    <span class="font-medium">账号安全</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
            
            <a href="notifications.html" class="flex items-center justify-between p-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center mr-3">
                        <i class="fas fa-bell text-[#1890FF]"></i>
                    </div>
                    <span class="font-medium">消息通知</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
            
            <a href="settings.html" class="flex items-center justify-between p-4">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center mr-3">
                        <i class="fas fa-cog text-[#1890FF]"></i>
                    </div>
                    <span class="font-medium">系统设置</span>
                </div>
                <i class="fas fa-chevron-right text-gray-400"></i>
            </a>
        </div>
        
        <button id="logout-btn" class="w-full bg-white text-red-500 font-medium py-4 rounded-xl shadow-sm mt-6 hover:bg-red-50 transition-colors">
            退出登录
        </button>
    </div>

    <!-- 底部导航容器 -->
    <div id="nav-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 检查登录状态
            checkLoginStatus();
            
            // 初始化导航菜单
            window.traceNav.init('nav-container', 'profile');
            
            // 退出登录按钮
            document.getElementById('logout-btn').addEventListener('click', function() {
                if (confirm('确定要退出登录吗？')) {
                    traceAuth.logout();
                    window.location.href = '../auth/login.html';
                }
            });
        });
        
        function checkLoginStatus() {
            // 实际项目中应检查登录状态，未登录则跳转到登录页
            if (!traceAuth.isAuthenticated()) {
                // 模拟登录（开发环境）
                traceAuth.login({
                    id: '001',
                    name: '张三',
                    role: '系统管理员',
                    shift: '早班',
                    permissions: ['admin', 'trace.all']
                });
            }
            
            // 更新用户信息显示
            const user = traceAuth.getCurrentUser();
            if (user) {
                document.getElementById('userName').textContent = user.name || '用户';
                document.getElementById('userRole').textContent = user.role || '普通用户';
                document.getElementById('userShift').textContent = user.shift || '无班次';
            }
        }
    </script>

    <!-- 自动按钮升级脚本 (自动注入) -->
    <script src="/components/autoload-button-upgrade.js"></script>
</body>
</html> 
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模板配置 - 食品溯源系统</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="assets/styles.css">
    <style>
        .template-node {
            position: relative;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            margin-bottom: 1rem;
        }
        .template-node.active {
            border-color: #00467F;
            background-color: rgba(0, 70, 127, 0.05);
        }
        .template-node::after {
            content: '';
            position: absolute;
            left: 24px;
            bottom: -25px;
            width: 2px;
            height: 24px;
            background-color: #e5e7eb;
            z-index: 1;
        }
        .template-node:last-child::after {
            display: none;
        }
        .draggable-handle {
            cursor: grab;
        }
        .draggable-handle:active {
            cursor: grabbing;
        }
        .field-tag {
            display: inline-flex;
            align-items: center;
            background-color: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .field-tag i {
            margin-right: 0.25rem;
        }
    </style>
</head>
<body class="bg-[#F7F8FA]">
    <div class="max-w-[390px] mx-auto min-h-screen">
        <!-- 顶部导航栏 -->
        <div class="trace-navbar sticky top-0 z-10">
            <a href="javascript:history.back()" class="w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fas fa-arrow-left text-[#00467F]"></i>
            </a>
            <div class="trace-navbar-title">流程模板配置</div>
            <div class="flex">
                <a href="#" class="w-10 h-10 rounded-full flex items-center justify-center">
                    <i class="fas fa-save text-[#00467F]"></i>
                </a>
            </div>
        </div>

        <!-- 模板基本信息 -->
        <div class="px-4 py-4">
            <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-medium mb-2" for="template-name">
                        模板名称 <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="template-name" class="trace-input" value="和牛肉追溯流程">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-medium mb-2" for="template-product">
                        适用产品 <span class="text-red-500">*</span>
                    </label>
                    <select id="template-product" class="trace-input">
                        <option value="beef">和牛肉</option>
                        <option value="crab">大闸蟹</option>
                        <option value="kiwi">猕猴桃</option>
                        <option value="wine">葡萄酒</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-medium mb-2" for="template-desc">
                        模板描述
                    </label>
                    <textarea id="template-desc" class="trace-input" rows="2">适用于日本和牛肉的标准追溯流程，包含养殖、屠宰加工、质量检验、冷链物流和销售记录五个环节</textarea>
                </div>
                <div class="flex justify-between items-center">
                    <div>
                        <label class="flex items-center text-sm text-gray-700">
                            <input type="checkbox" class="mr-2 h-4 w-4 text-[#00467F]" checked>
                            设为默认模板
                        </label>
                    </div>
                    <div class="text-sm text-gray-500">
                        最后更新: 2025-03-10
                    </div>
                </div>
            </div>
        </div>

        <!-- 流程节点配置 -->
        <div class="px-4 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-medium text-gray-800">流程节点</h3>
                <button class="text-[#00467F] text-sm flex items-center">
                    <i class="fas fa-plus mr-1"></i> 添加节点
                </button>
            </div>

            <div class="mb-4">
                <!-- 节点1 -->
                <div class="template-node active">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="draggable-handle mr-2 text-gray-400">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div>
                                <div class="font-medium">1. 养殖阶段</div>
                                <div class="text-xs text-gray-500">必要环节</div>
                            </div>
                        </div>
                        <div class="flex">
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-blue-50 rounded-lg p-3 mb-3">
                        <div class="text-sm text-gray-700 mb-2">已配置字段 (18)</div>
                        <div class="flex flex-wrap">
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 养殖基地
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 养殖周期
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 饲料类型
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-font"></i> 饲养环境
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-image"></i> 养殖场照片
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-plus-circle text-blue-500"></i> 更多...
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs">
                        <div class="text-gray-500">
                            <i class="fas fa-user-check mr-1"></i> 负责人: 养殖部门
                        </div>
                        <div>
                            <span class="text-green-600 mr-2">
                                <i class="fas fa-image mr-1"></i> 允许上传照片
                            </span>
                            <span class="text-green-600">
                                <i class="fas fa-video mr-1"></i> 允许上传视频
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 节点2 -->
                <div class="template-node">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="draggable-handle mr-2 text-gray-400">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div>
                                <div class="font-medium">2. 屠宰加工</div>
                                <div class="text-xs text-gray-500">必要环节</div>
                            </div>
                        </div>
                        <div class="flex">
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 mb-3">
                        <div class="text-sm text-gray-700 mb-2">已配置字段 (15)</div>
                        <div class="flex flex-wrap">
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 加工厂
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 加工日期
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 卫生检查
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 肉质评级
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-plus-circle text-blue-500"></i> 更多...
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs">
                        <div class="text-gray-500">
                            <i class="fas fa-user-check mr-1"></i> 负责人: 加工部门
                        </div>
                        <div>
                            <span class="text-green-600 mr-2">
                                <i class="fas fa-image mr-1"></i> 允许上传照片
                            </span>
                            <span class="text-red-500">
                                <i class="fas fa-video mr-1"></i> 不允许上传视频
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 节点3 -->
                <div class="template-node">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="draggable-handle mr-2 text-gray-400">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div>
                                <div class="font-medium">3. 质量检验</div>
                                <div class="text-xs text-gray-500">必要环节</div>
                            </div>
                        </div>
                        <div class="flex">
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 mb-3">
                        <div class="text-sm text-gray-700 mb-2">已配置字段 (20)</div>
                        <div class="flex flex-wrap">
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 检验机构
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 检验日期
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 微生物检测
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 兽药残留
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-plus-circle text-blue-500"></i> 更多...
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs">
                        <div class="text-gray-500">
                            <i class="fas fa-user-check mr-1"></i> 负责人: 质检部门
                        </div>
                        <div>
                            <span class="text-green-600 mr-2">
                                <i class="fas fa-image mr-1"></i> 允许上传照片
                            </span>
                            <span class="text-green-600">
                                <i class="fas fa-file-pdf mr-1"></i> 允许上传文档
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 节点4 -->
                <div class="template-node">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="draggable-handle mr-2 text-gray-400">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div>
                                <div class="font-medium">4. 冷链物流</div>
                                <div class="text-xs text-gray-500">必要环节</div>
                            </div>
                        </div>
                        <div class="flex">
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 mb-3">
                        <div class="text-sm text-gray-700 mb-2">已配置字段 (12)</div>
                        <div class="flex flex-wrap">
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 物流公司
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 运输方式
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 出发时间
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 到达时间
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-plus-circle text-blue-500"></i> 更多...
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs">
                        <div class="text-gray-500">
                            <i class="fas fa-user-check mr-1"></i> 负责人: 物流部门
                        </div>
                        <div>
                            <span class="text-green-600 mr-2">
                                <i class="fas fa-image mr-1"></i> 允许上传照片
                            </span>
                            <span class="text-green-600">
                                <i class="fas fa-chart-line mr-1"></i> 允许温度记录
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 节点5 -->
                <div class="template-node">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <div class="draggable-handle mr-2 text-gray-400">
                                <i class="fas fa-grip-vertical"></i>
                            </div>
                            <div>
                                <div class="font-medium">5. 销售记录</div>
                                <div class="text-xs text-gray-500">必要环节</div>
                            </div>
                        </div>
                        <div class="flex">
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-3 mb-3">
                        <div class="text-sm text-gray-700 mb-2">已配置字段 (10)</div>
                        <div class="flex flex-wrap">
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 销售商
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 入库日期
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-check-circle text-red-500"></i> 保质期
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-font"></i> 储存条件
                            </div>
                            <div class="field-tag">
                                <i class="fas fa-plus-circle text-blue-500"></i> 更多...
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-between text-xs">
                        <div class="text-gray-500">
                            <i class="fas fa-user-check mr-1"></i> 负责人: 销售部门
                        </div>
                        <div>
                            <span class="text-green-600 mr-2">
                                <i class="fas fa-image mr-1"></i> 允许上传照片
                            </span>
                            <span class="text-green-600">
                                <i class="fas fa-qrcode mr-1"></i> 允许生成二维码
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 添加节点按钮 -->
                <div class="flex items-center justify-center p-4 border border-dashed border-gray-300 rounded-lg cursor-pointer">
                    <i class="fas fa-plus text-gray-400 mr-2"></i>
                    <span class="text-gray-500">添加新环节</span>
                </div>
            </div>
        </div>

        <!-- 节点编辑弹窗 -->
        <div class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-20 hidden">
            <div class="bg-white rounded-xl w-[360px] max-h-[80vh] overflow-y-auto">
                <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="font-medium">编辑节点: 养殖阶段</h3>
                    <button class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-4">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2">
                            节点名称 <span class="text-red-500">*</span>
                        </label>
                        <input type="text" class="trace-input" value="养殖阶段">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2">
                            节点图标
                        </label>
                        <div class="flex flex-wrap gap-2">
                            <div class="w-10 h-10 rounded-full bg-[#00467F] flex items-center justify-center text-white cursor-pointer">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 cursor-pointer">
                                <i class="fas fa-tractor"></i>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 cursor-pointer">
                                <i class="fas fa-leaf"></i>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 cursor-pointer">
                                <i class="fas fa-cow"></i>
                            </div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2">
                            字段配置
                        </label>
                        <div class="border border-gray-200 rounded-lg p-3 mb-3 max-h-[200px] overflow-y-auto">
                            <div class="flex justify-between items-center p-2 hover:bg-gray-50 rounded">
                                <div class="flex items-center">
                                    <input type="checkbox" class="mr-2" checked>
                                    <span>养殖基地</span>
                                </div>
                                <div class="flex items-center">
                                    <label class="flex items-center text-xs text-gray-600 mr-2">
                                        <input type="checkbox" class="mr-1" checked>
                                        必填
                                    </label>
                                    <button class="text-gray-500">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center p-2 hover:bg-gray-50 rounded">
                                <div class="flex items-center">
                                    <input type="checkbox" class="mr-2" checked>
                                    <span>养殖周期</span>
                                </div>
                                <div class="flex items-center">
                                    <label class="flex items-center text-xs text-gray-600 mr-2">
                                        <input type="checkbox" class="mr-1" checked>
                                        必填
                                    </label>
                                    <button class="text-gray-500">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center p-2 hover:bg-gray-50 rounded">
                                <div class="flex items-center">
                                    <input type="checkbox" class="mr-2" checked>
                                    <span>饲料类型</span>
                                </div>
                                <div class="flex items-center">
                                    <label class="flex items-center text-xs text-gray-600 mr-2">
                                        <input type="checkbox" class="mr-1" checked>
                                        必填
                                    </label>
                                    <button class="text-gray-500">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center p-2 hover:bg-gray-50 rounded">
                                <div class="flex items-center">
                                    <input type="checkbox" class="mr-2" checked>
                                    <span>饲养环境</span>
                                </div>
                                <div class="flex items-center">
                                    <label class="flex items-center text-xs text-gray-600 mr-2">
                                        <input type="checkbox" class="mr-1">
                                        必填
                                    </label>
                                    <button class="text-gray-500">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button class="text-[#00467F] text-sm flex items-center">
                            <i class="fas fa-plus-circle mr-1"></i> 添加新字段
                        </button>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2">
                            上传配置
                        </label>
                        <div class="space-y-2">
                            <label class="flex items-center text-sm text-gray-700">
                                <input type="checkbox" class="mr-2 h-4 w-4 text-[#00467F]" checked>
                                允许上传照片
                            </label>
                            <label class="flex items-center text-sm text-gray-700">
                                <input type="checkbox" class="mr-2 h-4 w-4 text-[#00467F]" checked>
                                允许上传视频
                            </label>
                            <label class="flex items-center text-sm text-gray-700">
                                <input type="checkbox" class="mr-2 h-4 w-4 text-[#00467F]">
                                允许上传文档
                            </label>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2">
                            负责部门
                        </label>
                        <select class="trace-input">
                            <option>养殖部门</option>
                            <option>加工部门</option>
                            <option>质检部门</option>
                            <option>物流部门</option>
                            <option>销售部门</option>
                        </select>
                    </div>
                </div>
                <div class="p-4 border-t border-gray-200 flex justify-end">
                    <button class="trace-button trace-button-secondary mr-2">
                        取消
                    </button>
                    <button class="trace-button trace-button-primary">
                        保存
                    </button>
                </div>
            </div>
        </div>

        <!-- 底部操作栏 -->
        <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3">
            <div class="max-w-[390px] mx-auto flex space-x-3">
                <button class="trace-button trace-button-secondary flex-1 text-sm justify-center">
                    预览模板
                </button>
                <button class="trace-button trace-button-primary flex-1 text-sm justify-center">
                    保存模板
                </button>
            </div>
        </div>
    </div>

  <!-- 自动按钮升级脚本 (自动注入) -->
  <script src="/components/autoload-button-upgrade.js"></script>
  </body>
</html> 